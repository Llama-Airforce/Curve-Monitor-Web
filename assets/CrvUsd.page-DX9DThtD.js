import{d as B,r as U,f as C,T as A,U as R,V as F,h as L,o as S,w as u,a,b as t,u as l,j as g,_ as V,e as T,t as k,O as I,a5 as M,a6 as N,$ as W,c as E}from"./index-_TFeqcMs.js";import{u as O,_ as z}from"./UseLegend-CerZZksm.js";import{_ as J}from"./ButtonToggle-CtGiJzNl.js";import{u as Q,c as j,J as q,r as K,a as P,e as G,_ as H,b as X}from"./UseLightweightChart-CiyJOg3J.js";import{d as Y,u as Z}from"./crvusd-DzA4s6fP.js";import{r as ee,u as se}from"./Number-DFPP41yl.js";/* empty css                                                                         *//* empty css                                                                    */import{_ as te}from"./Table-Bc-2DkaV.js";import{_ as oe}from"./AsyncValue-CX8qpoPL.js";import{_ as ae}from"./TokenIcon-DXNBLGYW.js";import{_ as le}from"./IconExpander-DhrmarO0.js";import{_ as ne}from"./InputText-BuCLQbVa.js";import"./Object-DOSYkgA0.js";import"./timestamp-X9wFVw8g.js";import"./timestamp-DkvXAN4c.js";import"./api-Bhu-jkhy.js";import"./useQuery-DI0f2pKh.js";const re={style:{display:"flex"}},de={class:"actions-secondary"},ue={class:"button-group"},ie={ref:"chartRef",class:"chart"},ce=B({__name:"ChartCrvUsdSupply",setup($){const r=U("3m"),f=C(()=>{switch(r.value){case"7d":return 7;case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 90}}),d=A(),{items:i}=O(()=>[{id:"supply",label:"Supply",color:d.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:d.value.colorsArray[1]}]),{isFetching:b,data:w}=Y(f),c=R("card"),{chart:p,series:o}=Q({createChartOptions:P(),series:[j({name:"supply",color:C(()=>d.value.colors.blue),formatter:v}),{type:q,name:"debt",options:C(()=>({priceFormat:{type:"custom",formatter:v},lineWidth:2,lineType:K.WithSteps,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});F(_);function _(){if(!p.value||!o.debt||!o.supply)return;const m=w.value.groupBy(n=>n.timestamp.getTime()).entries().map(([,n])=>({time:n[0].timestamp.getUTCTimestamp(),value:n.sumBy(e=>e.supply),debt:n.find(e=>e.market==="Keepers debt")?.supply??0})).uniqWith((n,e)=>n.time===e.time).orderBy(n=>n.time,"asc"),s=m.map(n=>({time:n.time,value:n.value-n.debt}));o.supply.setData(m),o.debt.setData(s),p.value.timeScale().fitContent();const y={time:new Date(Date.UTC(2025,2,20)).getUTCTimestamp(),position:"aboveBar",color:d.value.colors.red,shape:"arrowDown",text:"Resupply Launch"};G(o.supply,[y])}function v(m){return`${ee(m,0,"dollar")}${se(m)}`}return(m,s)=>{const y=H,n=X,e=J,D=z,x=V;return S(),L(x,{ref_key:"card",ref:c,title:"crvUSD Supply",class:"stack-actions",loading:l(b)},{actions:u(()=>[a("div",re,[t(y,{filename:"crvusd_supply",series:l(o)},null,8,["series"]),t(n,{chart:l(p),target:l(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[a("div",de,[a("div",ue,[t(e,{"model-value":l(r)==="7d",onClick:s[0]||(s[0]=h=>r.value="7d")},{default:u(()=>s[5]||(s[5]=[g(" 7d ")])),_:1,__:[5]},8,["model-value"]),t(e,{"model-value":l(r)==="1m",onClick:s[1]||(s[1]=h=>r.value="1m")},{default:u(()=>s[6]||(s[6]=[g(" 1m ")])),_:1,__:[6]},8,["model-value"]),t(e,{"model-value":l(r)==="3m",onClick:s[2]||(s[2]=h=>r.value="3m")},{default:u(()=>s[7]||(s[7]=[g(" 3m ")])),_:1,__:[7]},8,["model-value"]),t(e,{"model-value":l(r)==="6m",onClick:s[3]||(s[3]=h=>r.value="6m")},{default:u(()=>s[8]||(s[8]=[g(" 6m ")])),_:1,__:[8]},8,["model-value"]),t(e,{"model-value":l(r)==="1y",onClick:s[4]||(s[4]=h=>r.value="1y")},{default:u(()=>s[9]||(s[9]=[g(" 1y ")])),_:1,__:[9]},8,["model-value"])]),t(D,{items:l(i)},null,8,["items"])])]),default:u(()=>[a("div",ie,null,512)]),_:1},8,["loading"])}}}),pe=T(ce,[["__scopeId","data-v-91e572d8"]]),me={class:"end"},_e={class:"end"},ve={class:"end"},fe={class:"end"},ye={class:"end"},ge={class:"end"},be={class:"end"},he={class:"end"},Ce={class:"end"},we={class:"end"},ke={class:"end"},Be=B({__name:"TableMarkets",emits:["select"],setup($,{emit:r}){const f=r,d=U(""),i=C(()=>w.value.filter(p=>{const o=d.value.toLocaleLowerCase().split(" "),_=v=>o.some(m=>v.toLocaleLowerCase().includes(m));return _(p.name)||_(p.address)}).orderBy(p=>p.borrowed,"desc")),{isFetching:b,data:w}=Z(),c=p=>p>=1e6?2:0;return(p,o)=>{const _=ne,v=le,m=ae,s=oe,y=te,n=V;return S(),L(n,{class:"markets-card",title:"Markets",loading:l(b)},{actions:u(()=>[t(_,{modelValue:l(d),"onUpdate:modelValue":o[0]||(o[0]=e=>I(d)?d.value=e:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:u(()=>[t(y,{class:"markets-table",rows:l(i),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:o[1]||(o[1]=e=>f("select",e))},{row:u(({item:e})=>[t(v),t(m,{chain:"ethereum",address:e.collateralToken.address},null,8,["address"]),a("div",null,k(e.name),1),a("div",me,k(e.loans),1),a("div",_e,[t(s,{type:"percentage",value:e.rate*100,precision:2},null,8,["value"])]),a("div",ve,[t(s,{type:"dollar",value:e.borrowed,precision:c,"show-symbol":!1},null,8,["value"])]),a("div",fe,[t(s,{type:"dollar",value:e.collateralAmountUsd,precision:c},null,8,["value"])]),a("div",ye,[t(s,{type:"dollar",value:e.fees.pending,precision:c},null,8,["value"])]),a("div",ge,[t(s,{"show-zero":"",type:"dollar",value:e.fees.collected,precision:c},null,8,["value"])])]),"row-aggregation":u(()=>[o[2]||(o[2]=a("div",null,null,-1)),o[3]||(o[3]=a("div",null,null,-1)),o[4]||(o[4]=a("div",null,null,-1)),a("div",be,k(l(i).sumBy(e=>e.loans)),1),o[5]||(o[5]=a("div",null,null,-1)),a("div",he,[t(s,{type:"dollar",value:l(i).sumBy(e=>e.borrowed),precision:c,"show-symbol":!1},null,8,["value"])]),a("div",Ce,[t(s,{type:"dollar",value:l(i).sumBy(e=>e.collateralAmountUsd),precision:c},null,8,["value"])]),a("div",we,[t(s,{type:"dollar",value:l(i).sumBy(e=>e.fees.pending),precision:c},null,8,["value"])]),a("div",ke,[t(s,{"show-zero":"",type:"dollar",value:l(i).sumBy(e=>e.fees.collected),precision:c},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),Se=T(Be,[["__scopeId","data-v-89b20b09"]]),Te={class:"dashboard"},$e=B({__name:"CrvUsd.page",setup($){const{crumbs:r}=M(N());r.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const f=W(),d=async i=>{await f.push({name:"crvusdmarket",params:{tab:"",marketAddr:i.address}})};return(i,b)=>(S(),E("div",Te,[t(l(Se),{style:{"grid-area":"table"},onSelect:d}),t(l(pe),{style:{"grid-area":"chart"}})]))}}),qe=T($e,[["__scopeId","data-v-26d04f0d"]]);export{qe as default};

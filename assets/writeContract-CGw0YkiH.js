const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/secp256k1-BYOxFyRH.js","assets/index-CSwO_UPo.js","assets/index-DblI59Pf.css","assets/getAction-CoHoS6kc.js"])))=>i.map(i=>d[i]);
import{k as me,l as $e,p as De,m as Re,n as pe,b as g,I as Ve,o as ne,s as je,q as ye,r as ge,t as Oe,v as We,T as Ke,w as xe,x as we,W as Ye,e as Je,j as Qe,h as V,i as Xe}from"./getAction-CoHoS6kc.js";import{z as Pe,aI as Ze,s as X,D as re,p as et,aJ as O,aK as Be,aL as M,x as D,aM as S,B as F,aN as C,aO as j,aP as Ie,aQ as tt,aR as W,aS as ae,aT as nt,aU as st,aV as ot,aW as Z,aX as rt,aY as v,y as at,aF as R,aZ as ie,a_ as ee,a$ as it,b0 as ce,b1 as ct,b2 as ut,b3 as ft,b4 as dt,b5 as lt,b6 as ht,b7 as bt,b8 as mt,b9 as pt}from"./index-CSwO_UPo.js";function yt(e){const t=Pe(`0x${e.substring(4)}`).substring(26);return Ze(`0x${t}`)}async function gt({hash:e,signature:t}){const n=X(e)?e:re(e),{secp256k1:s}=await et(async()=>{const{secp256k1:a}=await import("./secp256k1-BYOxFyRH.js");return{secp256k1:a}},__vite__mapDeps([0,1,2,3]));return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){const{r:f,s:h,v:d,yParity:u}=t,l=Number(u??d),m=ue(l);return new s.Signature(O(f),O(h)).addRecoveryBit(m)}const a=X(t)?t:re(t);if(Be(a)!==65)throw new Error("invalid signature length");const c=M(`0x${a.slice(130)}`),i=ue(c);return s.Signature.fromCompact(a.substring(2,130)).addRecoveryBit(i)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function ue(e){if(e===0||e===1)return e;if(e===27)return 0;if(e===28)return 1;throw new Error("Invalid yParityOrV value")}async function xt({hash:e,signature:t}){return yt(await gt({hash:e,signature:t}))}function wt(e,t="hex"){const n=Fe(e),s=me(new Uint8Array(n.length));return n.encode(s),t==="hex"?D(s.bytes):s.bytes}function Fe(e){return Array.isArray(e)?Pt(e.map(t=>Fe(t))):Bt(e)}function Pt(e){const t=e.reduce((o,r)=>o+r.length,0),n=Ge(t);return{length:t<=55?1+t:1+n+t,encode(o){t<=55?o.pushByte(192+t):(o.pushByte(247+n),n===1?o.pushUint8(t):n===2?o.pushUint16(t):n===3?o.pushUint24(t):o.pushUint32(t));for(const{encode:r}of e)r(o)}}}function Bt(e){const t=typeof e=="string"?S(e):e,n=Ge(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length,encode(o){t.length===1&&t[0]<128?o.pushBytes(t):t.length<=55?(o.pushByte(128+t.length),o.pushBytes(t)):(o.pushByte(183+n),n===1?o.pushUint8(t.length):n===2?o.pushUint16(t.length):n===3?o.pushUint24(t.length):o.pushUint32(t.length),o.pushBytes(t))}}}function Ge(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new F("Length is too large.")}function It(e){const{chainId:t,nonce:n,to:s}=e,o=e.contractAddress??e.address,r=Pe($e(["0x05",wt([t?C(t):"0x",o,n?C(n):"0x"])]));return s==="bytes"?S(r):r}async function Te(e){const{authorization:t,signature:n}=e;return xt({hash:It(t),signature:n??t})}class Ft extends F{constructor(t,{account:n,docsPath:s,chain:o,data:r,gas:a,gasPrice:c,maxFeePerGas:i,maxPriorityFeePerGas:f,nonce:h,to:d,value:u}){const l=De({from:n?.address,to:d,value:typeof u<"u"&&`${Re(u)} ${o?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:a,gasPrice:typeof c<"u"&&`${j(c)} gwei`,maxFeePerGas:typeof i<"u"&&`${j(i)} gwei`,maxPriorityFeePerGas:typeof f<"u"&&`${j(f)} gwei`,nonce:h});super(t.shortMessage,{cause:t,docsPath:s,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Estimate Gas Arguments:",l].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}function Gt(e,{docsPath:t,...n}){const s=(()=>{const o=pe(e,n);return o instanceof Ie?e:o})();return new Ft(s,{docsPath:t,...n})}class Tt extends F{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class se extends F{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class kt extends F{constructor({maxPriorityFeePerGas:t}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${j(t)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class ke extends F{constructor({blockHash:t,blockNumber:n}){let s="Block";t&&(s=`Block at hash "${t}"`),n&&(s=`Block at number "${n}"`),super(`${s} could not be found.`,{name:"BlockNotFoundError"})}}const ve={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function Ce(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?M(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?M(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?ve[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=vt(e.authorizationList)),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}function vt(e){return e.map(t=>({address:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function Ct(e){const t=(e.transactions??[]).map(n=>typeof n=="string"?n:Ce(n));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function $(e,{blockHash:t,blockNumber:n,blockTag:s=e.experimental_blockTag??"latest",includeTransactions:o}={}){const r=o??!1,a=n!==void 0?C(n):void 0;let c=null;if(t?c=await e.request({method:"eth_getBlockByHash",params:[t,r]},{dedupe:!0}):c=await e.request({method:"eth_getBlockByNumber",params:[a||s,r]},{dedupe:!!a}),!c)throw new ke({blockHash:t,blockNumber:n});return(e.chain?.formatters?.block?.format||Ct)(c)}async function Ne(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function Nt(e,t){const{block:n,chain:s=e.chain,request:o}=t||{};try{const r=s?.fees?.maxPriorityFeePerGas??s?.fees?.defaultPriorityFee;if(typeof r=="function"){const c=n||await g(e,$,"getBlock")({}),i=await r({block:c,client:e,request:o});if(i===null)throw new Error;return i}if(typeof r<"u")return r;const a=await e.request({method:"eth_maxPriorityFeePerGas"});return O(a)}catch{const[r,a]=await Promise.all([n?Promise.resolve(n):g(e,$,"getBlock")({}),g(e,Ne,"getGasPrice")({})]);if(typeof r.baseFeePerGas!="bigint")throw new se;const c=a-r.baseFeePerGas;return c<0n?0n:c}}async function fe(e,t){const{block:n,chain:s=e.chain,request:o,type:r="eip1559"}=t||{},a=await(async()=>typeof s?.fees?.baseFeeMultiplier=="function"?s.fees.baseFeeMultiplier({block:n,client:e,request:o}):s?.fees?.baseFeeMultiplier??1.2)();if(a<1)throw new Tt;const i=10**(a.toString().split(".")[1]?.length??0),f=u=>u*BigInt(Math.ceil(a*i))/BigInt(i),h=n||await g(e,$,"getBlock")({});if(typeof s?.fees?.estimateFeesPerGas=="function"){const u=await s.fees.estimateFeesPerGas({block:n,client:e,multiply:f,request:o,type:r});if(u!==null)return u}if(r==="eip1559"){if(typeof h.baseFeePerGas!="bigint")throw new se;const u=typeof o?.maxPriorityFeePerGas=="bigint"?o.maxPriorityFeePerGas:await Nt(e,{block:h,chain:s,request:o}),l=f(h.baseFeePerGas);return{maxFeePerGas:o?.maxFeePerGas??l+u,maxPriorityFeePerGas:u}}return{gasPrice:o?.gasPrice??f(await g(e,Ne,"getGasPrice")({}))}}async function Et(e,{address:t,blockTag:n="latest",blockNumber:s}){const o=await e.request({method:"eth_getTransactionCount",params:[t,typeof s=="bigint"?C(s):n]},{dedupe:!!s});return M(o)}function Ee(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),s=typeof e.blobs[0]=="string"?e.blobs.map(r=>S(r)):e.blobs,o=[];for(const r of s)o.push(Uint8Array.from(t.blobToKzgCommitment(r)));return n==="bytes"?o:o.map(r=>D(r))}function _e(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),s=typeof e.blobs[0]=="string"?e.blobs.map(a=>S(a)):e.blobs,o=typeof e.commitments[0]=="string"?e.commitments.map(a=>S(a)):e.commitments,r=[];for(let a=0;a<s.length;a++){const c=s[a],i=o[a];r.push(Uint8Array.from(t.computeBlobKzgProof(c,i)))}return n==="bytes"?r:r.map(a=>D(a))}function _t(e,t,n,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,s);const o=BigInt(32),r=BigInt(4294967295),a=Number(n>>o&r),c=Number(n&r),i=s?4:0,f=s?0:4;e.setUint32(t+i,a,s),e.setUint32(t+f,c,s)}function At(e,t,n){return e&t^~e&n}function Ht(e,t,n){return e&t^e&n^t&n}class Ut extends tt{constructor(t,n,s,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=o,this.buffer=new Uint8Array(t),this.view=W(this.buffer)}update(t){ae(this),t=nt(t),st(t);const{view:n,buffer:s,blockLen:o}=this,r=t.length;for(let a=0;a<r;){const c=Math.min(o-this.pos,r-a);if(c===o){const i=W(t);for(;o<=r-a;a+=o)this.process(i,a);continue}s.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ae(this),ot(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:o,isLE:r}=this;let{pos:a}=this;n[a++]=128,Z(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(s,0),a=0);for(let d=a;d<o;d++)n[d]=0;_t(s,o-8,BigInt(this.length*8),r),this.process(s,0);const c=W(t),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=i/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<f;d++)c.setUint32(4*d,h[d],r)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:o,finished:r,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=r,t.length=o,t.pos=c,o%n&&t.buffer.set(s),t}clone(){return this._cloneInto()}}const _=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lt=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),A=new Uint32Array(64);class qt extends Ut{constructor(t=32){super(64,t,8,!1),this.A=_[0]|0,this.B=_[1]|0,this.C=_[2]|0,this.D=_[3]|0,this.E=_[4]|0,this.F=_[5]|0,this.G=_[6]|0,this.H=_[7]|0}get(){const{A:t,B:n,C:s,D:o,E:r,F:a,G:c,H:i}=this;return[t,n,s,o,r,a,c,i]}set(t,n,s,o,r,a,c,i){this.A=t|0,this.B=n|0,this.C=s|0,this.D=o|0,this.E=r|0,this.F=a|0,this.G=c|0,this.H=i|0}process(t,n){for(let d=0;d<16;d++,n+=4)A[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const u=A[d-15],l=A[d-2],m=v(u,7)^v(u,18)^u>>>3,y=v(l,17)^v(l,19)^l>>>10;A[d]=y+A[d-7]+m+A[d-16]|0}let{A:s,B:o,C:r,D:a,E:c,F:i,G:f,H:h}=this;for(let d=0;d<64;d++){const u=v(c,6)^v(c,11)^v(c,25),l=h+u+At(c,i,f)+Lt[d]+A[d]|0,y=(v(s,2)^v(s,13)^v(s,22))+Ht(s,o,r)|0;h=f,f=i,i=c,c=a+l|0,a=r,r=o,o=s,s=l+y|0}s=s+this.A|0,o=o+this.B|0,r=r+this.C|0,a=a+this.D|0,c=c+this.E|0,i=i+this.F|0,f=f+this.G|0,h=h+this.H|0,this.set(s,o,r,a,c,i,f,h)}roundClean(){Z(A)}destroy(){this.set(0,0,0,0,0,0,0,0),Z(this.buffer)}}const zt=rt(()=>new qt),Mt=zt;function St(e,t){return Mt(X(e,{strict:!1})?at(e):e)}function $t(e){const{commitment:t,version:n=1}=e,s=e.to??(typeof t=="string"?"hex":"bytes"),o=St(t);return o.set([n],0),s==="bytes"?o:D(o)}function Dt(e){const{commitments:t,version:n}=e,s=e.to,o=[];for(const r of t)o.push($t({commitment:r,to:s,version:n}));return o}const de=6,Ae=32,oe=4096,He=Ae*oe,le=He*de-1-1*oe*de;class Rt extends F{constructor({maxSize:t,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class Vt extends F{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function jt(e){const t=typeof e.data=="string"?S(e.data):e.data,n=Be(t);if(!n)throw new Vt;if(n>le)throw new Rt({maxSize:le,size:n});const s=[];let o=!0,r=0;for(;o;){const a=me(new Uint8Array(He));let c=0;for(;c<oe;){const i=t.slice(r,r+(Ae-1));if(a.pushByte(0),a.pushBytes(i),i.length<31){a.pushByte(128),o=!1;break}c++,r+=31}s.push(a)}return s.map(a=>D(a.bytes))}function Ot(e){const{data:t,kzg:n,to:s}=e,o=e.blobs??jt({data:t}),r=e.commitments??Ee({blobs:o,kzg:n,to:s}),a=e.proofs??_e({blobs:o,commitments:r,kzg:n,to:s}),c=[];for(let i=0;i<o.length;i++)c.push({blob:o[i],commitment:r[i],proof:a[i]});return c}function Wt(e){if(e.type)return e.type;if(typeof e.authorizationList<"u")return"eip7702";if(typeof e.blobs<"u"||typeof e.blobVersionedHashes<"u"||typeof e.maxFeePerBlobGas<"u"||typeof e.sidecars<"u")return"eip4844";if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new Ve({transaction:e})}async function Ue(e){const t=await e.request({method:"eth_chainId"},{dedupe:!0});return M(t)}const Le=["blobVersionedHashes","chainId","fees","gas","nonce","type"],he=new Map;async function qe(e,t){const{account:n=e.account,blobs:s,chain:o,gas:r,kzg:a,nonce:c,nonceManager:i,parameters:f=Le,type:h}=t,d=n&&R(n),u={...t,...d?{from:d?.address}:{}};let l;async function m(){return l||(l=await g(e,$,"getBlock")({blockTag:"latest"}),l)}let y;async function B(){return y||(o?o.id:typeof t.chainId<"u"?t.chainId:(y=await g(e,Ue,"getChainId")({}),y))}if(f.includes("nonce")&&typeof c>"u"&&d)if(i){const b=await B();u.nonce=await i.consume({address:d.address,chainId:b,client:e})}else u.nonce=await g(e,Et,"getTransactionCount")({address:d.address,blockTag:"pending"});if((f.includes("blobVersionedHashes")||f.includes("sidecars"))&&s&&a){const b=Ee({blobs:s,kzg:a});if(f.includes("blobVersionedHashes")){const p=Dt({commitments:b,to:"hex"});u.blobVersionedHashes=p}if(f.includes("sidecars")){const p=_e({blobs:s,commitments:b,kzg:a}),x=Ot({blobs:s,commitments:b,proofs:p,to:"hex"});u.sidecars=x}}if(f.includes("chainId")&&(u.chainId=await B()),(f.includes("fees")||f.includes("type"))&&typeof h>"u")try{u.type=Wt(u)}catch{let b=he.get(e.uid);typeof b>"u"&&(b=typeof(await m())?.baseFeePerGas=="bigint",he.set(e.uid,b)),u.type=b?"eip1559":"legacy"}if(f.includes("fees"))if(u.type!=="legacy"&&u.type!=="eip2930"){if(typeof u.maxFeePerGas>"u"||typeof u.maxPriorityFeePerGas>"u"){const b=await m(),{maxFeePerGas:p,maxPriorityFeePerGas:x}=await fe(e,{block:b,chain:o,request:u});if(typeof t.maxPriorityFeePerGas>"u"&&t.maxFeePerGas&&t.maxFeePerGas<x)throw new kt({maxPriorityFeePerGas:x});u.maxPriorityFeePerGas=x,u.maxFeePerGas=p}}else{if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")throw new se;if(typeof t.gasPrice>"u"){const b=await m(),{gasPrice:p}=await fe(e,{block:b,chain:o,request:u,type:"legacy"});u.gasPrice=p}}return f.includes("gas")&&typeof r>"u"&&(u.gas=await g(e,Yt,"estimateGas")({...u,account:d&&{address:d.address,type:"json-rpc"}})),ne(u),delete u.parameters,u}async function Kt(e,{address:t,blockNumber:n,blockTag:s=e.experimental_blockTag??"latest"}){const o=typeof n=="bigint"?C(n):void 0,r=await e.request({method:"eth_getBalance",params:[t,o||s]});return BigInt(r)}async function Yt(e,t){const{account:n=e.account}=t,s=n?R(n):void 0;try{let w=function(U){const{block:L,request:q,rpcStateOverride:z}=U;return e.request({method:"eth_estimateGas",params:z?[q,L??e.experimental_blockTag??"latest",z]:L?[q,L]:[q]})};const{accessList:o,authorizationList:r,blobs:a,blobVersionedHashes:c,blockNumber:i,blockTag:f,data:h,gas:d,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:m,maxPriorityFeePerGas:y,nonce:B,value:b,stateOverride:p,...x}=await qe(e,{...t,parameters:s?.type==="local"?void 0:["blobVersionedHashes"]}),P=(typeof i=="bigint"?C(i):void 0)||f,H=je(p),G=await(async()=>{if(x.to)return x.to;if(r&&r.length>0)return await Te({authorization:r[0]}).catch(()=>{throw new F("`to` is required. Could not infer from `authorizationList`")})})();ne(t);const T=e.chain?.formatters?.transactionRequest?.format,I=(T||ye)({...ge(x,{format:T}),from:s?.address,accessList:o,authorizationList:r,blobs:a,blobVersionedHashes:c,data:h,gas:d,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:m,maxPriorityFeePerGas:y,nonce:B,to:G,value:b});let k=BigInt(await w({block:P,request:I,rpcStateOverride:H}));if(r){const U=await Kt(e,{address:I.from}),L=await Promise.all(r.map(async q=>{const{address:z}=q,Se=await w({block:P,request:{authorizationList:void 0,data:h,from:s?.address,to:z,value:C(U)},rpcStateOverride:H}).catch(()=>100000n);return 2n*BigInt(Se)}));k+=L.reduce((q,z)=>q+z,0n)}return k}catch(o){throw Gt(o,{...t,account:s,chain:e.chain})}}const Jt=new Map,Qt=new Map;function Xt(e){const t=(o,r)=>({clear:()=>r.delete(o),get:()=>r.get(o),set:a=>r.set(o,a)}),n=t(e,Jt),s=t(e,Qt);return{clear:()=>{n.clear(),s.clear()},promise:n,response:s}}async function Zt(e,{cacheKey:t,cacheTime:n=Number.POSITIVE_INFINITY}){const s=Xt(t),o=s.response.get();if(o&&n>0&&Date.now()-o.created.getTime()<n)return o.data;let r=s.promise.get();r||(r=e(),s.promise.set(r));try{const a=await r;return s.response.set({created:new Date,data:a}),a}finally{s.promise.clear()}}const en=e=>`blockNumber.${e}`;async function tn(e,{cacheTime:t=e.cacheTime}={}){const n=await Zt(()=>e.request({method:"eth_blockNumber"}),{cacheKey:en(e.uid),cacheTime:t});return BigInt(n)}function nn(e,{args:t,eventName:n}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}function sn({chain:e,currentChainId:t}){if(!e)throw new Oe;if(t!==e.id)throw new We({chain:e,currentChainId:t})}function on(e,{docsPath:t,...n}){const s=(()=>{const o=pe(e,n);return o instanceof Ie?e:o})();return new Ke(s,{docsPath:t,...n})}const rn={"0x0":"reverted","0x1":"success"};function an(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map(n=>nn(n)):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?M(e.transactionIndex):null,status:e.status?rn[e.status]:null,type:e.type?ve[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}async function ze(e,{blockHash:t,blockNumber:n,blockTag:s,hash:o,index:r}){const a=s||"latest",c=n!==void 0?C(n):void 0;let i=null;if(o?i=await e.request({method:"eth_getTransactionByHash",params:[o]},{dedupe:!0}):t?i=await e.request({method:"eth_getTransactionByBlockHashAndIndex",params:[t,C(r)]},{dedupe:!0}):i=await e.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[c||a,C(r)]},{dedupe:!!c}),!i)throw new xe({blockHash:t,blockNumber:n,blockTag:a,hash:o,index:r});return(e.chain?.formatters?.transaction?.format||Ce)(i)}async function K(e,{hash:t}){const n=await e.request({method:"eth_getTransactionReceipt",params:[t]},{dedupe:!0});if(!n)throw new we({hash:t});return(e.chain?.formatters?.transactionReceipt?.format||an)(n)}const Y=new Map,be=new Map;let cn=0;function te(e,t,n){const s=++cn,o=()=>Y.get(e)||[],r=()=>{const h=o();Y.set(e,h.filter(d=>d.id!==s))},a=()=>{const h=o();if(!h.some(u=>u.id===s))return;const d=be.get(e);if(h.length===1&&d){const u=d();u instanceof Promise&&u.catch(()=>{})}r()},c=o();if(Y.set(e,[...c,{id:s,fns:t}]),c&&c.length>0)return a;const i={};for(const h in t)i[h]=(...d)=>{const u=o();if(u.length!==0)for(const l of u)l.fns[h]?.(...d)};const f=n(i);return typeof f=="function"&&be.set(e,f),a}function un(e,{emitOnBegin:t,initialWaitTime:n,interval:s}){let o=!0;const r=()=>o=!1;return(async()=>{let c;t&&(c=await e({unpoll:r}));const i=await n?.(c)??s;await ie(i);const f=async()=>{o&&(await e({unpoll:r}),await ie(s),f())};f()})(),r}function fn(e,{emitOnBegin:t=!1,emitMissed:n=!1,onBlockNumber:s,onError:o,poll:r,pollingInterval:a=e.pollingInterval}){const c=typeof r<"u"?r:!(e.transport.type==="webSocket"||e.transport.type==="ipc"||e.transport.type==="fallback"&&(e.transport.transports[0].config.type==="webSocket"||e.transport.transports[0].config.type==="ipc"));let i;return c?(()=>{const d=ee(["watchBlockNumber",e.uid,t,n,a]);return te(d,{onBlockNumber:s,onError:o},u=>un(async()=>{try{const l=await g(e,tn,"getBlockNumber")({cacheTime:0});if(i){if(l===i)return;if(l-i>1&&n)for(let m=i+1n;m<l;m++)u.onBlockNumber(m,i),i=m}(!i||l>i)&&(u.onBlockNumber(l,i),i=l)}catch(l){u.onError?.(l)}},{emitOnBegin:t,interval:a}))})():(()=>{const d=ee(["watchBlockNumber",e.uid,t,n]);return te(d,{onBlockNumber:s,onError:o},u=>{let l=!0,m=()=>l=!1;return(async()=>{try{const y=(()=>{if(e.transport.type==="fallback"){const b=e.transport.transports.find(p=>p.config.type==="webSocket"||p.config.type==="ipc");return b?b.value:e.transport}return e.transport})(),{unsubscribe:B}=await y.subscribe({params:["newHeads"],onData(b){if(!l)return;const p=O(b.result?.number);u.onBlockNumber(p,i),i=p},onError(b){u.onError?.(b)}});m=B,l||m()}catch(y){o?.(y)}})(),()=>m()})})()}async function dn(e,t){const{checkReplacement:n=!0,confirmations:s=1,hash:o,onReplaced:r,retryCount:a=6,retryDelay:c=({count:P})=>~~(1<<P)*200,timeout:i=18e4}=t,f=ee(["waitForTransactionReceipt",e.uid,o]),h=t.pollingInterval?t.pollingInterval:e.chain?.experimental_preconfirmationTime?e.chain.experimental_preconfirmationTime:e.pollingInterval;let d,u,l,m=!1,y,B;const{promise:b,resolve:p,reject:x}=it(),E=i?setTimeout(()=>{B?.(),y?.(),x(new Ye({hash:o}))},i):void 0;return y=te(f,{onReplaced:r,resolve:p,reject:x},async P=>{if(l=await g(e,K,"getTransactionReceipt")({hash:o}).catch(()=>{}),l&&s<=1){clearTimeout(E),P.resolve(l),y?.();return}B=g(e,fn,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:h,async onBlockNumber(H){const G=N=>{clearTimeout(E),B?.(),N(),y?.()};let T=H;if(!m)try{if(l){if(s>1&&(!l.blockNumber||T-l.blockNumber+1n<s))return;G(()=>P.resolve(l));return}if(n&&!d&&(m=!0,await ce(async()=>{d=await g(e,ze,"getTransaction")({hash:o}),d.blockNumber&&(T=d.blockNumber)},{delay:c,retryCount:a}),m=!1),l=await g(e,K,"getTransactionReceipt")({hash:o}),s>1&&(!l.blockNumber||T-l.blockNumber+1n<s))return;G(()=>P.resolve(l))}catch(N){if(N instanceof xe||N instanceof we){if(!d){m=!1;return}try{u=d,m=!0;const I=await ce(()=>g(e,$,"getBlock")({blockNumber:T,includeTransactions:!0}),{delay:c,retryCount:a,shouldRetry:({error:U})=>U instanceof ke});m=!1;const w=I.transactions.find(({from:U,nonce:L})=>U===u.from&&L===u.nonce);if(!w||(l=await g(e,K,"getTransactionReceipt")({hash:w.hash}),s>1&&(!l.blockNumber||T-l.blockNumber+1n<s)))return;let k="replaced";w.to===u.to&&w.value===u.value&&w.input===u.input?k="repriced":w.from===w.to&&w.value===0n&&(k="cancelled"),G(()=>{P.onReplaced?.({reason:k,replacedTransaction:u,transaction:w,transactionReceipt:l}),P.resolve(l)})}catch(I){G(()=>P.reject(I))}}else G(()=>P.reject(N))}}})}),b}class Me extends F{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class J extends F{constructor({docsPath:t,metaMessages:n,type:s}){super(`Account type "${s}" is not supported.`,{docsPath:t,metaMessages:n,name:"AccountTypeNotSupportedError"})}}async function ln(e,{serializedTransaction:t}){return e.request({method:"eth_sendRawTransaction",params:[t]},{retryCount:0})}const Q=new ct(128);async function hn(e,t){const{account:n=e.account,chain:s=e.chain,accessList:o,authorizationList:r,blobs:a,data:c,gas:i,gasPrice:f,maxFeePerBlobGas:h,maxFeePerGas:d,maxPriorityFeePerGas:u,nonce:l,type:m,value:y,...B}=t;if(typeof n>"u")throw new Me({docsPath:"/docs/actions/wallet/sendTransaction"});const b=n?R(n):null;try{ne(t);const p=await(async()=>{if(t.to)return t.to;if(t.to!==null&&r&&r.length>0)return await Te({authorization:r[0]}).catch(()=>{throw new F("`to` is required. Could not infer from `authorizationList`.")})})();if(b?.type==="json-rpc"||b===null){let x;s!==null&&(x=await g(e,Ue,"getChainId")({}),sn({currentChainId:x,chain:s}));const E=e.chain?.formatters?.transactionRequest?.format,H=(E||ye)({...ge(B,{format:E}),accessList:o,authorizationList:r,blobs:a,chainId:x,data:c,from:b?.address,gas:i,gasPrice:f,maxFeePerBlobGas:h,maxFeePerGas:d,maxPriorityFeePerGas:u,nonce:l,to:p,type:m,value:y}),G=Q.get(e.uid),T=G?"wallet_sendTransaction":"eth_sendTransaction";try{return await e.request({method:T,params:[H]},{retryCount:0})}catch(N){if(G===!1)throw N;const I=N;if(I.name==="InvalidInputRpcError"||I.name==="InvalidParamsRpcError"||I.name==="MethodNotFoundRpcError"||I.name==="MethodNotSupportedRpcError")return await e.request({method:"wallet_sendTransaction",params:[H]},{retryCount:0}).then(w=>(Q.set(e.uid,!0),w)).catch(w=>{const k=w;throw k.name==="MethodNotFoundRpcError"||k.name==="MethodNotSupportedRpcError"?(Q.set(e.uid,!1),I):k});throw I}}if(b?.type==="local"){const x=await g(e,qe,"prepareTransactionRequest")({account:b,accessList:o,authorizationList:r,blobs:a,chain:s,data:c,gas:i,gasPrice:f,maxFeePerBlobGas:h,maxFeePerGas:d,maxPriorityFeePerGas:u,nonce:l,nonceManager:b.nonceManager,parameters:[...Le,"sidecars"],type:m,value:y,...B,to:p}),E=s?.serializers?.transaction,P=await b.signTransaction(x,{serializer:E});return await g(e,ln,"sendRawTransaction")({serializedTransaction:P})}throw b?.type==="smart"?new J({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new J({docsPath:"/docs/actions/wallet/sendTransaction",type:b?.type})}catch(p){throw p instanceof J?p:on(p,{...t,account:b,chain:t.chain||void 0})}}async function bn(e,t){const{abi:n,account:s=e.account,address:o,args:r,dataSuffix:a,functionName:c,...i}=t;if(typeof s>"u")throw new Me({docsPath:"/docs/contract/writeContract"});const f=s?R(s):null,h=Je({abi:n,args:r,functionName:c});try{return await g(e,hn,"sendTransaction")({data:`${h}${a?a.replace("0x",""):""}`,to:o,account:f,...i})}catch(d){throw Qe(d,{abi:n,address:o,args:r,docsPath:"/docs/contract/writeContract",functionName:c,sender:f?.address})}}function mn(e,t={}){const{key:n="custom",methods:s,name:o="Custom Provider",retryDelay:r}=t;return({retryCount:a})=>ut({key:n,methods:s,name:o,request:e.request.bind(e),retryCount:t.retryCount??a,retryDelay:r,type:"custom"})}async function pn(e,t={}){let n;if(t.connector){const{connector:f}=t;if(e.state.status==="reconnecting"&&!f.getAccounts&&!f.getChainId)throw new ft({connector:f});const[h,d]=await Promise.all([f.getAccounts().catch(u=>{if(t.account===null)return[];throw u}),f.getChainId()]);n={accounts:h,chainId:d,connector:f}}else n=e.state.connections.get(e.state.current);if(!n)throw new dt;const s=t.chainId??n.chainId,o=await n.connector.getChainId();if(o!==s)throw new lt({connectionChainId:s,connectorChainId:o});const r=n.connector;if(r.getClient)return r.getClient({chainId:s});const a=R(t.account??n.accounts[0]);if(a&&(a.address=ht(a.address)),t.account&&!n.accounts.some(f=>f.toLowerCase()===a.address.toLowerCase()))throw new bt({address:a.address,connector:r});const c=e.chains.find(f=>f.id===s),i=await n.connector.getProvider({chainId:s});return mt({account:a,chain:c,name:"Connector Client",transport:f=>mn(i)({...f,retryCount:0})})}async function xn(e,t){const{chainId:n,timeout:s=0,...o}=t,r=e.getClient({chainId:n}),c=await V(r,dn,"waitForTransactionReceipt")({...o,timeout:s});if(c.status==="reverted"){const f=await V(r,ze,"getTransaction")({hash:c.transactionHash}),d=await V(r,Xe,"call")({...f,data:f.input,gasPrice:f.type!=="eip1559"?f.gasPrice:void 0,maxFeePerGas:f.type==="eip1559"?f.maxFeePerGas:void 0,maxPriorityFeePerGas:f.type==="eip1559"?f.maxPriorityFeePerGas:void 0}),u=d?.data?pt(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(u)}return{...c,chainId:r.chain.id}}async function wn(e,t){const{account:n,chainId:s,connector:o,...r}=t;let a;return typeof n=="object"&&n?.type==="local"?a=e.getClient({chainId:s}):a=await pn(e,{account:n??void 0,chainId:s,connector:o}),await V(a,bn,"writeContract")({...r,...n?{account:n}:{},chain:s?{id:s}:null})}export{wn as a,pn as g,zt as s,xn as w};

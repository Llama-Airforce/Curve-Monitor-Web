import{_ as X}from"./KPI-CgcIf0of.js";import{_ as F}from"./AsyncValue-BACWgnoa.js";import{a as I,b as H,c as J}from"./dao-Bnp0JDQX.js";import{d as $,r as M,f,T as O,U,V as q,h as B,o as S,w as u,a as p,b as l,u as t,j as k,_ as N,e as D,$ as Y,i as Z,t as W,X as ee,c as te}from"./index-C7I7Pnov.js";import{u as oe,_ as ae}from"./UseLegend-B7g_jVVu.js";import{_ as A}from"./ButtonToggle-BG5yzWmC.js";import{u as E,G as R,a as x,_ as P,b as Q,P as se}from"./UseLightweightChart-BUais0L7.js";import{r as V,u as L}from"./Number-DljRImwv.js";import{_ as G}from"./Table-DztvipaJ.js";import{_ as le}from"./IconExpander-D4Rqo3Fh.js";import{u as j}from"./UseSort-DCUBFOYw.js";import"./timestamp-Dfir0V72.js";import"./useQuery-4rM1PUVV.js";import"./Object-DOSYkgA0.js";const ne={style:{display:"flex"}},re={class:"actions-secondary"},ie={class:"button-group"},ue={ref:"chartRef",class:"chart"},ce=$({__name:"ChartSupply",setup(T){const r=M("1m"),h=f(()=>{switch(r.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:b,data:v}=I(h),g=O(),{items:C,toggles:s,disabled:d}=oe(()=>{const{blue:n,yellow:o,purple:_}=g.value.colors;return[{id:"crv",label:"CRV",color:n,togglable:!0},{id:"circ",label:"Circulating",color:o,togglable:!0},{id:"vecrv",label:"veCRV",color:_,togglable:!0}]});s.circ.value=!1,s.crv.value=!1;const m=U("card"),{chart:i,series:e}=E({createChartOptions:x(),series:[{type:R,name:"crv",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${V(n,2,"dollar")}${L(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"circ",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${V(n,2,"dollar")}${L(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"vecrv",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${V(n,2,"dollar")}${L(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.purple,lastValueVisible:!1,priceLineVisible:!1}))}]});q(c);function c(){if(!i.value||!e.crv||!e.circ||!e.vecrv)return;const n=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.crvSupply)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc"),o=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.circulatingSupply)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc"),_=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.veCrvTotal)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc");e.crv.setData(n),e.circ.setData(o),e.vecrv.setData(_),e.crv.applyOptions({visible:s.crv.value}),e.circ.applyOptions({visible:s.circ.value}),e.vecrv.applyOptions({visible:s.vecrv.value}),i.value.timeScale().fitContent()}return(n,o)=>{const _=P,a=Q,y=A,z=ae,K=N;return S(),B(K,{ref_key:"card",ref:m,title:"Token Supply",class:"stack-actions",loading:t(b)},{actions:u(()=>[p("div",ne,[l(_,{filename:"token_supply",series:t(e)},null,8,["series"]),l(a,{chart:t(i),target:t(m)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",re,[p("div",ie,[l(y,{"model-value":t(r)==="1m",onClick:o[0]||(o[0]=w=>r.value="1m")},{default:u(()=>o[5]||(o[5]=[k(" 1m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="3m",onClick:o[1]||(o[1]=w=>r.value="3m")},{default:u(()=>o[6]||(o[6]=[k(" 3m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="6m",onClick:o[2]||(o[2]=w=>r.value="6m")},{default:u(()=>o[7]||(o[7]=[k(" 6m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="1y",onClick:o[3]||(o[3]=w=>r.value="1y")},{default:u(()=>o[8]||(o[8]=[k(" 1y ")])),_:1},8,["model-value"])]),l(z,{items:t(C),disabled:t(d),onToggle:o[4]||(o[4]=w=>t(s)[w].value=!t(s)[w].value)},null,8,["items","disabled"])])]),default:u(()=>[p("div",ue,null,512)]),_:1},8,["loading"])}}}),me=D(ce,[["__scopeId","data-v-6f7ff84b"]]),pe={style:{display:"flex"}},de={class:"button-group"},ve={ref:"chartRef",class:"chart"},_e=$({__name:"ChartSupplyDelta",setup(T){const r=M("1m"),h=f(()=>{switch(r.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:b,data:v}=I(h),g=O(),C=U("card"),{chart:s,series:d}=E({createChartOptions:x(),series:{type:se,name:"deltas",options:f(()=>({priceFormat:{type:"custom",formatter:i=>`${V(i,0,"dollar")}${L(i)}`,minMove:.01},color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}});q(m);function m(){if(!s.value||!d.deltas)return;const{colors:i}=g.value,e=v.value.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.veCrvTotal})).uniqWith((c,n)=>c.time===n.time).orderBy(c=>c.time,"asc").reduce((c,n,o,_)=>{if(o===0)return c;const a=n.value-_[o-1].value,y=a<0?i.red:i.green;return c.push({time:n.time,value:Number(a)/10**18,color:y}),c},[]);e.length>0&&(d.deltas.setData(e),s.value.timeScale().fitContent())}return(i,e)=>{const c=P,n=Q,o=A,_=N;return S(),B(_,{ref_key:"card",ref:C,title:"veCRV Change",loading:t(b)},{actions:u(()=>[p("div",pe,[l(c,{filename:"distributions_delta",series:t(d)},null,8,["series"]),l(n,{chart:t(s),target:t(C)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",de,[l(o,{"model-value":t(r)==="1m",onClick:e[0]||(e[0]=a=>r.value="1m")},{default:u(()=>e[4]||(e[4]=[k(" 1m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="3m",onClick:e[1]||(e[1]=a=>r.value="3m")},{default:u(()=>e[5]||(e[5]=[k(" 3m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="6m",onClick:e[2]||(e[2]=a=>r.value="6m")},{default:u(()=>e[6]||(e[6]=[k(" 6m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="1y",onClick:e[3]||(e[3]=a=>r.value="1y")},{default:u(()=>e[7]||(e[7]=[k(" 1y ")])),_:1},8,["model-value"])])]),default:u(()=>[p("div",ve,null,512)]),_:1},8,["loading"])}}}),ge=["href"],ye={class:"end"},fe={class:"end"},be={class:"end"},Ce=$({__name:"TableLockers",setup(T){const{isFetching:r,data:h}=H(),b=[{id:"locker",label:"Locker",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"ratio",label:"Ratio",sort:!0,align:"end"},{id:"unlock",label:"Unlock Date",sort:!0,align:"end"}],{sorting:v,onSort:g}=j("weight"),C=f(()=>h.value.orderBy(m=>{var i;switch(v.value.column){case"weight":return Number(m.weight);case"ratio":return m.weightRatio;case"unlock":return((i=m.unlockTime)==null?void 0:i.getTime())??0}},v.value.order)),s=Y();async function d(m){await s.push({name:"profile",params:{tab:"governance"},query:{user:m.user}})}return(m,i)=>{const e=F,c=le,n=G,o=N;return S(),B(o,{title:"Top Lockers",loading:t(r)},{default:u(()=>[l(n,{rows:t(C),columns:b,sorting:t(v),onSortColumn:t(g),onSelect:d},{row:u(({item:_})=>{var a;return[p("div",null,[p("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${_.user}`,onClick:i[0]||(i[0]=Z(()=>{},["stop"]))},W(_.user),9,ge)]),p("div",ye,[l(e,{value:Number(_.weight)/10**18},null,8,["value"])]),p("div",fe,[l(e,{type:"percentage",value:_.weightRatio,precision:2},null,8,["value"])]),p("div",be,W(((a=_.unlockTime)==null?void 0:a.toLocaleDateString())??"?"),1),l(c)]}),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),he=D(Ce,[["__scopeId","data-v-16d8eb1a"]]),ke=$({__name:"TableLocks",setup(T){const{isFetching:r,data:h}=J(),b=[{id:"day",label:"Day",sort:!0},{id:"amount",label:"Amount",sort:!0,align:"end"}],{sorting:v,onSort:g}=j("day"),C=f(()=>h.value.orderBy(d=>{switch(v.value.column){case"day":return d.day.getTime();case"amount":return Number(d.amount)}},v.value.order));function s(d){return Math.round(Number(d.amount)/10**18)}return(d,m)=>{const i=F,e=G,c=N;return S(),B(c,{title:"Daily Lock Change",loading:t(r)},{default:u(()=>[l(e,{rows:t(C),columns:b,sorting:t(v),onSortColumn:t(g)},{row:u(({item:n})=>[p("div",null,W(n.day.toLocaleDateString()),1),p("div",{class:ee(["end",{positive:s(n)>0,negative:s(n)<0}])},[l(i,{value:s(n),precision:2},null,8,["value"])],2)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),we=D(ke,[["__scopeId","data-v-3ae158f5"]]),$e={class:"dashboard"},Se={class:"two-sides"},Te={style:{display:"flex",gap:"0.5ch"}},Ve=$({__name:"Locks.page",setup(T){const{isFetching:r,data:h}=I(),b=f(()=>h.value.orderBy(s=>s.timestamp.getTime(),"desc")[0]??void 0),v=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.veCrvTotal)??0)/10**18}),g=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.crvSupply)??0)/10**18}),C=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.circulatingSupply)??0)/10**18});return(s,d)=>{const m=F,i=X;return S(),te("div",$e,[l(i,{style:{"grid-area":"kpi1"},label:"veCRV Supply","has-value":!t(r)},{default:u(()=>[l(m,{type:"dollar",value:t(v),precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),l(i,{style:{"grid-area":"kpi2"},label:"CRV Supply / Circulating","has-value":!t(r)},{default:u(()=>[p("div",Se,[p("div",Te,[l(m,{type:"dollar",value:t(g),precision:2,"show-symbol":!1},null,8,["value"]),d[0]||(d[0]=p("span",{style:{color:"var(--c-lvl5)"}},"/",-1)),l(m,{type:"dollar",value:t(C),precision:2,"show-symbol":!1},null,8,["value"])]),l(m,{type:"percentage",value:100*t(C)/t(g),precision:2},null,8,["value"])])]),_:1},8,["has-value"]),l(me,{style:{"grid-area":"supply"}}),l(_e,{style:{"grid-area":"supply-delta"}}),l(we,{style:{"grid-area":"locks"}}),l(he,{style:{"grid-area":"lockers"}})])}}}),xe=D(Ve,[["__scopeId","data-v-85843182"]]);export{xe as default};

import{_ as Z,a as G}from"./TabItem.vue_vue_type_script_setup_true_lang-aHLn9g5N.js";import{d as L,aD as I,S as k,X as M,z as b,a5 as U,a6 as H,Z as W,h as y,o as v,_ as R,u as e,w as h,b as g,I as C,a as i,L as Y,g as S,t as q,c as F,T as B,P as z,V as x,aa as ee,f as ae,ar as te,ac as se,ad as ne,J as oe,O as ie,a4 as N}from"./index-BYnNAfSP.js";import"./UseLegend-CoonPT9k.js";import"./ButtonToggle-Cf3bACCF.js";/* empty css                                                                         */import"./ChartStylesApex-KBYYWdgj.js";import{u as Q,b as D,c as P}from"./UseLightweightChart-DudqJuBl.js";import{_ as re}from"./InputNumber-Cz49IiEA.js";import{u as K,a as le,b as ce,c as de,d as ue,e as me,f as pe,T as _e,_ as he,g as ve,h as ge,i as fe,j as ke,k as be,l as ye,m as Ce,n as $e,o as we,C as Le,p as Te,q as qe}from"./TableTrades-BRKafZPz.js";import{_ as j,a as Se}from"./Table-CkrHHA0S.js";import{L as J}from"./link-D7XIkfCK.js";import{_ as Ve}from"./TokenIcon-CTWhTb_X.js";import{a as Ae}from"./index-CQR0y8Z1.js";import{u as Fe}from"./UseTabNavigation-5nrvQdSX.js";import"./Object-DOSYkgA0.js";/* empty css                                                                    */import"./UsePagination-6my4nle6.js";const Re={ref:"chartRef",class:"chart"},Be=L({__name:"ChartMarketAvailableCap",props:{market:{}},setup(l){const{isFetching:s,data:p}=I(k(()=>l.market)),_=M(),{chart:n,series:t}=Q({createChartOptions:P(),series:{type:"Area",name:"available",options:b(()=>({priceFormat:{type:"custom",formatter:o=>`$${U(o,0,"dollar")}${H(o)}`},lineWidth:2,lineType:D.WithSteps,lineColor:_.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});W(r);function r(){if(!n.value||!t.available)return;const o=p.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.borrowable})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc").dropWhile(a=>a.value===0);o.length>0&&t.available.setData(o),n.value.timeScale().fitContent()}return(o,a)=>{const c=R;return v(),y(c,{title:"Borrowable & Debt Ceiling",loading:e(s)},{default:h(()=>[g("div",Re,null,512)]),_:1},8,["loading"])}}}),Oe={ref:"chartRef",class:"chart"},De=L({__name:"ChartMarketLoans",props:{market:{}},setup(l){const{isFetching:s,data:p}=I(k(()=>l.market)),_=M(),{chart:n,series:t}=Q({createChartOptions:P(),series:{type:"Histogram",name:"loans",options:b(()=>({color:_.value.colors.yellow,lastValueVisible:!1,priceFormat:{type:"volume"},priceLineVisible:!1}))}});W(r);function r(){if(!n.value||!t.loans)return;const o=p.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.nLoans})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc");o.length>0&&(t.loans.setData(o),n.value.timeScale().fitContent())}return(o,a)=>{const c=R;return v(),y(c,{title:"Loans",loading:e(s)},{default:h(()=>[g("div",Oe,null,512)]),_:1},8,["loading"])}}}),Ie={ref:"chartRef",class:"chart"},Me=L({__name:"ChartMarketRates",props:{market:{}},setup(l){const{isFetching:s,data:p}=I(k(()=>l.market)),_=M(),n=C(null),{chart:t,series:r}=Q({createChartOptions:P(),series:[{type:"Area",name:"rates",options:b(()=>({priceFormat:{type:"custom",formatter:a},lineWidth:2,lineType:D.WithSteps,lineColor:_.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"ema",options:b(()=>({priceFormat:{type:"custom",formatter:a},lineWidth:2,lineType:D.WithSteps,color:_.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});W(o);function o(){if(!t.value||!r.rates||!r.ema)return;const u=p.value.map(d=>({time:d.timestamp.getUTCTimestamp(),value:d.rate})).uniqWith((d,$)=>d.time===$.time).orderBy(d=>d.time,"asc"),f=c(u.map(d=>d.value),n.value??31).zip(u).map(d=>({time:d[1].time,value:d[0]}));f.length>0&&r.ema.setData(f),u.length>0&&(r.rates.setData(u),t.value.timeScale().fitContent())}function a(u){return`${U(u*100,0,"percentage")}%`}const c=(u,m=7)=>u.map((f,d)=>{const $=Math.max(d-(m-1),0),V=d+1,T=u.slice($,V);return T.reduce((O,w)=>O+w,0)/T.length});return(u,m)=>{const f=re,d=R;return v(),y(d,{title:"Rates",loading:e(s)},{actions:h(()=>[i(f,{modelValue:e(n),"onUpdate:modelValue":m[0]||(m[0]=$=>Y(n)?n.value=$:null),class:"avg-span",placeholder:"Avg span (days)",min:1,max:1/0},null,8,["modelValue"])]),default:h(()=>[g("div",Ie,null,512)]),_:1},8,["loading"])}}}),We=S(Me,[["__scopeId","data-v-646458b1"]]),Qe={ref:"chartRef",class:"chart"},Pe=L({__name:"ChartMarketVolume",props:{market:{},chain:{}},setup(l){const{isFetching:s,data:p}=K(k("crvusd"),b(()=>{var o;return(o=l.market)==null?void 0:o.llamma}),k(()=>l.chain)),_=M(),{chart:n,series:t}=Q({createChartOptions:P(),series:{type:"Area",name:"volume",options:b(()=>({priceFormat:{type:"custom",formatter:o=>`$${U(o,0,"dollar")}${H(o)}`},lineWidth:2,lineType:D.WithSteps,lineColor:_.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});W(r);function r(){if(!n.value||!t.volume)return;const o=(p.value??[]).map(a=>({time:a.time.getUTCTimestamp(),value:a.volume})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc");o.length>0&&t.volume.setData(o),n.value.timeScale().fitContent()}return(o,a)=>{const c=R;return v(),y(c,{title:"Volume",loading:e(s)},{default:h(()=>[g("div",Qe,null,512)]),_:1},8,["loading"])}}}),Ee=["href"],Ne={key:1},Ue=L({__name:"Addresses",props:{market:{}},setup(l){const s=b(()=>{var n,t,r;return[{description:"Controller",address:(n=l.market)==null?void 0:n.address},{description:"Factory",address:(t=l.market)==null?void 0:t.factory},{description:"Llamma",address:(r=l.market)==null?void 0:r.llamma}]}),p=n=>`https://etherscan.io/address/${n}`,_=async n=>{await navigator.clipboard.writeText(n)};return(n,t)=>{const r=J,o=z,a=j,c=R;return v(),y(c,{class:"addresses",title:"Addresses"},{default:h(()=>[i(a,{class:"addresses-table",rows:e(s)},{row:h(({item:{description:u,address:m}})=>[g("div",null,q(u),1),g("div",null,[m?(v(),F("a",{key:0,class:"font-mono",target:"_blank",href:p(m)},q(m),9,Ee)):(v(),F("span",Ne,"?"))]),g("div",null,[m?(v(),y(o,{key:0,onClick:f=>_(m)},{default:h(()=>[i(r)]),_:2},1032,["onClick"])):B("",!0)])]),_:1},8,["rows"])]),_:1})}}}),He=S(Ue,[["__scopeId","data-v-c7c9d405"]]),ze={class:"token-info"},Ke=["href"],je={class:"token-info"},Je=["href"],Xe=L({__name:"Properties",props:{market:{},chain:{}},setup(l){const s=b(()=>{var t,r,o,a;return{type:"token",symbol:((r=(t=l.market)==null?void 0:t.tokenCollateral)==null?void 0:r.symbol)??"?",address:((a=(o=l.market)==null?void 0:o.tokenCollateral)==null?void 0:a.address)??"?"}}),p=b(()=>{var t,r,o,a;return{type:"token",symbol:((r=(t=l.market)==null?void 0:t.tokenStablecoin)==null?void 0:r.symbol)??"?",address:((a=(o=l.market)==null?void 0:o.tokenStablecoin)==null?void 0:a.address)??"?"}}),_=t=>`https://etherscan.io/address/${t}`,n=async t=>{await navigator.clipboard.writeText(t)};return(t,r)=>{const o=Ve,a=J,c=z,u=Se,m=j,f=R;return v(),y(f,{class:"properties",title:"Properties"},{default:h(()=>[i(m,{class:"properties-table"},{default:h(()=>[i(u,null,{default:h(()=>[r[2]||(r[2]=g("div",null,"Collateral",-1)),g("div",ze,[i(o,{chain:t.chain,address:e(s).address},null,8,["chain","address"]),g("div",null,q(e(s).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:_(e(s).address)},q(e(s).address),9,Ke)]),g("div",null,[i(c,{onClick:r[0]||(r[0]=d=>n(e(s).address))},{default:h(()=>[i(a)]),_:1})])])]),_:1}),i(u,null,{default:h(()=>[r[3]||(r[3]=g("div",null,"Borrowed",-1)),g("div",je,[i(o,{chain:t.chain,address:e(p).address},null,8,["chain","address"]),g("div",null,q(e(p).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:_(e(p).address)},q(e(p).address),9,Je)]),g("div",null,[i(c,{onClick:r[1]||(r[1]=d=>n(e(p).address))},{default:h(()=>[i(a)]),_:1})])])]),_:1})]),_:1})]),_:1})}}}),Ze=S(Xe,[["__scopeId","data-v-4a5fc69c"]]),Ge={class:"dashboard-grid"},Ye=L({__name:"MarketOverview",props:{market:{},chain:{}},setup(l){return(s,p)=>{const _=x,n=ee;return v(),F("div",Ge,[i(n,{style:{"grid-area":"kpi1"},label:"Borrow Rate","has-value":!!s.market},{default:h(()=>{var t;return[i(_,{type:"percentage",value:100*(((t=s.market)==null?void 0:t.rate)??0)},null,8,["value"])]}),_:1},8,["has-value"]),i(n,{style:{"grid-area":"kpi2"},label:"Borrowed","has-value":!!s.market},{default:h(()=>{var t;return[i(_,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowed},null,8,["value"])]}),_:1},8,["has-value"]),i(n,{style:{"grid-area":"kpi3"},label:"Borrowable","has-value":!!s.market},{default:h(()=>{var t;return[i(_,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowable},null,8,["value"])]}),_:1},8,["has-value"]),i(n,{style:{"grid-area":"kpi4"},label:"Loans","has-value":!!s.market},{default:h(()=>{var t;return[ae(q(((t=s.market)==null?void 0:t.loans)??0),1)]}),_:1},8,["has-value"]),i(e(We),{style:{"grid-area":"rates"},market:s.market},null,8,["market"]),i(e(Be),{style:{"grid-area":"cap"},market:s.market},null,8,["market"]),i(e(De),{style:{"grid-area":"loans"},market:s.market},null,8,["market"]),i(e(Pe),{style:{"grid-area":"volume"},market:s.market,chain:s.chain},null,8,["market","chain"]),i(e(Ze),{style:{"grid-area":"properties"},market:s.market,chain:s.chain},null,8,["market","chain"]),i(e(He),{style:{"grid-area":"addresses"},market:s.market,chain:s.chain},null,8,["market","chain"])])}}}),xe=S(Ye,[["__scopeId","data-v-a886f476"]]),ea={class:"dashboard-grid"},aa=L({__name:"Liquidations",props:{market:{},chain:{}},setup(l){const s=b(()=>{var w;return(w=l.market)==null?void 0:w.address}),{isFetching:p,data:_}=le(C("crvusd"),k(()=>l.chain),s),{isFetching:n,data:t}=I(k(()=>l.market)),r=b(()=>t.value.map(({timestamp:w,priceOracle:A})=>({timestamp:w,priceOracle:A}))),o=b(()=>t.value.map(({timestamp:w,discountLiquidation:A})=>({timestamp:w,discount:A}))),a=b(()=>t.value.map(({timestamp:w,totalCollateralUsd:A,totalDebt:X})=>({timestamp:w,ratio:A/X}))),{isFetching:c,data:u}=ce(C("crvusd"),k(()=>l.chain),s),{isFetching:m,data:f}=de(C("crvusd"),k(()=>l.chain),s),{isFetching:d,data:$}=ue(C("crvusd"),k(()=>l.chain),s),{isFetching:V,data:T}=me(C("crvusd"),k(()=>l.chain),s),{isFetching:E,data:O}=pe(C("crvusd"),k(()=>l.chain),s);return(w,A)=>(v(),F("div",ea,[i(e(_e),{overview:e(_),loading:e(p)},null,8,["overview","loading"]),i(e(he),{ratios:e(u),"prices-oracle":e(r),loading:e(c)||e(n)},null,8,["ratios","prices-oracle","loading"]),i(e(ve),{losses:e(O),loading:e(E)},null,8,["losses","loading"]),i(e(ge),{losses:e(O),loading:e(E)},null,8,["losses","loading"]),i(e(fe),{deciles:e(T),loading:e(V)},null,8,["deciles","loading"]),i(e(ke),{ratios:e(a),loading:e(n)},null,8,["ratios","loading"]),i(e(be),{liqs:e(f),loading:e(m)},null,8,["liqs","loading"]),i(e(ye),{liqs:e($),loading:e(d)},null,8,["liqs","loading"]),i(e(Ce),{discounts:e(o),liqs:e($),loading:e(n)||e(d)},null,8,["discounts","liqs","loading"])]))}}),ta=S(aa,[["__scopeId","data-v-25be6516"]]),sa={class:"dashboard-grid"},na=L({__name:"Trading",props:{market:{},chain:{}},setup(l){const s=b(()=>{var u;return(u=l.market)==null?void 0:u.llamma}),{isFetching:p,data:_}=K(C("crvusd"),s,k(()=>l.chain)),n=C(1),{isFetching:t,data:r}=$e(C("crvusd"),s,k(()=>l.chain),n),o=C(1),{isFetching:a,data:c}=we(C("crvusd"),s,k(()=>l.chain),o);return(u,m)=>{var f,d,$,V;return v(),F("div",sa,[i(e(Le),{style:{"grid-area":"ohlc"},ohlc:e(_)??[],loading:e(p)},null,8,["ohlc","loading"]),i(e(Te),{style:{"grid-area":"trades"},trades:((f=e(r))==null?void 0:f.trades)??[],count:((d=e(r))==null?void 0:d.count)??0,chain:u.chain,loading:e(t),onPage:m[0]||(m[0]=T=>n.value=T)},null,8,["trades","count","chain","loading"]),i(e(qe),{style:{"grid-area":"events"},events:(($=e(c))==null?void 0:$.events)??[],count:((V=e(c))==null?void 0:V.count)??0,loading:e(a),onPage:m[1]||(m[1]=T=>o.value=T)},null,8,["events","count","loading"])])}}}),oa=S(na,[["__scopeId","data-v-afc82b2f"]]),ia={class:"dashboard"},ra=L({__name:"Market.page",setup(l){const s=Ae("marketAddr"),{isFetching:p,data:_}=te(),n=b(()=>_.value.find(a=>a.address===s.value)),{crumbs:t}=se(ne());oe(n,a=>{t.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:`Market: ${(a==null?void 0:a.name)??"?"}`}]},{immediate:!0});const{tabActive:r,tabActiveIndex:o}=Fe(["overview","trading","liquidations"],"crvusdmarket",()=>({marketAddr:s.value}));return(a,c)=>{const u=ie,m=Z,f=G;return v(),F("div",ia,[i(u,{loading:e(p)},null,8,["loading"]),!e(p)&&e(n)?(v(),y(f,{key:0,active:e(o),onTab:c[0]||(c[0]=d=>o.value=d.index)},{default:h(()=>[i(m,{header:"Overview"},{default:h(()=>[(v(),y(N,null,[e(r)==="overview"?(v(),y(xe,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),i(m,{header:"Trading"},{default:h(()=>[(v(),y(N,null,[e(r)==="trading"?(v(),y(oa,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),i(m,{header:"Liquidations"},{default:h(()=>[(v(),y(N,null,[e(r)==="liquidations"?(v(),y(ta,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1})]),_:1},8,["active"])):B("",!0)])}}}),La=S(ra,[["__scopeId","data-v-e45685ee"]]);export{La as default};

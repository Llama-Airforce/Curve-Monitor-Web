import{d as $,T as D,f as _,U as F,V as B,h as A,o as x,w as f,a as c,b as n,u as o,_ as R,r as z,t as K,O as I,a9 as O,e as S,c as Q}from"./index-5B2tI7Zc.js";import{u as E,_ as M}from"./UseLegend-ifWC3xyM.js";import{u as N,a as W,c as j}from"./UseLightweightChart-C1SS2I-H.js";import{_ as q,a as G}from"./BtnChartLWFullscreen.vue_vue_type_script_setup_true_lang-B0dd4bO7.js";import{f as U,g as H}from"./crvusd-Brn7BR38.js";import{r as J,u as X}from"./Number-Bqyeu7gj.js";import{_ as Y}from"./Table-Br42HHVv.js";import{_ as Z}from"./AsyncValue-BrxM0dB4.js";import{_ as ee}from"./TokenIcon-SHuc7s7h.js";import{_ as se}from"./InputText-PEq0sSRg.js";import{d as oe}from"./pools-BK3Jf1b9.js";import"./Object-DOSYkgA0.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-Ds_Sub25.js";import"./UseHost-Ca9zgvDG.js";const ae={style:{display:"flex"}},te={ref:"chartRef",class:"chart"},le=$({__name:"ChartKeeperPrices",setup(h){const m=D(),v=["USDC","USDT"],{items:C,toggles:p,disabled:V}=E(()=>v.map((t,r)=>({id:t,label:t,color:m.value.colorsArray[r],togglable:!0}))),b=_(()=>L.value||P.value),{isFetching:L,data:k}=U(),w=_(()=>k.value.filter(t=>t.pair.some(({symbol:r})=>v.map(s=>s.toLocaleLowerCase()).includes(r.toLocaleLowerCase())))),{isFetching:P,data:T}=H(w),d=F("card"),{chart:y,series:e}=N({createChartOptions:j(),series:v.map((t,r)=>({type:"Line",name:t,options:_(()=>({priceFormat:{type:"custom",formatter:s=>`${J(s,3,"dollar")}${X(s)}`},lineWidth:2,lineType:W.WithSteps,color:m.value.colorsArray[r],lastValueVisible:!1,priceLineVisible:!1,autoscaleInfoProvider:s=>{const i=s();return i!==null&&(i.priceRange.minValue=Math.max(.98,i.priceRange.minValue),i.priceRange.maxValue=Math.min(1.02,i.priceRange.maxValue)),i}}))}))});B(l);function l(){var t,r;if(!(!y.value||Object.values(e).length<0)){for(const[,s]of v.entries()){(t=e[s])==null||t.applyOptions({visible:p[s].value});const i=T.value.map(u=>({time:u.timestamp,value:u[s]})).uniqWith((u,a)=>u.time===a.time).orderBy(u=>u.time,"asc");i.length>0&&((r=e[s])==null||r.setData(i))}y.value.timeScale().fitContent()}}return(t,r)=>{const s=M,i=R;return x(),A(i,{ref_key:"card",ref:d,title:"Pegkeepers Coin Prices",loading:o(b)},{actions:f(()=>[c("div",ae,[n(o(q),{filename:"keeper_prices",series:o(e)},null,8,["series"]),n(o(G),{chart:o(y),target:o(d)},null,8,["chart","target"])])]),"actions-secondary":f(()=>[n(s,{items:o(C),disabled:o(V),onToggle:r[0]||(r[0]=u=>o(p)[u].value=!o(p)[u].value)},null,8,["items","disabled"])]),default:f(()=>[c("div",te,null,512)]),_:1},8,["loading"])}}});function ne(h){return h!=null}const re={class:"end"},ie={class:"end"},ce={class:"end"},de={class:"end"},ue={class:"end"},pe={class:"end"},_e={class:"end"},me={class:"end"},ve=$({__name:"TablePegkeepers",setup(h){const m=z(""),v=_(()=>P.value||V.value),C=_(()=>b.value.filter(e=>e.active).map(e=>{const l=T.value.find(t=>e.poolAddress===t.address);if(l)return{...l,...e,pool:l.address}}).filter(ne).orderBy(e=>e.tvlUsd,"desc")),p=_(()=>C.value.filter(e=>{const l=m.value.toLocaleLowerCase().split(" "),t=r=>l.some(s=>r.toLocaleLowerCase().includes(s));return t(e.name)||t(e.address)})),{isFetching:V,data:b}=U(),L=e=>`${e.pair[1].symbol} / ${e.pair[0].symbol}`,k=_(()=>b.value.map(e=>e.poolAddress)),w=oe(z("ethereum"),k),P=_(()=>w.value.some(e=>e.isFetching)),T=_(()=>w.value.filter(e=>e.data).map(e=>e.data)),d=e=>e>=1e6?2:0,y=e=>e.pair.filter(l=>l.address.toLocaleLowerCase()!==O)[0].address;return(e,l)=>{const t=se,r=ee,s=Z,i=Y,u=R;return x(),A(u,{class:"pegkeepers-card",title:"Pegkeepers",loading:o(v)},{actions:f(()=>[n(t,{modelValue:o(m),"onUpdate:modelValue":l[0]||(l[0]=a=>I(m)?m.value=a:null),search:"",placeholder:"Search for.."},null,8,["modelValue"])]),default:f(()=>[n(i,{class:"pegkeepers-table",rows:o(p),columns:["","Name",{label:"Debt",align:"end"},{label:"TVL",align:"end"},{label:"Volume",align:"end"},{label:"Fees",align:"end"}]},{row:f(({item:a})=>[n(r,{chain:"ethereum",address:y(a)},null,8,["address"]),c("div",null,K(L(a)),1),c("div",re,[n(s,{"show-zero":"",type:"dollar",value:a.totalDebt,precision:d},null,8,["value"])]),c("div",ie,[n(s,{"show-zero":"",type:"dollar",value:a.tvlUsd,precision:d},null,8,["value"])]),c("div",ce,[n(s,{"show-zero":"",type:"dollar",value:a.tradingVolume24h,precision:d},null,8,["value"])]),c("div",de,[n(s,{"show-zero":"",type:"dollar",value:a.totalProfit,precision:d},null,8,["value"])])]),"row-aggregation":f(()=>[l[1]||(l[1]=c("div",null,null,-1)),l[2]||(l[2]=c("div",null,null,-1)),c("div",ue,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,g)=>a+g.totalDebt,0),precision:d},null,8,["value"])]),c("div",pe,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,g)=>a+g.tvlUsd,0),precision:d},null,8,["value"])]),c("div",_e,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,g)=>a+g.tradingVolume24h,0),precision:d},null,8,["value"])]),c("div",me,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,g)=>a+g.totalProfit,0),precision:d},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),ge=S(ve,[["__scopeId","data-v-030699ea"]]),fe={class:"dashboard"},he=$({__name:"Pegkeepers.page",setup(h){return(m,v)=>(x(),Q("div",fe,[n(o(ge),{style:{"grid-area":"table"}}),n(o(le),{style:{"grid-area":"chart"}})]))}}),De=S(he,[["__scopeId","data-v-f4603245"]]);export{De as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/secp256k1-BOZNhKy9.js","assets/index-8S3F9N49.js","assets/index-DblI59Pf.css","assets/getAction-BaCZVkE3.js"])))=>i.map(i=>d[i]);
import{k as me,l as $e,m as De,n as Re,o as pe,T as Ve,b as x,q as je,r as Oe,s as We,t as te,v as ye,w as ge,I as Ke,x as xe,y as we,W as Ye,e as Je,j as Qe,h as R,i as Xe}from"./getAction-BaCZVkE3.js";import{B,z as Pe,aI as Ze,s as Q,D as oe,p as et,aJ as j,aK as Be,aL as q,x as $,aM as z,aN as E,aO as Ie,aP as V,aF as D,aQ as tt,aR as W,aS as re,aT as nt,aU as st,aV as ot,aW as X,aX as rt,aY as N,y as at,aZ as it,a_ as ae,a$ as Z,b0 as ct,b1 as ie,b2 as ut,b3 as dt,b4 as ft,b5 as lt,b6 as ht,b7 as bt,b8 as mt,b9 as pt}from"./index-8S3F9N49.js";class Fe extends B{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class K extends B{constructor({docsPath:t,metaMessages:n,type:o}){super(`Account type "${o}" is not supported.`,{docsPath:t,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function yt(e){const t=Pe(`0x${e.substring(4)}`).substring(26);return Ze(`0x${t}`)}async function gt({hash:e,signature:t}){const n=Q(e)?e:oe(e),{secp256k1:o}=await et(async()=>{const{secp256k1:a}=await import("./secp256k1-BOZNhKy9.js");return{secp256k1:a}},__vite__mapDeps([0,1,2,3]));return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){const{r:u,s:l,v:d,yParity:f}=t,h=Number(f??d),m=ce(h);return new o.Signature(j(u),j(l)).addRecoveryBit(m)}const a=Q(t)?t:oe(t);if(Be(a)!==65)throw new Error("invalid signature length");const c=q(`0x${a.slice(130)}`),i=ce(c);return o.Signature.fromCompact(a.substring(2,130)).addRecoveryBit(i)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function ce(e){if(e===0||e===1)return e;if(e===27)return 0;if(e===28)return 1;throw new Error("Invalid yParityOrV value")}async function xt({hash:e,signature:t}){return yt(await gt({hash:e,signature:t}))}function wt(e,t="hex"){const n=Ge(e),o=me(new Uint8Array(n.length));return n.encode(o),t==="hex"?$(o.bytes):o.bytes}function Ge(e){return Array.isArray(e)?Pt(e.map(t=>Ge(t))):Bt(e)}function Pt(e){const t=e.reduce((s,r)=>s+r.length,0),n=Te(t);return{length:t<=55?1+t:1+n+t,encode(s){t<=55?s.pushByte(192+t):(s.pushByte(247+n),n===1?s.pushUint8(t):n===2?s.pushUint16(t):n===3?s.pushUint24(t):s.pushUint32(t));for(const{encode:r}of e)r(s)}}}function Bt(e){const t=typeof e=="string"?z(e):e,n=Te(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length,encode(s){t.length===1&&t[0]<128?s.pushBytes(t):t.length<=55?(s.pushByte(128+t.length),s.pushBytes(t)):(s.pushByte(183+n),n===1?s.pushUint8(t.length):n===2?s.pushUint16(t.length):n===3?s.pushUint24(t.length):s.pushUint32(t.length),s.pushBytes(t))}}}function Te(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new B("Length is too large.")}function It(e){const{chainId:t,nonce:n,to:o}=e,s=e.contractAddress??e.address,r=Pe($e(["0x05",wt([t?E(t):"0x",s,n?E(n):"0x"])]));return o==="bytes"?z(r):r}async function ke(e){const{authorization:t,signature:n}=e;return xt({hash:It(t),signature:n??t})}function Ft({chain:e,currentChainId:t}){if(!e)throw new De;if(t!==e.id)throw new Re({chain:e,currentChainId:t})}function Gt(e,{docsPath:t,...n}){const o=(()=>{const s=pe(e,n);return s instanceof Ie?e:s})();return new Ve(o,{docsPath:t,...n})}async function Ne(e){const t=await e.request({method:"eth_chainId"},{dedupe:!0});return q(t)}class Tt extends B{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class ne extends B{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class kt extends B{constructor({maxPriorityFeePerGas:t}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${V(t)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class Ee extends B{constructor({blockHash:t,blockNumber:n}){let o="Block";t&&(o=`Block at hash "${t}"`),n&&(o=`Block at number "${n}"`),super(`${o} could not be found.`,{name:"BlockNotFoundError"})}}const Ce={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function ve(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?q(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?q(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?Ce[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=Nt(e.authorizationList)),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}function Nt(e){return e.map(t=>({address:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function Et(e){const t=(e.transactions??[]).map(n=>typeof n=="string"?n:ve(n));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function S(e,{blockHash:t,blockNumber:n,blockTag:o,includeTransactions:s}={}){const r=o??"latest",a=s??!1,c=n!==void 0?E(n):void 0;let i=null;if(t?i=await e.request({method:"eth_getBlockByHash",params:[t,a]},{dedupe:!0}):i=await e.request({method:"eth_getBlockByNumber",params:[c||r,a]},{dedupe:!!c}),!i)throw new Ee({blockHash:t,blockNumber:n});return(e.chain?.formatters?.block?.format||Et)(i)}async function _e(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function Ct(e,t){const{block:n,chain:o=e.chain,request:s}=t||{};try{const r=o?.fees?.maxPriorityFeePerGas??o?.fees?.defaultPriorityFee;if(typeof r=="function"){const c=n||await x(e,S,"getBlock")({}),i=await r({block:c,client:e,request:s});if(i===null)throw new Error;return i}if(typeof r<"u")return r;const a=await e.request({method:"eth_maxPriorityFeePerGas"});return j(a)}catch{const[r,a]=await Promise.all([n?Promise.resolve(n):x(e,S,"getBlock")({}),x(e,_e,"getGasPrice")({})]);if(typeof r.baseFeePerGas!="bigint")throw new ne;const c=a-r.baseFeePerGas;return c<0n?0n:c}}async function ue(e,t){const{block:n,chain:o=e.chain,request:s,type:r="eip1559"}=t||{},a=await(async()=>typeof o?.fees?.baseFeeMultiplier=="function"?o.fees.baseFeeMultiplier({block:n,client:e,request:s}):o?.fees?.baseFeeMultiplier??1.2)();if(a<1)throw new Tt;const i=10**(a.toString().split(".")[1]?.length??0),u=f=>f*BigInt(Math.ceil(a*i))/BigInt(i),l=n||await x(e,S,"getBlock")({});if(typeof o?.fees?.estimateFeesPerGas=="function"){const f=await o.fees.estimateFeesPerGas({block:n,client:e,multiply:u,request:s,type:r});if(f!==null)return f}if(r==="eip1559"){if(typeof l.baseFeePerGas!="bigint")throw new ne;const f=typeof s?.maxPriorityFeePerGas=="bigint"?s.maxPriorityFeePerGas:await Ct(e,{block:l,chain:o,request:s}),h=u(l.baseFeePerGas);return{maxFeePerGas:s?.maxFeePerGas??h+f,maxPriorityFeePerGas:f}}return{gasPrice:s?.gasPrice??u(await x(e,_e,"getGasPrice")({}))}}class vt extends B{constructor(t,{account:n,docsPath:o,chain:s,data:r,gas:a,gasPrice:c,maxFeePerGas:i,maxPriorityFeePerGas:u,nonce:l,to:d,value:f}){const h=je({from:n?.address,to:d,value:typeof f<"u"&&`${Oe(f)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:a,gasPrice:typeof c<"u"&&`${V(c)} gwei`,maxFeePerGas:typeof i<"u"&&`${V(i)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${V(u)} gwei`,nonce:l});super(t.shortMessage,{cause:t,docsPath:o,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Estimate Gas Arguments:",h].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}function _t(e,{docsPath:t,...n}){const o=(()=>{const s=pe(e,n);return s instanceof Ie?e:s})();return new vt(o,{docsPath:t,...n})}async function At(e,{address:t,blockNumber:n,blockTag:o="latest"}){const s=typeof n=="bigint"?E(n):void 0,r=await e.request({method:"eth_getBalance",params:[t,s||o]});return BigInt(r)}async function Ht(e,t){const{account:n=e.account}=t,o=n?D(n):void 0;try{let k=function(O){const{block:M,request:U,rpcStateOverride:L}=O;return e.request({method:"eth_estimateGas",params:L?[U,M??"latest",L]:M?[U,M]:[U]})};const{accessList:s,authorizationList:r,blobs:a,blobVersionedHashes:c,blockNumber:i,blockTag:u,data:l,gas:d,gasPrice:f,maxFeePerBlobGas:h,maxFeePerGas:m,maxPriorityFeePerGas:g,nonce:I,value:b,stateOverride:p,...y}=await ze(e,{...t,parameters:o?.type==="local"?void 0:["blobVersionedHashes"]}),F=(typeof i=="bigint"?E(i):void 0)||u,G=We(p),T=await(async()=>{if(y.to)return y.to;if(r&&r.length>0)return await ke({authorization:r[0]}).catch(()=>{throw new B("`to` is required. Could not infer from `authorizationList`")})})();te(t);const C=e.chain?.formatters?.transactionRequest?.format,P=(C||ye)({...ge(y,{format:C}),from:o?.address,accessList:s,authorizationList:r,blobs:a,blobVersionedHashes:c,data:l,gas:d,gasPrice:f,maxFeePerBlobGas:h,maxFeePerGas:m,maxPriorityFeePerGas:g,nonce:I,to:T,value:b});let v=BigInt(await k({block:F,request:P,rpcStateOverride:G}));if(r){const O=await At(e,{address:P.from}),M=await Promise.all(r.map(async U=>{const{address:L}=U,Se=await k({block:F,request:{authorizationList:void 0,data:l,from:o?.address,to:L,value:E(O)},rpcStateOverride:G}).catch(()=>100000n);return 2n*BigInt(Se)}));v+=M.reduce((U,L)=>U+L,0n)}return v}catch(s){throw _t(s,{...t,account:o,chain:e.chain})}}async function Ut(e,{address:t,blockTag:n="latest",blockNumber:o}){const s=await e.request({method:"eth_getTransactionCount",params:[t,typeof o=="bigint"?E(o):n]},{dedupe:!!o});return q(s)}function Ae(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),o=typeof e.blobs[0]=="string"?e.blobs.map(r=>z(r)):e.blobs,s=[];for(const r of o)s.push(Uint8Array.from(t.blobToKzgCommitment(r)));return n==="bytes"?s:s.map(r=>$(r))}function He(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),o=typeof e.blobs[0]=="string"?e.blobs.map(a=>z(a)):e.blobs,s=typeof e.commitments[0]=="string"?e.commitments.map(a=>z(a)):e.commitments,r=[];for(let a=0;a<o.length;a++){const c=o[a],i=s[a];r.push(Uint8Array.from(t.computeBlobKzgProof(c,i)))}return n==="bytes"?r:r.map(a=>$(a))}function Lt(e,t,n,o){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,o);const s=BigInt(32),r=BigInt(4294967295),a=Number(n>>s&r),c=Number(n&r),i=o?4:0,u=o?0:4;e.setUint32(t+i,a,o),e.setUint32(t+u,c,o)}function qt(e,t,n){return e&t^~e&n}function zt(e,t,n){return e&t^e&n^t&n}class Mt extends tt{constructor(t,n,o,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=o,this.isLE=s,this.buffer=new Uint8Array(t),this.view=W(this.buffer)}update(t){re(this),t=nt(t),st(t);const{view:n,buffer:o,blockLen:s}=this,r=t.length;for(let a=0;a<r;){const c=Math.min(s-this.pos,r-a);if(c===s){const i=W(t);for(;s<=r-a;a+=s)this.process(i,a);continue}o.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){re(this),ot(t,this),this.finished=!0;const{buffer:n,view:o,blockLen:s,isLE:r}=this;let{pos:a}=this;n[a++]=128,X(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(o,0),a=0);for(let d=a;d<s;d++)n[d]=0;Lt(o,s-8,BigInt(this.length*8),r),this.process(o,0);const c=W(t),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=i/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)c.setUint32(4*d,l[d],r)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const o=t.slice(0,n);return this.destroy(),o}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:o,length:s,finished:r,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=r,t.length=s,t.pos=c,s%n&&t.buffer.set(o),t}clone(){return this._cloneInto()}}const _=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),St=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),A=new Uint32Array(64);class $t extends Mt{constructor(t=32){super(64,t,8,!1),this.A=_[0]|0,this.B=_[1]|0,this.C=_[2]|0,this.D=_[3]|0,this.E=_[4]|0,this.F=_[5]|0,this.G=_[6]|0,this.H=_[7]|0}get(){const{A:t,B:n,C:o,D:s,E:r,F:a,G:c,H:i}=this;return[t,n,o,s,r,a,c,i]}set(t,n,o,s,r,a,c,i){this.A=t|0,this.B=n|0,this.C=o|0,this.D=s|0,this.E=r|0,this.F=a|0,this.G=c|0,this.H=i|0}process(t,n){for(let d=0;d<16;d++,n+=4)A[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const f=A[d-15],h=A[d-2],m=N(f,7)^N(f,18)^f>>>3,g=N(h,17)^N(h,19)^h>>>10;A[d]=g+A[d-7]+m+A[d-16]|0}let{A:o,B:s,C:r,D:a,E:c,F:i,G:u,H:l}=this;for(let d=0;d<64;d++){const f=N(c,6)^N(c,11)^N(c,25),h=l+f+qt(c,i,u)+St[d]+A[d]|0,g=(N(o,2)^N(o,13)^N(o,22))+zt(o,s,r)|0;l=u,u=i,i=c,c=a+h|0,a=r,r=s,s=o,o=h+g|0}o=o+this.A|0,s=s+this.B|0,r=r+this.C|0,a=a+this.D|0,c=c+this.E|0,i=i+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(o,s,r,a,c,i,u,l)}roundClean(){X(A)}destroy(){this.set(0,0,0,0,0,0,0,0),X(this.buffer)}}const Dt=rt(()=>new $t),Rt=Dt;function Vt(e,t){return Rt(Q(e,{strict:!1})?at(e):e)}function jt(e){const{commitment:t,version:n=1}=e,o=e.to??(typeof t=="string"?"hex":"bytes"),s=Vt(t);return s.set([n],0),o==="bytes"?s:$(s)}function Ot(e){const{commitments:t,version:n}=e,o=e.to,s=[];for(const r of t)s.push(jt({commitment:r,to:o,version:n}));return s}const de=6,Ue=32,se=4096,Le=Ue*se,fe=Le*de-1-1*se*de;class Wt extends B{constructor({maxSize:t,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class Kt extends B{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function Yt(e){const t=typeof e.data=="string"?z(e.data):e.data,n=Be(t);if(!n)throw new Kt;if(n>fe)throw new Wt({maxSize:fe,size:n});const o=[];let s=!0,r=0;for(;s;){const a=me(new Uint8Array(Le));let c=0;for(;c<se;){const i=t.slice(r,r+(Ue-1));if(a.pushByte(0),a.pushBytes(i),i.length<31){a.pushByte(128),s=!1;break}c++,r+=31}o.push(a)}return o.map(a=>$(a.bytes))}function Jt(e){const{data:t,kzg:n,to:o}=e,s=e.blobs??Yt({data:t}),r=e.commitments??Ae({blobs:s,kzg:n,to:o}),a=e.proofs??He({blobs:s,commitments:r,kzg:n,to:o}),c=[];for(let i=0;i<s.length;i++)c.push({blob:s[i],commitment:r[i],proof:a[i]});return c}function Qt(e){if(e.type)return e.type;if(typeof e.authorizationList<"u")return"eip7702";if(typeof e.blobs<"u"||typeof e.blobVersionedHashes<"u"||typeof e.maxFeePerBlobGas<"u"||typeof e.sidecars<"u")return"eip4844";if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new Ke({transaction:e})}const qe=["blobVersionedHashes","chainId","fees","gas","nonce","type"],le=new Map;async function ze(e,t){const{account:n=e.account,blobs:o,chain:s,gas:r,kzg:a,nonce:c,nonceManager:i,parameters:u=qe,type:l}=t,d=n&&D(n),f={...t,...d?{from:d?.address}:{}};let h;async function m(){return h||(h=await x(e,S,"getBlock")({blockTag:"latest"}),h)}let g;async function I(){return g||(s?s.id:typeof t.chainId<"u"?t.chainId:(g=await x(e,Ne,"getChainId")({}),g))}if(u.includes("nonce")&&typeof c>"u"&&d)if(i){const b=await I();f.nonce=await i.consume({address:d.address,chainId:b,client:e})}else f.nonce=await x(e,Ut,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&o&&a){const b=Ae({blobs:o,kzg:a});if(u.includes("blobVersionedHashes")){const p=Ot({commitments:b,to:"hex"});f.blobVersionedHashes=p}if(u.includes("sidecars")){const p=He({blobs:o,commitments:b,kzg:a}),y=Jt({blobs:o,commitments:b,proofs:p,to:"hex"});f.sidecars=y}}if(u.includes("chainId")&&(f.chainId=await I()),(u.includes("fees")||u.includes("type"))&&typeof l>"u")try{f.type=Qt(f)}catch{let b=le.get(e.uid);typeof b>"u"&&(b=typeof(await m())?.baseFeePerGas=="bigint",le.set(e.uid,b)),f.type=b?"eip1559":"legacy"}if(u.includes("fees"))if(f.type!=="legacy"&&f.type!=="eip2930"){if(typeof f.maxFeePerGas>"u"||typeof f.maxPriorityFeePerGas>"u"){const b=await m(),{maxFeePerGas:p,maxPriorityFeePerGas:y}=await ue(e,{block:b,chain:s,request:f});if(typeof t.maxPriorityFeePerGas>"u"&&t.maxFeePerGas&&t.maxFeePerGas<y)throw new kt({maxPriorityFeePerGas:y});f.maxPriorityFeePerGas=y,f.maxFeePerGas=p}}else{if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")throw new ne;if(typeof t.gasPrice>"u"){const b=await m(),{gasPrice:p}=await ue(e,{block:b,chain:s,request:f,type:"legacy"});f.gasPrice=p}}return u.includes("gas")&&typeof r>"u"&&(f.gas=await x(e,Ht,"estimateGas")({...f,account:d&&{address:d.address,type:"json-rpc"}})),te(f),delete f.parameters,f}async function Xt(e,{serializedTransaction:t}){return e.request({method:"eth_sendRawTransaction",params:[t]},{retryCount:0})}const Y=new it(128);async function Zt(e,t){const{account:n=e.account,chain:o=e.chain,accessList:s,authorizationList:r,blobs:a,data:c,gas:i,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,type:m,value:g,...I}=t;if(typeof n>"u")throw new Fe({docsPath:"/docs/actions/wallet/sendTransaction"});const b=n?D(n):null;try{te(t);const p=await(async()=>{if(t.to)return t.to;if(t.to!==null&&r&&r.length>0)return await ke({authorization:r[0]}).catch(()=>{throw new B("`to` is required. Could not infer from `authorizationList`.")})})();if(b?.type==="json-rpc"||b===null){let y;o!==null&&(y=await x(e,Ne,"getChainId")({}),Ft({currentChainId:y,chain:o}));const H=e.chain?.formatters?.transactionRequest?.format,G=(H||ye)({...ge(I,{format:H}),accessList:s,authorizationList:r,blobs:a,chainId:y,data:c,from:b?.address,gas:i,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,to:p,type:m,value:g}),T=Y.get(e.uid),C=T?"wallet_sendTransaction":"eth_sendTransaction";try{return await e.request({method:C,params:[G]},{retryCount:0})}catch(w){if(T===!1)throw w;const P=w;if(P.name==="InvalidInputRpcError"||P.name==="InvalidParamsRpcError"||P.name==="MethodNotFoundRpcError"||P.name==="MethodNotSupportedRpcError")return await e.request({method:"wallet_sendTransaction",params:[G]},{retryCount:0}).then(k=>(Y.set(e.uid,!0),k)).catch(k=>{const v=k;throw v.name==="MethodNotFoundRpcError"||v.name==="MethodNotSupportedRpcError"?(Y.set(e.uid,!1),P):v});throw P}}if(b?.type==="local"){const y=await x(e,ze,"prepareTransactionRequest")({account:b,accessList:s,authorizationList:r,blobs:a,chain:o,data:c,gas:i,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,nonceManager:b.nonceManager,parameters:[...qe,"sidecars"],type:m,value:g,...I,to:p}),H=o?.serializers?.transaction,F=await b.signTransaction(y,{serializer:H});return await x(e,Xt,"sendRawTransaction")({serializedTransaction:F})}throw b?.type==="smart"?new K({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new K({docsPath:"/docs/actions/wallet/sendTransaction",type:b?.type})}catch(p){throw p instanceof K?p:Gt(p,{...t,account:b,chain:t.chain||void 0})}}const en=new Map,tn=new Map;function nn(e){const t=(s,r)=>({clear:()=>r.delete(s),get:()=>r.get(s),set:a=>r.set(s,a)}),n=t(e,en),o=t(e,tn);return{clear:()=>{n.clear(),o.clear()},promise:n,response:o}}async function sn(e,{cacheKey:t,cacheTime:n=Number.POSITIVE_INFINITY}){const o=nn(t),s=o.response.get();if(s&&n>0&&new Date().getTime()-s.created.getTime()<n)return s.data;let r=o.promise.get();r||(r=e(),o.promise.set(r));try{const a=await r;return o.response.set({created:new Date,data:a}),a}finally{o.promise.clear()}}const on=e=>`blockNumber.${e}`;async function rn(e,{cacheTime:t=e.cacheTime}={}){const n=await sn(()=>e.request({method:"eth_blockNumber"}),{cacheKey:on(e.uid),cacheTime:t});return BigInt(n)}function an(e,{args:t,eventName:n}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}async function Me(e,{blockHash:t,blockNumber:n,blockTag:o,hash:s,index:r}){const a=o||"latest",c=n!==void 0?E(n):void 0;let i=null;if(s?i=await e.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):t?i=await e.request({method:"eth_getTransactionByBlockHashAndIndex",params:[t,E(r)]},{dedupe:!0}):i=await e.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[c||a,E(r)]},{dedupe:!!c}),!i)throw new xe({blockHash:t,blockNumber:n,blockTag:a,hash:s,index:r});return(e.chain?.formatters?.transaction?.format||ve)(i)}const cn={"0x0":"reverted","0x1":"success"};function un(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map(n=>an(n)):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?q(e.transactionIndex):null,status:e.status?cn[e.status]:null,type:e.type?Ce[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}async function he(e,{hash:t}){const n=await e.request({method:"eth_getTransactionReceipt",params:[t]},{dedupe:!0});if(!n)throw new we({hash:t});return(e.chain?.formatters?.transactionReceipt?.format||un)(n)}const J=new Map,be=new Map;let dn=0;function ee(e,t,n){const o=++dn,s=()=>J.get(e)||[],r=()=>{const l=s();J.set(e,l.filter(d=>d.id!==o))},a=()=>{const l=s();if(!l.some(f=>f.id===o))return;const d=be.get(e);if(l.length===1&&d){const f=d();f instanceof Promise&&f.catch(()=>{})}r()},c=s();if(J.set(e,[...c,{id:o,fns:t}]),c&&c.length>0)return a;const i={};for(const l in t)i[l]=(...d)=>{const f=s();if(f.length!==0)for(const h of f)h.fns[l]?.(...d)};const u=n(i);return typeof u=="function"&&be.set(e,u),a}function fn(e,{emitOnBegin:t,initialWaitTime:n,interval:o}){let s=!0;const r=()=>s=!1;return(async()=>{let c;t&&(c=await e({unpoll:r}));const i=await n?.(c)??o;await ae(i);const u=async()=>{s&&(await e({unpoll:r}),await ae(o),u())};u()})(),r}function ln(e,{emitOnBegin:t=!1,emitMissed:n=!1,onBlockNumber:o,onError:s,poll:r,pollingInterval:a=e.pollingInterval}){const c=typeof r<"u"?r:!(e.transport.type==="webSocket"||e.transport.type==="ipc"||e.transport.type==="fallback"&&(e.transport.transports[0].config.type==="webSocket"||e.transport.transports[0].config.type==="ipc"));let i;return c?(()=>{const d=Z(["watchBlockNumber",e.uid,t,n,a]);return ee(d,{onBlockNumber:o,onError:s},f=>fn(async()=>{try{const h=await x(e,rn,"getBlockNumber")({cacheTime:0});if(i){if(h===i)return;if(h-i>1&&n)for(let m=i+1n;m<h;m++)f.onBlockNumber(m,i),i=m}(!i||h>i)&&(f.onBlockNumber(h,i),i=h)}catch(h){f.onError?.(h)}},{emitOnBegin:t,interval:a}))})():(()=>{const d=Z(["watchBlockNumber",e.uid,t,n]);return ee(d,{onBlockNumber:o,onError:s},f=>{let h=!0,m=()=>h=!1;return(async()=>{try{const g=(()=>{if(e.transport.type==="fallback"){const b=e.transport.transports.find(p=>p.config.type==="webSocket"||p.config.type==="ipc");return b?b.value:e.transport}return e.transport})(),{unsubscribe:I}=await g.subscribe({params:["newHeads"],onData(b){if(!h)return;const p=j(b.result?.number);f.onBlockNumber(p,i),i=p},onError(b){f.onError?.(b)}});m=I,h||m()}catch(g){s?.(g)}})(),()=>m()})})()}async function hn(e,{confirmations:t=1,hash:n,onReplaced:o,pollingInterval:s=e.pollingInterval,retryCount:r=6,retryDelay:a=({count:i})=>~~(1<<i)*200,timeout:c=18e4}){const i=Z(["waitForTransactionReceipt",e.uid,n]);let u,l,d,f=!1,h,m;const{promise:g,resolve:I,reject:b}=ct(),p=c?setTimeout(()=>{m(),h(),b(new Ye({hash:n}))},c):void 0;return h=ee(i,{onReplaced:o,resolve:I,reject:b},y=>{m=x(e,ln,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(H){const F=T=>{clearTimeout(p),m(),T(),h()};let G=H;if(!f)try{if(d){if(t>1&&(!d.blockNumber||G-d.blockNumber+1n<t))return;F(()=>y.resolve(d));return}if(u||(f=!0,await ie(async()=>{u=await x(e,Me,"getTransaction")({hash:n}),u.blockNumber&&(G=u.blockNumber)},{delay:a,retryCount:r}),f=!1),d=await x(e,he,"getTransactionReceipt")({hash:n}),t>1&&(!d.blockNumber||G-d.blockNumber+1n<t))return;F(()=>y.resolve(d))}catch(T){if(T instanceof xe||T instanceof we){if(!u){f=!1;return}try{l=u,f=!0;const C=await ie(()=>x(e,S,"getBlock")({blockNumber:G,includeTransactions:!0}),{delay:a,retryCount:r,shouldRetry:({error:k})=>k instanceof Ee});f=!1;const w=C.transactions.find(({from:k,nonce:v})=>k===l.from&&v===l.nonce);if(!w||(d=await x(e,he,"getTransactionReceipt")({hash:w.hash}),t>1&&(!d.blockNumber||G-d.blockNumber+1n<t)))return;let P="replaced";w.to===l.to&&w.value===l.value&&w.input===l.input?P="repriced":w.from===w.to&&w.value===0n&&(P="cancelled"),F(()=>{y.onReplaced?.({reason:P,replacedTransaction:l,transaction:w,transactionReceipt:d}),y.resolve(d)})}catch(C){F(()=>y.reject(C))}}else F(()=>y.reject(T))}}})}),g}async function bn(e,t){const{abi:n,account:o=e.account,address:s,args:r,dataSuffix:a,functionName:c,...i}=t;if(typeof o>"u")throw new Fe({docsPath:"/docs/contract/writeContract"});const u=o?D(o):null,l=Je({abi:n,args:r,functionName:c});try{return await x(e,Zt,"sendTransaction")({data:`${l}${a?a.replace("0x",""):""}`,to:s,account:u,...i})}catch(d){throw Qe(d,{abi:n,address:s,args:r,docsPath:"/docs/contract/writeContract",functionName:c,sender:u?.address})}}function mn(e,t={}){const{key:n="custom",methods:o,name:s="Custom Provider",retryDelay:r}=t;return({retryCount:a})=>ut({key:n,methods:o,name:s,request:e.request.bind(e),retryCount:t.retryCount??a,retryDelay:r,type:"custom"})}async function pn(e,t={}){let n;if(t.connector){const{connector:u}=t;if(e.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new dt({connector:u});const[l,d]=await Promise.all([u.getAccounts().catch(f=>{if(t.account===null)return[];throw f}),u.getChainId()]);n={accounts:l,chainId:d,connector:u}}else n=e.state.connections.get(e.state.current);if(!n)throw new ft;const o=t.chainId??n.chainId,s=await n.connector.getChainId();if(s!==n.chainId)throw new lt({connectionChainId:n.chainId,connectorChainId:s});const r=n.connector;if(r.getClient)return r.getClient({chainId:o});const a=D(t.account??n.accounts[0]);if(a&&(a.address=ht(a.address)),t.account&&!n.accounts.some(u=>u.toLowerCase()===a.address.toLowerCase()))throw new bt({address:a.address,connector:r});const c=e.chains.find(u=>u.id===o),i=await n.connector.getProvider({chainId:o});return mt({account:a,chain:c,name:"Connector Client",transport:u=>mn(i)({...u,retryCount:0})})}async function xn(e,t){const{chainId:n,timeout:o=0,...s}=t,r=e.getClient({chainId:n}),c=await R(r,hn,"waitForTransactionReceipt")({...s,timeout:o});if(c.status==="reverted"){const u=await R(r,Me,"getTransaction")({hash:c.transactionHash}),d=await R(r,Xe,"call")({...u,data:u.input,gasPrice:u.type!=="eip1559"?u.gasPrice:void 0,maxFeePerGas:u.type==="eip1559"?u.maxFeePerGas:void 0,maxPriorityFeePerGas:u.type==="eip1559"?u.maxPriorityFeePerGas:void 0}),f=d?.data?pt(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(f)}return{...c,chainId:r.chain.id}}async function wn(e,t){const{account:n,chainId:o,connector:s,...r}=t;let a;return typeof n=="object"&&n?.type==="local"?a=e.getClient({chainId:o}):a=await pn(e,{account:n??void 0,chainId:o,connector:s}),await R(a,bn,"writeContract")({...r,...n?{account:n}:{},chain:o?{id:o}:null})}export{wn as a,pn as g,Dt as s,xn as w};

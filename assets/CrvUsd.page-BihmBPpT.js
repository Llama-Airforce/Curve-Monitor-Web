import{d as S,r as B,f as C,T as A,U as R,V as F,h as L,o as T,w as u,a,b as t,u as l,j as b,_ as D,e as $,t as k,O as I,a4 as M,a5 as N,$ as W,c as E}from"./index-D_ZRdWWY.js";import{u as O,_ as z}from"./UseLegend-C-TEhwkE.js";import{_ as Q}from"./ButtonToggle-B3YwTilP.js";import{u as j,b as V,c as q,_ as K,a as P}from"./UseLightweightChart-CKO-jo9q.js";import{d as G,u as H}from"./crvusd-BzaLQZ_O.js";import{r as J,u as X}from"./Number-_oqacp-E.js";import{_ as Y}from"./Table-CAzuqdbI.js";import{_ as Z}from"./AsyncValue-CjNdb71H.js";import{_ as ee}from"./TokenIcon-e4N8L8cN.js";import{_ as se}from"./IconExpander-B4hQsFlV.js";import{_ as te}from"./InputText-DC_DofW0.js";import"./Object-DOSYkgA0.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-DHettQXn.js";const le={style:{display:"flex"}},oe={class:"actions-secondary"},ae={class:"button-group"},ne={ref:"chartRef",class:"chart"},re=S({__name:"ChartCrvUsdSupply",setup(U){const i=B("3m"),g=C(()=>{switch(i.value){case"7d":return 7;case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 90}}),d=A(),{items:c}=O(()=>[{id:"supply",label:"Supply",color:d.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:d.value.colorsArray[1]}]),{isFetching:h,data:w}=G(g),p=R("card"),{chart:m,series:o}=j({createChartOptions:q(),series:[{type:"Area",name:"supply",options:C(()=>({priceFormat:{type:"custom",formatter:y},lineWidth:2,lineType:V.WithSteps,lineColor:d.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"debt",options:C(()=>({priceFormat:{type:"custom",formatter:y},lineWidth:2,lineType:V.WithSteps,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});F(f);function f(){if(!m.value||!o.debt||!o.supply)return;const _=w.value.groupBy(r=>r.timestamp.getTime()).entries().map(([,r])=>{var s;return{time:r[0].timestamp.getUTCTimestamp(),value:r.reduce((n,x)=>n+x.supply,0),debt:((s=r.find(n=>n.market==="Keepers debt"))==null?void 0:s.supply)??0}}).uniqWith((r,s)=>r.time===s.time).orderBy(r=>r.time,"asc"),e=_.map(r=>({time:r.time,value:r.value-r.debt}));_.length>0&&o.supply.setData(_),e.length>0&&o.debt.setData(e),m.value.timeScale().fitContent();const v=new Date(Date.UTC(2025,2,20));o.supply.setMarkers([{time:v.getUTCTimestamp(),position:"aboveBar",color:d.value.colors.red,shape:"arrowDown",text:"Resupply Launch"}])}function y(_){return`${J(_,0,"dollar")}${X(_)}`}return(_,e)=>{const v=Q,r=z,s=D;return T(),L(s,{ref_key:"card",ref:p,title:"crvUSD Supply",class:"stack-actions",loading:l(h)},{actions:u(()=>[a("div",le,[t(l(K),{filename:"crvusd_supply",series:l(o)},null,8,["series"]),t(l(P),{chart:l(m),target:l(p)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[a("div",oe,[a("div",ae,[t(v,{"model-value":l(i)==="7d",onClick:e[0]||(e[0]=n=>i.value="7d")},{default:u(()=>e[5]||(e[5]=[b(" 7d ")])),_:1},8,["model-value"]),t(v,{"model-value":l(i)==="1m",onClick:e[1]||(e[1]=n=>i.value="1m")},{default:u(()=>e[6]||(e[6]=[b(" 1m ")])),_:1},8,["model-value"]),t(v,{"model-value":l(i)==="3m",onClick:e[2]||(e[2]=n=>i.value="3m")},{default:u(()=>e[7]||(e[7]=[b(" 3m ")])),_:1},8,["model-value"]),t(v,{"model-value":l(i)==="6m",onClick:e[3]||(e[3]=n=>i.value="6m")},{default:u(()=>e[8]||(e[8]=[b(" 6m ")])),_:1},8,["model-value"]),t(v,{"model-value":l(i)==="1y",onClick:e[4]||(e[4]=n=>i.value="1y")},{default:u(()=>e[9]||(e[9]=[b(" 1y ")])),_:1},8,["model-value"])]),t(r,{items:l(c)},null,8,["items"])])]),default:u(()=>[a("div",ne,null,512)]),_:1},8,["loading"])}}}),ie=$(re,[["__scopeId","data-v-9ca02096"]]),de={class:"end"},ue={class:"end"},ce={class:"end"},pe={class:"end"},me={class:"end"},_e={class:"end"},ve={class:"end"},fe={class:"end"},ye={class:"end"},ge={class:"end"},be={class:"end"},he=S({__name:"TableMarkets",emits:["select"],setup(U,{emit:i}){const g=i,d=B(""),c=C(()=>w.value.filter(m=>{const o=d.value.toLocaleLowerCase().split(" "),f=y=>o.some(_=>y.toLocaleLowerCase().includes(_));return f(m.name)||f(m.address)}).orderBy(m=>m.borrowed,"desc")),{isFetching:h,data:w}=H(),p=m=>m>=1e6?2:0;return(m,o)=>{const f=te,y=se,_=ee,e=Z,v=Y,r=D;return T(),L(r,{class:"markets-card",title:"Markets",loading:l(h)},{actions:u(()=>[t(f,{modelValue:l(d),"onUpdate:modelValue":o[0]||(o[0]=s=>I(d)?d.value=s:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:u(()=>[t(v,{class:"markets-table",rows:l(c),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:o[1]||(o[1]=s=>g("select",s))},{row:u(({item:s})=>[t(y),t(_,{chain:"ethereum",address:s.collateralToken.address},null,8,["address"]),a("div",null,k(s.name),1),a("div",de,k(s.loans),1),a("div",ue,[t(e,{type:"percentage",value:s.rate*100,precision:2},null,8,["value"])]),a("div",ce,[t(e,{type:"dollar",value:s.borrowed,precision:p,"show-symbol":!1},null,8,["value"])]),a("div",pe,[t(e,{type:"dollar",value:s.collateralAmountUsd,precision:p},null,8,["value"])]),a("div",me,[t(e,{type:"dollar",value:s.fees.pending,precision:p},null,8,["value"])]),a("div",_e,[t(e,{"show-zero":"",type:"dollar",value:s.fees.collected,precision:p},null,8,["value"])])]),"row-aggregation":u(()=>[o[2]||(o[2]=a("div",null,null,-1)),o[3]||(o[3]=a("div",null,null,-1)),o[4]||(o[4]=a("div",null,null,-1)),a("div",ve,k(l(c).reduce((s,n)=>s+n.loans,0)),1),o[5]||(o[5]=a("div",null,null,-1)),a("div",fe,[t(e,{type:"dollar",value:l(c).reduce((s,n)=>s+n.borrowed,0),precision:p,"show-symbol":!1},null,8,["value"])]),a("div",ye,[t(e,{type:"dollar",value:l(c).reduce((s,n)=>s+n.collateralAmountUsd,0),precision:p},null,8,["value"])]),a("div",ge,[t(e,{type:"dollar",value:l(c).reduce((s,n)=>s+n.fees.pending,0),precision:p},null,8,["value"])]),a("div",be,[t(e,{"show-zero":"",type:"dollar",value:l(c).reduce((s,n)=>s+n.fees.collected,0),precision:p},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),Ce=$(he,[["__scopeId","data-v-f583e6f5"]]),we={class:"dashboard"},ke=S({__name:"CrvUsd.page",setup(U){const{crumbs:i}=M(N());i.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const g=W(),d=async c=>{await g.push({name:"crvusdmarket",params:{tab:"",marketAddr:c.address}})};return(c,h)=>(T(),E("div",we,[t(l(Ce),{style:{"grid-area":"table"},onSelect:d}),t(l(ie),{style:{"grid-area":"chart"}})]))}}),We=$(ke,[["__scopeId","data-v-26d04f0d"]]);export{We as default};

import{_ as ae}from"./KPI-D93aqXd-.js";import{_ as ne}from"./AsyncValue-CiuJBQIu.js";import{_ as oe}from"./SelectChain-CwAbS4aL.js";import{a as le,b as re}from"./chains-CnWu8kTE.js";import{d as D,T as W,U as M,f as o,V as O,h as R,o as U,w as C,a as A,b as r,u as e,_ as q,e as z,r as ce,t as ue,a4 as ie,c as de}from"./index-CSl7mF5e.js";import{u as V,c as N,a as Q,_ as X,b as Y}from"./UseLightweightChart-DUPQG9vB.js";import{r as I,u as P}from"./Number-Clxxgc0l.js";import{c as K,_ as j}from"./ChartStylesApex-BX9E4dzz.js";import{u as G,_ as H}from"./UseLegend-DysMgXIn.js";import{c as J}from"./String-TwmdtJxb.js";import{a as F}from"./index-BrXWXWPw.js";import"./ChainIcon-Btg9PnGr.js";import"./timestamp-DkvXAN4c.js";import"./useQuery-BH3fKRjE.js";import"./Object-DOSYkgA0.js";const pe=["crvusd","lending","pools","router","dao"],me={style:{display:"flex"}},_e={ref:"chartRef",class:"chart"},ve=D({__name:"ChartTxs",props:{txs:{}},setup(f){const y=W(),c=M("card"),{chart:g,series:a}=V({createChartOptions:Q(),series:N({name:"txs",color:o(()=>y.value.colors.blue),formatter:s=>`${I(s,0,"dollar")}${P(s)}`,minMove:.01})});O(h);function h(){!g.value||!a.txs||(a.txs.setData(f.txs.map(s=>({time:s.timestamp,value:s.count})).uniqWith((s,d)=>s.time===d.time).orderBy(s=>s.time,"asc")),g.value.timeScale().fitContent())}return(s,d)=>{const b=X,_=Y,p=q;return U(),R(p,{ref_key:"card",ref:c,title:"Transactions"},{actions:C(()=>[A("div",me,[r(b,{filename:"txs",series:e(a)},null,8,["series"]),r(_,{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:C(()=>[A("div",_e,null,512)]),_:1},512)}}}),he={style:{display:"flex"}},fe={ref:"chartRef",class:"chart"},ye=D({__name:"ChartUsers",props:{users:{}},setup(f){const y=W(),c=M("card"),{chart:g,series:a}=V({createChartOptions:Q(),series:N({name:"users",color:o(()=>y.value.colors.blue),formatter:s=>`${I(s,0,"dollar")}${P(s)}`,minMove:.01})});O(h);function h(){!g.value||!a.users||(a.users.setData(f.users.map(s=>({time:s.timestamp,value:s.count})).uniqWith((s,d)=>s.time===d.time).orderBy(s=>s.time,"asc")),g.value.timeScale().fitContent())}return(s,d)=>{const b=X,_=Y,p=q;return U(),R(p,{ref_key:"card",ref:c,title:"Users"},{actions:C(()=>[A("div",he,[r(b,{filename:"users",series:e(a)},null,8,["series"]),r(_,{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:C(()=>[A("div",fe,null,512)]),_:1},512)}}}),ge=D({__name:"ChartRankingChains",props:{type:{},txs:{},users:{}},setup(f){const y=W(),c=o(()=>`Top Chains (${f.type==="all"?"All Types":J(f.type)})`),{items:g,toggles:a,disabled:h}=G(()=>{const{blue:t,yellow:n}=y.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:n,togglable:!0}]});function s(t){return t.groupBy(n=>n.chain).entries().map(([n,v])=>({chain:n,count:v.sumBy(u=>u.value)})).orderBy(n=>n.count,"desc")}const d=o(()=>{const{colors:t}=y.value;return K({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:p.value,labels:{formatter:$}},yaxis:{labels:{formatter:S}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),b=o(()=>a.txs.value?s(f.txs):[]),_=o(()=>a.users.value?s(f.users):[]),p=o(()=>b.value.concat(_.value).orderBy(t=>t.count,"desc").map(t=>t.chain).uniq()),k=o(()=>{const t=p.value.map(v=>{const u=b.value.find(x=>x.chain===v);return u?u.count:0}),n=p.value.map(v=>{const u=_.value.find(x=>x.chain===v);return u?u.count:0});return[{data:a.txs.value?t:[]},{data:a.users.value?n:[]}]}),$=t=>t,S=t=>`${I(t,0,"dollar")}${P(t)}`;return(t,n)=>{const v=H,u=j,x=q;return U(),R(x,{title:e(c)},{"actions-secondary":C(()=>[r(v,{items:e(g),disabled:e(h),onToggle:n[0]||(n[0]=w=>e(a)[w].value=!e(a)[w].value)},null,8,["items","disabled"])]),default:C(()=>[r(u,{options:e(d),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),be=z(ge,[["__scopeId","data-v-4b9f4bb5"]]),xe=D({__name:"ChartRankingTypes",props:{chain:{},txs:{},users:{}},setup(f){const y=W(),c=o(()=>`Top Types (${f.chain==="all"?"All Chains":J(f.chain)})`),{items:g,toggles:a,disabled:h}=G(()=>{const{blue:t,yellow:n}=y.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:n,togglable:!0}]});function s(t){return t.groupBy(n=>n.type).entries().map(([n,v])=>({type:n,count:v.sumBy(u=>u.value)})).orderBy(n=>n.count,"desc")}const d=o(()=>{const{colors:t}=y.value;return K({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:p.value,labels:{formatter:$}},yaxis:{labels:{formatter:S}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),b=o(()=>a.txs.value?s(f.txs):[]),_=o(()=>a.users.value?s(f.users):[]),p=o(()=>b.value.concat(_.value).orderBy(t=>t.count,"desc").map(t=>t.type).uniq()),k=o(()=>{const t=p.value.map(v=>{const u=b.value.find(x=>x.type===v);return u?u.count:0}),n=p.value.map(v=>{const u=_.value.find(x=>x.type===v);return u?u.count:0});return[{data:a.txs.value?t:[]},{data:a.users.value?n:[]}]}),$=t=>t,S=t=>`${I(t,0,"dollar")}${P(t)}`;return(t,n)=>{const v=H,u=j,x=q;return U(),R(x,{title:e(c)},{"actions-secondary":C(()=>[r(v,{items:e(g),disabled:e(h),onToggle:n[0]||(n[0]=w=>e(a)[w].value=!e(a)[w].value)},null,8,["items","disabled"])]),default:C(()=>[r(u,{options:e(d),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),Ce=z(xe,[["__scopeId","data-v-50e710ee"]]),Te={class:"option"},we={class:"label"},Be=D({__name:"ActivityTypeSelect",emits:["select"],setup(f,{emit:y}){const c=y,g=["all",...pe],a=ce("all");function h(d){switch(d){case"all":return"All Types";case"crvusd":return"crvUSD";case"lending":return"Lending";case"pools":return"Pools";case"router":return"Router";case"dao":return"DAO"}}function s(d){a.value=d,c("select",a.value)}return(d,b)=>{const _=ie;return U(),R(_,{options:g,selected:e(a),onSelect:s},{option:C(({option:p})=>[A("div",Te,[A("div",we,ue(h(p)),1)])]),_:1},8,["selected"])}}}),$e=z(Be,[["__scopeId","data-v-5448f8e1"]]),Se={class:"dashboard"},Ae={class:"toolbar"},ke=D({__name:"Chains.page",setup(f){const y=F("chain"),c=o({get(){return y.value?y.value:"all"},set(l){y.value=l}}),g=o(()=>{const l=b.value.map(m=>m.chain).concat(p.value.map(m=>m.chain)).concat(c.value!=="all"?[c.value]:[]).uniq().orderBy(m=>m,"asc"),T=["ethereum"],B=l.difference(T).orderBy(m=>m,"asc");return["all",...T,...B]}),a=F("type"),h=o({get(){return a.value?a.value:"all"},set(l){a.value=l}}),s=l=>{h.value=l},{isFetching:d,data:b}=le(),{isFetching:_,data:p}=re();function k(l,T,B,m){return l.filter(i=>T==="all"?!0:i.chain===T).filter(i=>B==="all"?!0:i.type===B).groupBy(i=>i.timestamp.getTime()).entries().map(([i,L])=>({timestamp:Number(i)/1e3,count:L.sumBy(m)}))}const $=o(()=>k(b.value,c.value,h.value,l=>l.transactions)),S=o(()=>k(p.value,c.value,h.value,l=>l.users));function t(l){const m=Math.floor(Date.now()/1e3)-7*24*60*60,L=l.filter(E=>E.timestamp>=m).sumBy(E=>E.count);return Math.round(L/7)}const n=o(()=>$.value.at(-1)?.count??0),v=o(()=>t($.value)),u=o(()=>S.value.at(-1)?.count??0),x=o(()=>t(S.value));function w(l,T,B,m){return l.filter(i=>T==="all"?!0:i.chain===T).filter(i=>B==="all"?!0:i.type===B).map(i=>({chain:i.chain,type:i.type,value:m(i)}))}const Z=o(()=>w(b.value,"all",h.value,l=>l.transactions)),ee=o(()=>w(p.value,"all",h.value,l=>l.users)),te=o(()=>w(b.value,c.value,"all",l=>l.transactions)),se=o(()=>w(p.value,c.value,"all",l=>l.users));return(l,T)=>{const B=oe,m=ne,i=ae;return U(),de("div",Se,[A("div",Ae,[r(e($e),{style:{"grid-area":"type"},onSelect:s}),r(B,{all:"",style:{"grid-area":"chain"},class:"chain-select",chain:e(c),chains:e(g),onSelectChain:T[0]||(T[0]=L=>c.value=L)},null,8,["chain","chains"])]),r(i,{style:{"grid-area":"kpi1"},label:"Transactions Today","has-value":!!e(d)},{default:C(()=>[r(m,{"show-zero":"",type:"dollar",value:e(n),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(i,{style:{"grid-area":"kpi2"},label:"Avg Transactions / 7 Days","has-value":!!e(d)},{default:C(()=>[r(m,{"show-zero":"",type:"dollar",value:e(v),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(i,{style:{"grid-area":"kpi3"},label:"Avg Users / 7 Days","has-value":!!e(_)},{default:C(()=>[r(m,{"show-zero":"",type:"dollar",value:e(u),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(i,{style:{"grid-area":"kpi4"},label:"Users Today","has-value":!!e(_)},{default:C(()=>[r(m,{"show-zero":"",type:"dollar",value:e(x),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(e(ve),{style:{"grid-area":"txs"},txs:e($),loading:e(d)},null,8,["txs","loading"]),r(e(ye),{style:{"grid-area":"users"},users:e(S),loading:e(_)},null,8,["users","loading"]),r(e(be),{style:{"grid-area":"top-chains"},type:e(h),txs:e(Z),users:e(ee),loading:e(d)||e(_)},null,8,["type","txs","users","loading"]),r(e(Ce),{style:{"grid-area":"top-types"},chain:e(c),txs:e(te),users:e(se),loading:e(d)||e(_)},null,8,["chain","txs","users","loading"])])}}}),Qe=z(ke,[["__scopeId","data-v-be83f723"]]);export{Qe as default};

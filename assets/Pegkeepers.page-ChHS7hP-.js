import{d as T,T as U,f as p,U as D,V as S,h as R,o as B,w as v,a as i,b as r,u as l,_ as z,r as x,t as K,O as I,aa as O,e as A,c as W}from"./index-CXYbPx9b.js";import{u as E,_ as Q}from"./UseLegend-Cz0R_GHj.js";import{u as M,G as N,r as G,a as j,_ as q,b as H}from"./UseLightweightChart-B8YGhKDU.js";import{f as F,g as J}from"./crvusd-DQMoWM1N.js";import{r as X,u as Y}from"./Number-Bxs3KMTV.js";import{_ as Z}from"./Table-CECkJBYj.js";import{_ as ee}from"./AsyncValue-BhLVS80y.js";import{_ as se}from"./TokenIcon-D2L2NGEr.js";import{_ as oe}from"./InputText-B8axf-qd.js";import{e as ae}from"./pools-BJGpFztC.js";import"./Object-DOSYkgA0.js";import"./timestamp-DkvXAN4c.js";import"./api-Bhu-jkhy.js";import"./useQuery-GHjouMSi.js";import"./fetch-bVCl_krR.js";import"./UseHost-weJ1M0IQ.js";const te={style:{display:"flex"}},le={ref:"chartRef",class:"chart"},ne=T({__name:"ChartKeeperPrices",setup(g){const m=U(),_=["USDC","USDT"],{items:b,toggles:u,disabled:w}=E(()=>_.map((o,a)=>({id:o,label:o,color:m.value.colorsArray[a],togglable:!0}))),h=p(()=>C.value||L.value),{isFetching:C,data:V}=F(),y=p(()=>V.value.filter(o=>o.pair.some(({symbol:a})=>_.map(s=>s.toLocaleLowerCase()).includes(a.toLocaleLowerCase())))),{isFetching:L,data:k}=J(y),c=D("card"),{chart:f,series:e}=M({createChartOptions:j(),series:_.map((o,a)=>({type:N,name:o,options:p(()=>({priceFormat:{type:"custom",formatter:s=>`${X(s,3,"dollar")}${Y(s)}`},lineWidth:2,lineType:G.WithSteps,color:m.value.colorsArray[a],lastValueVisible:!1,priceLineVisible:!1,autoscaleInfoProvider:s=>{const d=s();return d!==null&&d.priceRange&&(d.priceRange.minValue=Math.max(.98,d.priceRange.minValue),d.priceRange.maxValue=Math.min(1.02,d.priceRange.maxValue)),d}}))}))});S(n);function n(){if(!(!f.value||Object.values(e).length<0)){for(const[,o]of _.entries())e[o]?.applyOptions({visible:u[o].value}),e[o]?.setData(k.value.map(a=>({time:a.timestamp,value:a[o]})).uniqWith((a,s)=>a.time===s.time).orderBy(a=>a.time,"asc"));f.value.timeScale().fitContent()}}return(o,a)=>{const s=q,d=H,P=Q,t=z;return B(),R(t,{ref_key:"card",ref:c,title:"Pegkeepers Coin Prices",loading:l(h)},{actions:v(()=>[i("div",te,[r(s,{filename:"keeper_prices",series:l(e)},null,8,["series"]),r(d,{chart:l(f),target:l(c)},null,8,["chart","target"])])]),"actions-secondary":v(()=>[r(P,{items:l(b),disabled:l(w),onToggle:a[0]||(a[0]=$=>l(u)[$].value=!l(u)[$].value)},null,8,["items","disabled"])]),default:v(()=>[i("div",le,null,512)]),_:1},8,["loading"])}}});function re(g){return g!=null}const ie={class:"end"},ce={class:"end"},de={class:"end"},ue={class:"end"},pe={class:"end"},me={class:"end"},_e={class:"end"},ve={class:"end"},ge=T({__name:"TablePegkeepers",setup(g){const m=x(""),_=p(()=>L.value||w.value),b=p(()=>h.value.filter(e=>e.active).map(e=>{const n=k.value.find(o=>e.poolAddress===o.address);if(n)return{...n,...e,pool:n.address}}).filter(re).orderBy(e=>e.tvlUsd,"desc")),u=p(()=>b.value.filter(e=>{const n=m.value.toLocaleLowerCase().split(" "),o=a=>n.some(s=>a.toLocaleLowerCase().includes(s));return o(e.name)||o(e.address)})),{isFetching:w,data:h}=F(),C=e=>`${e.pair[1].symbol} / ${e.pair[0].symbol}`,V=p(()=>h.value.map(e=>e.poolAddress)),y=ae(x("ethereum"),V),L=p(()=>y.value.some(e=>e.isFetching)),k=p(()=>y.value.filter(e=>e.data).map(e=>e.data)),c=e=>e>=1e6?2:0,f=e=>e.pair.filter(n=>n.address.toLocaleLowerCase()!==O)[0].address;return(e,n)=>{const o=oe,a=se,s=ee,d=Z,P=z;return B(),R(P,{class:"pegkeepers-card",title:"Pegkeepers",loading:l(_)},{actions:v(()=>[r(o,{modelValue:l(m),"onUpdate:modelValue":n[0]||(n[0]=t=>I(m)?m.value=t:null),search:"",placeholder:"Search for.."},null,8,["modelValue"])]),default:v(()=>[r(d,{class:"pegkeepers-table",rows:l(u),columns:["","Name",{label:"Debt",align:"end"},{label:"TVL",align:"end"},{label:"Volume",align:"end"},{label:"Fees",align:"end"}]},{row:v(({item:t})=>[r(a,{chain:"ethereum",address:f(t)},null,8,["address"]),i("div",null,K(C(t)),1),i("div",ie,[r(s,{"show-zero":"",type:"dollar",value:t.totalDebt,precision:c},null,8,["value"])]),i("div",ce,[r(s,{"show-zero":"",type:"dollar",value:t.tvlUsd,precision:c},null,8,["value"])]),i("div",de,[r(s,{"show-zero":"",type:"dollar",value:t.tradingVolume24h,precision:c},null,8,["value"])]),i("div",ue,[r(s,{"show-zero":"",type:"dollar",value:t.totalProfit,precision:c},null,8,["value"])])]),"row-aggregation":v(()=>[n[1]||(n[1]=i("div",null,null,-1)),n[2]||(n[2]=i("div",null,null,-1)),i("div",pe,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(t=>t.totalDebt),precision:c},null,8,["value"])]),i("div",me,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(t=>+t.tvlUsd),precision:c},null,8,["value"])]),i("div",_e,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(t=>t.tradingVolume24h),precision:c},null,8,["value"])]),i("div",ve,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(t=>t.totalProfit),precision:c},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),fe=A(ge,[["__scopeId","data-v-a8f81914"]]),he={class:"dashboard"},ye=T({__name:"Pegkeepers.page",setup(g){return(m,_)=>(B(),W("div",he,[r(l(fe),{style:{"grid-area":"table"}}),r(l(ne),{style:{"grid-area":"chart"}})]))}}),De=A(ye,[["__scopeId","data-v-f4603245"]]);export{De as default};

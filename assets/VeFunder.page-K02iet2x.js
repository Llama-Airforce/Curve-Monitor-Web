import{aF as J,d as A,r as y,f as $,L as I,H as S,h as L,o as G,w as C,a as e,b as f,u,aG as O,O as x,S as T,au as B,j as V,_ as F,aH as M,v as Y,e as R,N as K,m as Q,c as X}from"./index-LXGoiU-K.js";import{_ as Z}from"./InputNumber-CV5Am4h-.js";import{_ as P}from"./InputText-Bw9eqQP4.js";import{n as ee}from"./Number-ymNWJv-c.js";import{e as N,b as te,i as ae,d as ne,j as se,h as oe}from"./getAction-UBtp9hbT.js";import{g as ie,a as k,w as D}from"./writeContract-DZyFyBj6.js";/* empty css                                                                    */async function le(m,i){const{abi:l,address:o,args:t,dataSuffix:a,functionName:c,...d}=i,r=d.account?J(d.account):m.account,b=N({abi:l,args:t,functionName:c});try{const{data:p}=await te(m,ae,"call")({batch:!1,data:`${b}${a?a.replace("0x",""):""}`,to:o,...d,account:r}),s=ne({abi:l,args:t,functionName:c,data:p||"0x"}),_=l.filter(n=>"name"in n&&n.name===i.functionName);return{result:s,request:{abi:_,address:o,args:t,dataSuffix:a,functionName:c,...d,account:r}}}catch(p){throw se(p,{abi:l,address:o,args:t,docsPath:"/docs/contract/simulateContract",functionName:c,sender:r?.address})}}async function ce(m,i){const{abi:l,chainId:o,connector:t,...a}=i;let c;i.account?c=i.account:c=(await ie(m,{chainId:o,connector:t})).account;const d=m.getClient({chainId:o}),r=oe(d,le,"simulateContract"),{result:b,request:p}=await r({...a,abi:l,account:c});return{chainId:d.chain.id,result:b,request:{...p,chainId:o}}}const ue=[{stateMutability:"nonpayable",type:"function",name:"deploy_gauge",inputs:[{name:"_receiver",type:"address"},{name:"_max_emissions",type:"uint256"}],outputs:[{name:"",type:"address"}]}],de={class:"add-new"},re={class:"form"},pe={class:"field"},_e={class:"value"},me={class:"field"},ge={class:"value"},fe=A({__name:"DeployGauge",emits:["gauge"],setup(m,{emit:i}){const l=i,o=y(!1),t=y(""),a=y(0),c=O,d=$(()=>I(t.value.toLocaleLowerCase())&&typeof a.value=="number"&&a.value>0),r=S();async function b(){const p=t.value.toLocaleLowerCase();typeof a.value=="string"&&(a.value=parseFloat(a.value));const s=ee(a.value,18n);return M(o,async()=>{const{result:_,request:n}=await ce(r,{abi:ue,address:Y,functionName:"deploy_gauge",args:[p,s]}),v=await k(r,n);await D(r,{hash:v}),l("gauge",_)})}return(p,s)=>{const _=P,n=Z,v=T,w=F;return G(),L(w,{title:"Gauge Creation"},{default:C(()=>[e("div",de,[e("div",re,[e("div",pe,[s[2]||(s[2]=e("div",{class:"label"},"Receiver:",-1)),e("div",_e,[f(_,{modelValue:u(t),"onUpdate:modelValue":s[0]||(s[0]=g=>x(t)?t.value=g:null),placeholder:u(c)},null,8,["modelValue","placeholder"])])]),e("div",me,[s[3]||(s[3]=e("div",{class:"label"},"CRV Amount (Max):",-1)),e("div",ge,[f(n,{modelValue:u(a),"onUpdate:modelValue":s[1]||(s[1]=g=>x(a)?a.value=g:null),min:1,max:3303030299},null,8,["modelValue"])])])]),f(v,{class:"action-button request primary",disabled:!u(d)||u(o),"chain-id":u(B).id,onClick:b},{default:C(()=>s[4]||(s[4]=[V(" Create Fundraising Gauge ",-1)])),_:1,__:[4]},8,["disabled","chain-id"])])]),_:1})}}}),ve=R(fe,[["__scopeId","data-v-074b4a76"]]),be=[{constant:!1,inputs:[{name:"_target",type:"address"},{name:"_ethValue",type:"uint256"},{name:"_data",type:"bytes"}],name:"execute",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],ye=[{constant:!1,inputs:[{name:"_executionScript",type:"bytes"},{name:"_metadata",type:"string"},{name:"_castVote",type:"bool"},{name:"_executesIfDecided",type:"bool"}],name:"newVote",outputs:[{name:"voteId",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"}],he=[{name:"add_gauge",outputs:[],inputs:[{type:"address",name:"addr"},{type:"int128",name:"gauge_type"},{type:"uint256",name:"weight"}],stateMutability:"nonpayable",type:"function"}],Ve={class:"add-new"},we={class:"form"},Ce={class:"field"},xe={class:"value"},$e={class:"field"},Ne={class:"value"},Ae=A({__name:"GaugeVote",props:{gauge:{default:""}},emits:["request"],setup(m,{emit:i}){const l=i,o=y(!1),t=y(""),a=y("Add a grant gauge: "),c=O,d=$(()=>I(t.value)&&!!a.value),r=$(()=>d.value&&!o.value);K(()=>m.gauge,_=>{t.value=_.toLocaleLowerCase()});async function b(){if(t.value)return M(o,async()=>{await s(),l("request")})}const p=S();async function s(){const _="0xe478de485ad2fe566d49342cbd03e49ed7db3356",n="0x40907540d8a6c65c637785e8f8b742ae6b0b9968",v=(W,z)=>W.padStart(z,"0"),w=N({abi:he,functionName:"add_gauge",args:[t.value,10n,0n]});let g="0x00000001";const h=N({abi:be,functionName:"execute",args:[Q,0n,w]}).substring(2),E=v((Math.floor(h.length)/2).toString(16),8);g=`${g}${n.substring(2)}${E}${h}`;const q=new FormData,H={text:a.value.replace(/(\r\n|\n|\r)/gm,"")};q.append("file",JSON.stringify(H));const U=(await(await fetch("https://ipfs.infura.io:5001/api/v0/add",{method:"POST",body:q})).json()).Hash,j=await k(p,{abi:ye,address:_,functionName:"newVote",args:[g,`ipfs:${U}`,!1,!1]});await D(p,{hash:j})}return(_,n)=>{const v=P,w=T,g=F;return G(),L(g,{title:"Gauge Addition Vote"},{default:C(()=>[e("div",Ve,[e("div",we,[e("div",Ce,[n[2]||(n[2]=e("div",{class:"label"},"Gauge Address:",-1)),e("div",xe,[f(v,{modelValue:u(t),"onUpdate:modelValue":n[0]||(n[0]=h=>x(t)?t.value=h:null),placeholder:u(c)},null,8,["modelValue","placeholder"])])]),e("div",$e,[n[3]||(n[3]=e("div",{class:"label"},"Vote Description:",-1)),e("div",Ne,[f(v,{modelValue:u(a),"onUpdate:modelValue":n[1]||(n[1]=h=>x(a)?a.value=h:null)},null,8,["modelValue"])])])]),f(w,{class:"action-button request primary",disabled:!u(r),"chain-id":u(B).id,onClick:b},{default:C(()=>n[4]||(n[4]=[V(" Create Gauge Addition Vote ",-1)])),_:1,__:[4]},8,["disabled","chain-id"])])]),_:1})}}}),Ge=R(Ae,[["__scopeId","data-v-4f654d4d"]]),Fe={class:"dashboard"},Re={class:"forms"},qe=A({__name:"VeFunder.page",setup(m){const i=y(""),l=o=>{i.value=o};return(o,t)=>{const a=F;return G(),X("div",Fe,[f(a,null,{default:C(()=>t[0]||(t[0]=[e("div",{class:"explanation"},[e("div",{class:"step-one"},[e("span",null,[e("strong",null,"veFunder"),V(" process:")]),e("ol",null,[e("li",null," Create a fundraising gauge contract that allows a receiver to get a certain amount of CRV. "),e("li",null,[V(" Request a vote to add the gauge to the controller."),e("br"),V("When passed, the newly created gauge can be voted on during gauge votes and can then receive gauge emissions. ")])])]),e("div",{class:"step-two"},[e("span",null,[e("strong",null,"Gauge vote requirements:")]),e("ol",null,[e("li",null,[V(" New gauge votes must have a vote on the governance forum "),e("a",{href:"https://gov.curve.finance/",target:"_blank"}," at this address ")]),e("li",null,"You must have a minimum of 2,500 veCRV to create this vote")])])],-1)])),_:1,__:[0]}),e("div",Re,[f(ve,{onGauge:l}),f(Ge,{gauge:u(i)},null,8,["gauge"])])])}}}),Ee=R(qe,[["__scopeId","data-v-f124b064"]]);export{Ee as default};

import{_ as H,a as M}from"./TabItem.vue_vue_type_script_setup_true_lang-Dc4_KzbI.js";import{d as T,g as N,T as E,U,f as C,V as K,h as f,o as t,_ as A,u as a,w as i,a as d,b as r,L as W,W as w,c as p,t as k,i as $,e as V,F,j,Q as L,l as q,r as z,O as J,a4 as X,a5 as Y,N as Z,R as x,a2 as I}from"./index-VA-IkcV_.js";import{b as ee,c as ae,d as se,e as te}from"./gauge-CWenlfcU.js";import{_ as B}from"./AsyncValue-DZj9Bxdz.js";import{_ as oe}from"./TokenIcon-oyUNg5F3.js";import{_ as ne}from"./KPI-DENPUeKz.js";import{u as re,b as le,c as ie,_ as ue,a as de}from"./UseLightweightChart-BS8D5Knx.js";import{r as ge}from"./Number-DdxvjkFu.js";import{_ as R,a as ce}from"./Table-DbqnzNGF.js";import{_ as pe}from"./InputText-BuhcI20P.js";import{u as _e,_ as me}from"./UsePagination-DEb_mPWO.js";import{u as he}from"./UseSort-b-a1OyKx.js";import{a as fe}from"./index-DrVc10qv.js";import{u as ve}from"./UseTabNavigation-BO-EhJC-.js";import"./timestamp-Dfir0V72.js";import"./useQuery-jfAWU074.js";import"./Object-DOSYkgA0.js";const ke={style:{display:"flex"}},be={ref:"chartRef",class:"chart"},ye=T({__name:"ChartWeightHistory",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=ee(N(()=>b.gaugeAddress)),c=E(),e=U("card"),{chart:s,series:g}=re({createChartOptions:ie(),series:{type:"Area",name:"weight",options:C(()=>({priceFormat:{type:"custom",formatter:_=>ge(_,1)},lineWidth:2,lineType:le.WithSteps,lineColor:c.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});K(l);function l(){if(!s.value||!g.weight)return;const _=n.value.map(m=>({time:m.epoch,value:Number(m.weight)/10**18})).uniqWith((m,v)=>m.time===v.time).orderBy(m=>m.time,"asc");_.length>0&&g.weight.setData(_),s.value.timeScale().fitContent()}return(_,m)=>{const v=A;return t(),f(v,{ref_key:"card",ref:e,title:"Weight",loading:a(h)},{actions:i(()=>[d("div",ke,[r(a(ue),{filename:"weight",series:a(g)},null,8,["series"]),r(a(de),{chart:a(s),target:a(e)},null,8,["chart","target"])])]),default:i(()=>[d("div",be,null,512)]),_:1},8,["loading"])}}}),$e=["href"],we=["href"],Te=["innerHTML"],Ce=T({__name:"TableDeployment",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=ae(N(()=>b.gaugeAddress)),c=C(()=>{var e;return(e=n.value)!=null&&e.calldataDecoded?n.value.calldataDecoded.replace(/(?:\r\n|\r|\n)/g,"<br>").replace("/├/g","├").replace("/─/g","─").replace(/0x[a-fA-F0-9]{40}/g,s=>/[A-F]/g.test(s)&&W(s)?`<a target='_blank' href='https://etherscan.io/address/${s}'>${s}</a>`:s):null});return(e,s)=>{const g=ce,l=R,_=A;return t(),f(_,{title:"Deployment",loading:a(h)},{default:i(()=>[a(n)?(t(),f(l,{key:0},{default:i(()=>[r(g,null,{default:i(()=>[s[2]||(s[2]=d("div",null,"Date",-1)),d("div",null,k(a(n).timestamp.toLocaleDateString()),1)]),_:1}),r(g,null,{default:i(()=>[s[3]||(s[3]=d("div",null,"From",-1)),d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${a(n).addressFrom}`,onClick:s[0]||(s[0]=$(()=>{},["stop"]))},k(a(n).addressFrom),9,$e)])]),_:1}),a(n).addressTo?(t(),f(g,{key:0},{default:i(()=>[s[4]||(s[4]=d("div",null,"To",-1)),d("div",null,[d("a",{class:"font-mono trim",target:"_blank",href:`https://etherscan.io/address/${a(n).addressTo}`,onClick:s[1]||(s[1]=$(()=>{},["stop"]))},k(a(n).addressTo),9,we)])]),_:1})):w("",!0)]),_:1})):w("",!0),a(c)?(t(),p("div",{key:1,class:"calldata font-mono",innerHTML:a(c)},null,8,Te)):w("",!0)]),_:1},8,["loading"])}}}),Ve=V(Ce,[["__scopeId","data-v-2856e0e1"]]),Ae={class:"dashboard-grid"},Se=["href"],De={key:1},Le=["href"],Ne={key:1},Pe={key:2},Fe=["href"],Ie={key:1},Ge={key:0,class:"tokens"},We={key:1},Be=["href"],Re=T({__name:"GaugeOverview",props:{gauge:{}},setup(b){const h=C(()=>{var e;return(e=b.gauge)==null?void 0:e.address});function n(e){return W(e,{strict:!1})?L(e):e.replace("Curve.fi","").replace("Gauge Deposit","").trim()}function c(e){switch(e){case"arbitrum":return"arbiscan.io";case"ethereum":return"etherscan.io";default:return"etherscan.io"}}return(e,s)=>{var v;const g=A,l=ne,_=oe,m=B;return t(),p(F,null,[(v=e.gauge)!=null&&v.killed?(t(),f(g,{key:0,class:"killed border-flash"},{default:i(()=>s[4]||(s[4]=[j(" This gauge has been killed! ")])),_:1})):w("",!0),d("div",Ae,[r(l,{style:{"grid-area":"title"},label:"Gauge","has-value":!!e.gauge},{default:i(()=>[e.gauge?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${e.gauge.address}`,onClick:s[0]||(s[0]=$(()=>{},["stop"]))},k(n(e.gauge.name??e.gauge.address)),9,Se)):(t(),p("span",De," ?"))]),_:1},8,["has-value"]),r(l,{style:{"grid-area":"underlying"},label:"Market / Pool","has-value":!!e.gauge},{default:i(()=>{var o,u;return[(o=e.gauge)!=null&&o.pool?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.pool.address}`,onClick:s[1]||(s[1]=$(()=>{},["stop"]))},k(n(e.gauge.pool.name)),9,Le)):(u=e.gauge)!=null&&u.market?(t(),p("span",Ne,k(n(e.gauge.market.name)),1)):(t(),p("span",Pe,"No underlying market or pool"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"lp-token"},label:"LP Token","has-value":!!e.gauge},{default:i(()=>{var o,u;return[(o=e.gauge)!=null&&o.lpToken&&((u=e.gauge)!=null&&u.pool)?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.lpToken}`,onClick:s[2]||(s[2]=$(()=>{},["stop"]))},k(("addressShort"in e?e.addressShort:a(L))(e.gauge.lpToken)),9,Fe)):(t(),p("span",Ie,"No LP token"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"tokens"},label:"Tokens","has-value":!!e.gauge},{default:i(()=>{var o;return[(o=e.gauge)!=null&&o.tokens&&e.gauge.tokens.length>0?(t(),p("div",Ge,[(t(!0),p(F,null,q(e.gauge.tokens,u=>(t(),f(_,{key:u.address,clickable:"",class:"token",address:u.address},null,8,["address"]))),128))])):(t(),p("span",We,"No tokens"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"weight"},label:"Weight","has-value":!!e.gauge},{default:i(()=>{var o;return[r(m,{value:Number(((o=e.gauge)==null?void 0:o.weight)??0)/10**18},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"emissions"},label:"Emissions","has-value":!!e.gauge},{default:i(()=>{var o;return[r(m,{value:((o=e.gauge)==null?void 0:o.emissions)??0},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"date"},label:"Creation Date","has-value":!!e.gauge},{default:i(()=>[e.gauge?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${e.gauge.creationTx}`,onClick:s[3]||(s[3]=$(()=>{},["stop"]))},k(e.gauge.creationDate.toLocaleDateString()),9,Be)):w("",!0)]),_:1},8,["has-value"]),r(Ve,{style:{"grid-area":"deployment"},"gauge-address":a(h)},null,8,["gauge-address"]),r(ye,{style:{"grid-area":"weight-chart"},"gauge-address":a(h)},null,8,["gauge-address"])])],64)}}}),Oe=V(Re,[["__scopeId","data-v-b5347363"]]),Qe={style:{display:"flex","flex-wrap":"wrap",gap:"1rem"}},He=["href"],Me={class:"end"},Ee={class:"end"},Ue={class:"end"},Ke=["href"],G=15,je=T({__name:"TableVotes",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=se(N(()=>b.gaugeAddress)),c=[{id:"voter",label:"Voter",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"block",label:"Block",sort:!0,align:"end"},{id:"time",label:"Timestamp",sort:!0,align:"end"}],{sorting:e,onSort:s}=he("time"),g=z(""),l=C(()=>n.value.filter(o=>{const u=g.value.toLocaleLowerCase().split(" ");return(S=>u.some(D=>S.toLocaleLowerCase().includes(D)))(o.user)}).orderBy(o=>{switch(e.value.column){case"time":return o.timestamp.getTime();case"weight":return o.weight;case"block":return o.blockNumber}},e.value.order)),{page:_,rowsPage:m,onPage:v}=_e(l,G);return(o,u)=>{const P=me,S=pe,D=B,O=R,Q=A;return t(),f(Q,{title:"Votes",loading:a(h)},{actions:i(()=>[d("div",Qe,[r(P,{"items-count":a(l).length,"items-per-page":G,page:a(_),onPage:a(v)},null,8,["items-count","page","onPage"]),r(S,{modelValue:a(g),"onUpdate:modelValue":u[0]||(u[0]=y=>J(g)?g.value=y:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])])]),default:i(()=>[r(O,{rows:a(m),columns:c,sorting:a(e),onSortColumn:a(s)},{row:i(({item:y})=>[d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.user}`,onClick:u[1]||(u[1]=$(()=>{},["stop"]))},k(("addressShort"in o?o.addressShort:a(L))(y.user)),9,He)]),d("div",Me,[r(D,{value:y.weight},null,8,["value"])]),d("div",Ee,k(y.blockNumber),1),d("div",Ue,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${y.tx}`,onClick:u[2]||(u[2]=$(()=>{},["stop"]))},k(y.timestamp.toLocaleDateString()),9,Ke)])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),qe=V(je,[["__scopeId","data-v-8779ea09"]]),ze={class:"dashboard-grid"},Je=T({__name:"Votes",props:{gauge:{}},setup(b){const h=C(()=>{var n;return(n=b.gauge)==null?void 0:n.address});return(n,c)=>(t(),p("div",ze,[r(qe,{style:{"grid-area":"votes"},"gauge-address":a(h)},null,8,["gauge-address"])]))}}),Xe=V(Je,[["__scopeId","data-v-73ae6153"]]),Ye={class:"dashboard"},Ze=T({__name:"Gauge.page",setup(b){const h=fe("gaugeAddr"),{isFetching:n,data:c}=te(h),{crumbs:e}=X(Y());Z(c,l=>{e.value=[{id:"gauges",label:"Gauges",pathName:"gauges"},{id:"gauge",label:`Gauge: ${(l==null?void 0:l.name)??(l==null?void 0:l.address)??"?"}`}]},{immediate:!0});const{tabActive:s,tabActiveIndex:g}=ve(["overview","votes"],"gauge",()=>({gaugeAddr:h.value}));return(l,_)=>{const m=x,v=H,o=M;return t(),p("div",Ye,[r(m,{loading:a(n)},null,8,["loading"]),!a(n)&&a(c)?(t(),f(o,{key:0,active:a(g),onTab:_[0]||(_[0]=u=>g.value=u.index)},{default:i(()=>[r(v,{header:"Overview"},{default:i(()=>[(t(),f(I,null,[a(s)==="overview"?(t(),f(Oe,{key:0,gauge:a(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1}),r(v,{header:"Votes"},{default:i(()=>[(t(),f(I,null,[a(s)==="votes"?(t(),f(Xe,{key:0,gauge:a(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1})]),_:1},8,["active"])):w("",!0)])}}}),ha=V(Ze,[["__scopeId","data-v-ffcdec4a"]]);export{ha as default};

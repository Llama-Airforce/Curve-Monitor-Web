import{t as U,g as T,f as S,a as se}from"./timestamp-CeU_tFUE.js";import{u as k}from"./useQuery-DlYtpHcB.js";import{f,a9 as N,d as q,T as P,U as oe,V as M,h as g,o as b,_ as $,w as p,a as c,b as h,u as v,r as Q,j as V,e as B,W as ne,t as w,Q as j,K as X,N as Y,i as K}from"./index-CVF9rKRH.js";import{u as R,c as D,a as A,_ as ie,b as le,x as re,G as ue,r as ce}from"./UseLightweightChart-BM3TfZvL.js";import{r as L,u as W}from"./Number-CgtTSdt4.js";import{_ as G}from"./ButtonToggle-X8OGMTGf.js";import{c as z,_ as E}from"./ChartStylesApex-BgwYzMQS.js";import{u as J,_ as Z}from"./UseLegend-B9plua_V.js";import{_ as I,a as de}from"./Table-D9nxCgCO.js";import{_ as x}from"./AsyncValue-BCIGDDyq.js";import{a as ee,_ as te}from"./UsePagination-BIBHnm4p.js";import{u as ae}from"./UseRelativeTime-PpXVzivn.js";import{_ as me}from"./TokenIcon-L_lPcRfd.js";const pe=e=>({provider:e.provider,deposit:e.deposit?{amount:e.deposit.amount,n1:e.deposit.n1,n2:e.deposit.n2}:null,withdrawal:e.withdrawal?{amountBorrowed:e.withdrawal.amount_borrowed,amountCollateral:e.withdrawal.amount_collateral}:null,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),_e=e=>({idSold:e.sold_id,idBought:e.bought_id,tokenSold:{symbol:e.token_sold.symbol,address:e.token_sold.address},tokenBought:{symbol:e.token_bought.symbol,address:e.token_bought.address},amountSold:e.amount_sold,amountBought:e.amount_bought,price:e.price,buyer:e.buyer,feeX:e.fee_x,feeY:e.fee_y,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),ve=e=>({time:U(e.time),open:e.open??null,close:e.close??null,high:e.high??null,low:e.low??null,basePrice:e.base_price??null,oraclePrice:e.oracle_price??null,volume:e.volume??null});async function he({endpoint:e,chain:n,llamma:o,page:s=1,perPage:l=10},r){const i=T(r),a=new URLSearchParams({page:s.toString(),per_page:l.toString()}),t=await S(`${i}/v1/${e}/llamma_events/${n}/${o}??${a.toString()}`);return{events:t.data.map(pe),count:t.count}}async function fe({endpoint:e,chain:n,llamma:o,page:s=1,perPage:l=10},r){const i=T(r),a=new URLSearchParams({page:s.toString(),per_page:l.toString()}),t=await S(`${i}/v1/${e}/llamma_trades/${n}/${o}?${a.toString()}`);return{trades:t.data.map(_e),count:t.count}}async function ge({endpoint:e,chain:n,llamma:o,interval:s=1,units:l="hour",start:r,end:i},a){const t=T(a),d=se({start:r,end:i}),u=new URLSearchParams({agg_number:s.toString(),agg_units:l,start:d.start.toString(),end:d.end.toString()});return(await S(`${t}/v1/${e}/llamma_ohlc/${n}/${o}?${u.toString()}`)).data.map(ve)}function Ut(e,n,o,s){return k({queryKey:["llamma-market-events",n,s],queryFn:({queryKey:[,l,r]})=>he({endpoint:e,chain:o.value,llamma:l,page:r}),placeholderData:N,enabled:f(()=>!!n.value&&!!o.value)})}function Bt(e,n,o,s){return k({queryKey:["llamma-market-trades",n,s],queryFn:({queryKey:[,l,r]})=>fe({endpoint:e,chain:o.value,llamma:l,page:r}),placeholderData:N,enabled:f(()=>!!n.value&&!!o.value)})}function Ot(e,n,o){return k({queryKey:["llamma-market-ohlc",n],queryFn:({queryKey:[,s]})=>ge({endpoint:e,chain:o.value,llamma:s}),enabled:f(()=>!!n.value&&!!o.value)})}const be={style:{display:"flex"}},ye={ref:"chartRef",class:"chart"},Pt=q({__name:"ChartCollateralRatio",props:{ratios:{}},setup(e){const n=P(),o=oe("card"),{chart:s,series:l}=R({createChartOptions:A(),series:D({name:"ratios",color:f(()=>n.value.colors.blue),formatter:i=>`${L(i,0,"percentage")}%`,minMove:.01})});M(r);function r(){if(!s.value||!l.ratios)return;const i=e.ratios.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.ratio*100})).uniqWith((a,t)=>a.time===t.time).orderBy(a=>a.time,"asc");i.length>0&&l.ratios.setData(i),s.value.timeScale().fitContent()}return(i,a)=>{const t=ie,d=le,u=$;return b(),g(u,{ref_key:"card",ref:o,title:"Collateral Ratio"},{actions:p(()=>[c("div",be,[h(t,{filename:"collateral_ratio",series:v(l)},null,8,["series"]),h(d,{chart:v(s),target:v(o)},null,8,["chart","target"])])]),default:p(()=>[c("div",ye,null,512)]),_:1},512)}}}),qe={class:"button-group"},Mt=q({__name:"ChartLiqs",props:{liqs:{}},setup(e){const n=Q("count"),o=s=>{n.value!==s&&(n.value=s)};return(s,l)=>{const r=G,i=$;return b(),g(i,{title:"Self & Hard Liquidations"},{actions:p(()=>[c("div",qe,[h(r,{"model-value":v(n)==="count",onClick:l[0]||(l[0]=a=>o("count"))},{default:p(()=>l[2]||(l[2]=[V(" Count ")])),_:1,__:[2]},8,["model-value"]),h(r,{"model-value":v(n)==="value",onClick:l[1]||(l[1]=a=>o("value"))},{default:p(()=>l[3]||(l[3]=[V(" Value ")])),_:1,__:[3]},8,["model-value"])])]),default:p(()=>[v(n)==="count"?(b(),g(v($e),{key:0,liqs:s.liqs},null,8,["liqs"])):(b(),g(v(Le),{key:1,liqs:s.liqs},null,8,["liqs"]))]),_:1})}}}),we=q({__name:"ChartLiqsCount",props:{liqs:{}},setup(e){const n=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:o.value,labels:{formatter:r,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:l.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),o=f(()=>e.liqs.orderBy(a=>a.timestamp.getTime(),"asc").groupBy(a=>a.timestamp.getTime()).entries().map(([a])=>new Date(parseInt(a,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((a,t)=>t%8===0?a:"")),s=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(a=>({x:a.timestamp.toLocaleDateString(),y:a.selfCount}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(a=>({x:a.timestamp.toLocaleDateString(),y:a.hardCount}))}]),l=f(()=>Math.max(...e.liqs.groupBy(a=>a.timestamp.getTime()).entries().map(([,a])=>a.sumBy(t=>t.selfCount+t.hardCount)))*1.1),r=a=>a,i=a=>`${L(a,1,"dollar")}${W(a)}`;return(a,t)=>{const d=E;return b(),g(d,{options:v(n),series:v(s)},null,8,["options","series"])}}}),$e=B(we,[["__scopeId","data-v-6ff28a9f"]]),Ce=q({__name:"ChartLiqsValue",props:{liqs:{}},setup(e){const n=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:o.value,labels:{formatter:r,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:l.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),o=f(()=>e.liqs.orderBy(a=>a.timestamp.getTime(),"asc").groupBy(a=>a.timestamp.getTime()).entries().map(([a])=>new Date(parseInt(a,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((a,t)=>t%8===0?a:"")),s=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(a=>({x:a.timestamp.toLocaleDateString(),y:a.selfValue}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(a=>({x:a.timestamp.toLocaleDateString(),y:a.hardValue}))}]),l=f(()=>Math.max(...e.liqs.groupBy(a=>a.timestamp.getTime()).entries().map(([,a])=>a.sumBy(t=>t.selfValue+t.hardValue)))*1.1),r=a=>a,i=a=>`${L(a,1,"dollar")}${W(a)}`;return(a,t)=>{const d=E;return b(),g(d,{options:v(n),series:v(s)},null,8,["options","series"])}}}),Le=B(Ce,[["__scopeId","data-v-9067c7d2"]]),Te={ref:"chartRef",class:"chart"},Rt=q({__name:"ChartLiqsMedianLoss",props:{losses:{}},setup(e){const n=P(),{chart:o,series:s}=R({createChartOptions:A(),series:D({name:"losses",color:f(()=>n.value.colors.blue),formatter:r=>`${L(r,0,"percentage")}%`,minMove:.01})});M(l);function l(){if(!o.value||!s.losses)return;const r=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.pctLossMedian})).uniqWith((i,a)=>i.time===a.time).orderBy(i=>i.time,"asc");r.length>0&&s.losses.setData(r),o.value.timeScale().fitContent()}return(r,i)=>{const a=$;return b(),g(a,{title:"Median Loss % Among Loans with Losses"},{default:p(()=>[c("div",Te,null,512)]),_:1})}}}),Se={ref:"chartRef",class:"chart"},At=q({__name:"ChartLiqsLosersProportion",props:{losses:{}},setup(e){const n=P(),{chart:o,series:s}=R({createChartOptions:A(),series:D({name:"losses",color:f(()=>n.value.colors.blue),formatter:r=>`${L(r,0,"percentage")}%`})});M(l);function l(){if(!o.value||!s.losses)return;const r=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.numTotalUsers>0?100*i.numUsersWithLosses/i.numTotalUsers:0})).uniqWith((i,a)=>i.time===a.time).orderBy(i=>i.time,"asc");r.length>0&&s.losses.setData(r),o.value.timeScale().fitContent()}return(r,i)=>{const a=$;return b(),g(a,{title:"Proportion of Loans with Losses"},{default:p(()=>[c("div",Se,null,512)]),_:1})}}}),Ht=q({__name:"ChartLiqsHealthDeciles",props:{deciles:{}},setup(e){const n=f(()=>z({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1}},xaxis:{categories:o.value,labels:{formatter:l,rotate:-60},tickPlacement:"on"},yaxis:{labels:{formatter:r}},plotOptions:{bar:{columnWidth:"50%"}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:i=>{const a=i.series[0][i.dataPointIndex],t=i.series[1][i.dataPointIndex],d=i.series[2][i.dataPointIndex];return[`<div><b>Collat. (USD)</b>: ${r(t)}</div>`,`<div><b>Debt</b>: ${r(a)}</div>`,`<div><b>Stablecoin</b>: ${r(d)}</div>`].join("")}}})),o=f(()=>e.deciles.map(i=>i.decile)),s=f(()=>[{name:"Debt",data:Object.values(e.deciles).map(i=>i.debt)},{name:"Collateral",data:Object.values(e.deciles).map(i=>i.collateralUsdValue)},{name:"Stablecoin",data:Object.values(e.deciles).map(i=>i.stablecoin)}]),l=i=>i,r=i=>`$${L(i,0,"dollar")}${W(i)}`;return(i,a)=>{const t=E,d=$;return b(),g(d,{title:"Debt & Assets per Health Deciles"},{default:p(()=>[h(t,{options:v(n),series:v(s)},null,8,["options","series"])]),_:1})}}}),ke={ref:"chartRef",class:"chart"},Vt=q({__name:"ChartLiqsSoftLiqRatio",props:{ratios:{},pricesOracle:{}},setup(e){const n=P(),{items:o}=J(()=>[{id:"percentage",label:"% of loans in soft liquidation",color:n.value.colorsArray[0]},{id:"collateral-price",label:"Collateral price ($)",color:n.value.colorsArray[1]}]),{chart:s,series:l}=R({createChartOptions:A({leftPriceScale:{visible:!0}}),series:[D({name:"price",color:f(()=>n.value.colors.yellow),formatter:i=>`$${L(i,2,"dollar")}${W(i)}`}),D({name:"ratio",color:f(()=>n.value.colors.blue),formatter:i=>`${L(i,0,"percentage")}%`})]});M(r);function r(){if(!s.value||!l.price||!l.ratio)return;const i=e.ratios.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.proportion})).uniqWith((t,d)=>t.time===d.time).orderBy(t=>t.time,"asc");l.ratio.setData(i);const a=i.length>0?i[0].time:0;l.price.setData(e.pricesOracle.filter(t=>t.timestamp.getUTCTimestamp()>=a).map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.priceOracle})).uniqWith((t,d)=>t.time===d.time).orderBy(t=>t.time,"asc")),s.value.timeScale().fitContent()}return(i,a)=>{const t=Z,d=$;return b(),g(d,{title:"Soft Liquidations Ratio"},{"actions-secondary":p(()=>[h(t,{items:v(o)},null,8,["items"])]),default:p(()=>[c("div",ke,null,512)]),_:1})}}}),De={ref:"chartRef",class:"chart"},Wt=q({__name:"ChartLiquidatorRevenue",props:{discounts:{},liqs:{}},setup(e){const n=P(),{items:o}=J(()=>[{id:"revenue",label:"Liquidator Revenue",color:n.value.colorsArray[0]},{id:"discount",label:"Discount",color:n.value.colorsArray[1]}]),{chart:s,series:l}=R({createChartOptions:A({leftPriceScale:{visible:!0}}),series:[D({name:"revenue",color:f(()=>n.value.colors.blue),formatter:"price",precision:0,minMove:1}),D({name:"discount",color:f(()=>n.value.colors.yellow),formatter:"percent",precision:6,minMove:1e-6})]});M(r);function r(){if(!s.value||!l.discount||!l.revenue)return;const i=e.liqs.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.debt})).uniqWith((t,d)=>t.time===d.time).orderBy(t=>t.time,"asc").reduce((t,d)=>{const u=t.length>0?t[t.length-1].value:0;return t.push({time:d.time,value:d.value+u}),t},[]);l.revenue.setData(i);const a=i.length>0?i[0].time:0;l.discount.setData(e.discounts.filter(t=>t.timestamp.getUTCTimestamp()>=a).map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.discount*100})).uniqWith((t,d)=>t.time===d.time).orderBy(t=>t.time,"asc")),s.value.timeScale().fitContent()}return(i,a)=>{const t=Z,d=$;return b(),g(d,{title:"Liquidator Revenue"},{"actions-secondary":p(()=>[h(t,{items:v(o)},null,8,["items"])]),default:p(()=>[c("div",De,null,512)]),_:1})}}}),Ue={class:"end"},Be={class:"end"},Oe={class:"end"},Pe={class:"end"},Me={class:"end"},Re={class:"collateral end"},Ae={class:"end"},He=q({__name:"TableLiqOverview",props:{overview:{}},setup(e){const n=f(()=>{if(!e.overview)return 0;const o=e.overview.liqableDebtUsd,s=e.overview.liqableCollatUsd+e.overview.liqableBorrowedUsd,l=o-s;return l<=0?0:l});return(o,s)=>{const l=de,r=x,i=I,a=$;return b(),g(a,{title:"General Health Metrics"},{default:p(()=>[h(i,{class:"liq-overview-table"},{default:p(()=>[h(l,null,{default:p(()=>{var t;return[s[0]||(s[0]=c("div",null,"Users in soft liquidation",-1)),c("div",Ue,w(((t=o.overview)==null?void 0:t.softLiqUsers)??0),1)]}),_:1,__:[0]}),h(l,null,{default:p(()=>{var t;return[s[1]||(s[1]=c("div",null,"Median health",-1)),c("div",Be,[h(r,{"show-zero":"",type:"percentage",value:((t=o.overview)==null?void 0:t.medianHealth)??0},null,8,["value"])])]}),_:1,__:[1]}),h(l,null,{default:p(()=>{var t;return[s[2]||(s[2]=c("div",null,"Collaterization ratio",-1)),c("div",Oe,[h(r,{"show-zero":"",type:"percentage",value:((t=o.overview)==null?void 0:t.collatRatio)??0},null,8,["value"])])]}),_:1,__:[2]}),h(l,null,{default:p(()=>{var t;return[s[3]||(s[3]=c("div",null,"Liquidatable positions",-1)),c("div",Pe,w(((t=o.overview)==null?void 0:t.liqablePositions)??0),1)]}),_:1,__:[3]}),h(l,null,{default:p(()=>{var t;return[s[4]||(s[4]=c("div",null,"Liquidatable positions' debt",-1)),c("div",Me,[h(r,{"show-zero":"",type:"dollar",value:((t=o.overview)==null?void 0:t.liqableDebtUsd)??0},null,8,["value"])])]}),_:1,__:[4]}),h(l,null,{default:p(()=>{var t,d;return[s[6]||(s[6]=c("div",null,"Liquidatable collateral (token / crvUSD)",-1)),c("div",Re,[h(r,{"show-zero":"",type:"dollar",value:((t=o.overview)==null?void 0:t.liqableCollatUsd)??0},null,8,["value"]),s[5]||(s[5]=V(" / ")),h(r,{"show-zero":"",type:"dollar",value:((d=o.overview)==null?void 0:d.liqableBorrowedUsd)??0},null,8,["value"])])]}),_:1,__:[6]}),v(n)>0?(b(),g(l,{key:0},{default:p(()=>[s[7]||(s[7]=c("div",null,"Bad debt",-1)),c("div",Ae,[h(r,{"show-zero":"",class:"red",type:"dollar",value:v(n)},null,8,["value"])])]),_:1,__:[7]})):ne("",!0)]),_:1})]),_:1})}}}),Ft=B(He,[["__scopeId","data-v-472ed839"]]),Ve={class:"address"},We=["href"],Fe={class:"end"},Ke={class:"end"},Ie=q({__name:"TableTopLiquidators",props:{liqs:{}},setup(e){const n=f(()=>e.liqs.groupBy(o=>o.liquidator).entries().map(([o,s])=>({liquidator:o,count:s.length,value:s.sumBy(l=>l.collateralReceivedUsd)})).orderBy(o=>o.value,"desc").take(5));return(o,s)=>{const l=x,r=I,i=$;return b(),g(i,{title:"Top Liquidators"},{default:p(()=>[h(r,{class:"liquidators-table",rows:v(n),columns:["Address",{label:"Count",align:"end"},{label:"Value",align:"end"}]},{row:p(({item:a})=>[c("div",Ve,[c("a",{target:"_blank",href:`https://etherscan.io/address/${a.liquidator}`},w(("addressShort"in o?o.addressShort:v(j))(a.liquidator,8)),9,We)]),c("div",Fe,[h(l,{"show-zero":"",value:a.count,precision:0},null,8,["value"])]),c("div",Ke,[h(l,{type:"dollar",value:a.value,precision:1},null,8,["value"])])]),_:1},8,["rows"])]),_:1})}}}),Kt=B(Ie,[["__scopeId","data-v-b07f488e"]]),Qe=e=>({timestamp:U(e.timestamp),proportion:e.proportion/100}),je=e=>({timestamp:U(e.dt),user:e.user,liquidator:e.liquidator,self:e.self,collateralReceived:e.collateral_received,collateralReceivedUsd:e.collateral_received_usd,stablecoinReceived:e.stablecoin_received,priceOracle:e.oracle_price,debt:e.debt,n1:e.n1,n2:e.n2,tx:e.tx,block:e.block}),ze=e=>({timestamp:U(e.timestamp),selfCount:e.self_count,hardCount:e.hard_count,selfValue:e.self_value,hardValue:e.hard_value,price:e.price}),Ee=e=>({softLiqUsers:e.soft_liquidation_users,liqablePositions:e.liquidatable_positions,liqableDebtUsd:e.liquidatable_pos_debt_usd,liqableCollatUsd:e.liquidatable_collateral_usd,liqableBorrowedUsd:e.liquidatable_borrowed_usd,medianHealth:e.median_health,avgHealth:e.average_health,collatRatio:e.collat_ratio}),Ne=e=>({timestamp:U(e.timestamp),pctLossAverage:e.avg_pct_loss,pctLossMedian:e.median_pct_loss,absoluteLossAverage:e.avg_abs_loss,absoluteLossMedian:e.median_abs_loss,numTotalUsers:e.total_users,numUsersWithLosses:e.users_with_losses,ratio:e.ratio}),Xe=e=>({decile:e.health_decile,collateralUsdValue:e.collateral,debt:e.debt,stablecoin:e.stablecoin});async function Ye(e,n,o,s){const l=T(s);return(await S(`${l}/v1/${e}/liquidations/${n}/${o}/soft_liquidation_ratio`)).data.map(Qe)}async function Ge(e,n,o,s){const l=T(s);return(await S(`${l}/v1/${e}/liquidations/${n}/${o}/history/detailed`)).data.map(je)}async function Je(e,n,o,s){const l=T(s);return(await S(`${l}/v1/${e}/liquidations/${n}/${o}/history/aggregated`)).data.map(ze)}async function Ze(e,n,o,s){const l=T(s),r=await S(`${l}/v1/${e}/liquidations/${n}/${o}/overview?fetch_on_chain=true`);return Ee(r)}async function xe(e,n,o,s){const l=T(s);return(await S(`${l}/v1/${e}/liquidations/${n}/${o}/losses/history`)).data.map(Ne)}async function et(e,n,o,s){const l=T(s);return(await S(`${l}/v1/${e}/liquidations/${n}/${o}/health/distribution`)).data.map(Xe)}function F(){return{initialData:[],initialDataUpdatedAt:0}}function H(e,n){return{enabled:f(()=>!!e.value&&(n?!!n.value:!0))}}function It(e,n,o){return k({queryKey:["liqs-soft-liqs",o],queryFn:({queryKey:[,s]})=>Ye(e.value,n.value,s),...H(o,n),...F()})}function Qt(e,n,o){return k({queryKey:["liqs-detailed",o],queryFn:({queryKey:[,s]})=>Ge(e.value,n.value,s),...H(o,n),...F()})}function jt(e,n,o){return k({queryKey:["liqs-aggregate",o],queryFn:({queryKey:[,s]})=>Je(e.value,n.value,s),...H(o,n),...F()})}function zt(e,n,o){return k({queryKey:["liqs-overview",o],queryFn:({queryKey:[,s]})=>Ze(e.value,n.value,s),...H(o,n)})}function Et(e,n,o){return k({queryKey:["liqs-losses",o],queryFn:({queryKey:[,s]})=>xe(e.value,n.value,s),...H(o,n),...F()})}function Nt(e,n,o){return k({queryKey:["liqs-health-deciles",o],queryFn:({queryKey:[,s]})=>et(e.value,n.value,s),...H(o,n),...F()})}const tt={class:"controls"},at={ref:"chartRef",class:"chart"},st=q({__name:"ChartOHLC",props:{ohlc:{}},setup(e){const n=P(),o=Q(!1),s=Q(!1);let l=1,r=0;const{chart:i,series:a}=R({createChartOptions:A({localization:{priceFormatter:u=>d(u)}}),series:[{type:re,name:"ohlc",options:f(()=>{const{colors:u}=n.value;return{priceFormat:{type:"price",precision:6,minMove:1e-6},upColor:u.green,borderUpColor:u.green,wickUpColor:u.green,downColor:u.red,borderDownColor:u.red,wickDownColor:u.red}})},{type:ue,name:"oracle",options:f(()=>({priceFormat:{type:"price",precision:6,minMove:1e-6},lineWidth:2,lineType:ce.WithSteps,color:n.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}]});M(t);function t(){if(!i.value||!a.ohlc||!a.oracle)return;const u=o.value?-1:1,_=e.ohlc.filter(m=>m.open!==null&&m.high!==null&&m.low!==null&&m.close!==null).map(m=>({time:m.time.getUTCTimestamp(),open:Math.pow(m.open,u),high:Math.pow(m.high,u),low:Math.pow(m.low,u),close:Math.pow(m.close,u)})).uniqWith((m,C)=>m.time===C.time).orderBy(m=>m.time,"asc");_.length>0&&(a.ohlc.setData(_),r=Math.min(..._.map(m=>m.low)),l=Math.max(..._.map(m=>m.high))),a.oracle.setData(e.ohlc.filter(m=>m.oraclePrice!==null).map(m=>({time:m.time.getUTCTimestamp(),value:Math.pow(m.oraclePrice,u)})).uniqWith((m,C)=>m.time===C.time).orderBy(m=>m.time,"asc")),a.oracle.applyOptions({visible:s.value}),i.value.timeScale().fitContent()}function d(u){const _=l-r,m=_>1?_-Math.floor(_):_,C=-Math.floor(Math.log10(m)+1)+2;return`${L(u,C,"dollar")}${W(u)}`}return(u,_)=>{const m=G,C=$;return b(),g(C,{title:"Price"},{actions:p(()=>[c("div",tt,[h(m,{"model-value":v(s),onClick:_[0]||(_[0]=y=>s.value=!v(s))},{default:p(()=>_[2]||(_[2]=[V(" Oracle Price ")])),_:1,__:[2]},8,["model-value"]),h(m,{"model-value":v(o),onClick:_[1]||(_[1]=y=>o.value=!v(o))},{default:p(()=>_[3]||(_[3]=[V(" Invert ")])),_:1,__:[3]},8,["model-value"])])]),default:p(()=>[c("div",at,null,512)]),_:1})}}}),Xt=B(st,[["__scopeId","data-v-effb3c30"]]),ot={class:"end"},nt=["href"],it={class:"end"},lt=["href"],rt=q({__name:"TableEvents",props:{events:{},count:{}},emits:["page"],setup(e,{emit:n}){const o=n,{page:s,onPage:l}=ee(),r=X(s,200);Y(r,u=>{o("page",u)});const{relativeTime:i}=ae(),a=u=>u<1?u.toFixed(4):u>1e3?u.toFixed(0):u.toFixed(2),t=u=>{var _,m;return a(((_=u.deposit)==null?void 0:_.amount)??((m=u.withdrawal)==null?void 0:m.amountCollateral)??0)},d=u=>u.deposit?"Deposit":u.withdrawal?"Withdrawal":"Unknown";return(u,_)=>{const m=te,C=I,y=$;return b(),g(y,{title:"Events"},{actions:p(()=>[h(m,{"items-count":u.count,"items-per-page":10,page:v(s),onPage:v(l)},null,8,["items-count","page","onPage"])]),default:p(()=>[h(C,{class:"events-table",rows:u.events,columns:["Type",{label:"Amount",align:"end"},"","Provider",{label:"Time",align:"end"}]},{row:p(({item:O})=>[c("div",null,w(d(O)),1),c("div",ot,w(t(O)),1),_[2]||(_[2]=c("div",null,null,-1)),c("div",null,[c("a",{target:"_blank",href:`https://etherscan.io/address/${O.provider}`,onClick:_[0]||(_[0]=K(()=>{},["stop"]))},w(("addressShort"in u?u.addressShort:v(j))(O.provider)),9,nt)]),c("div",it,[c("a",{target:"_blank",href:`https://etherscan.io/tx/${O.txHash}`,onClick:_[1]||(_[1]=K(()=>{},["stop"]))},w(v(i)(O.timestamp.getUTCTimestamp())),9,lt)])]),_:1},8,["rows"])]),_:1})}}}),Yt=B(rt,[["__scopeId","data-v-7ae8399c"]]),ut={class:"end"},ct=["href"],dt={class:"end"},mt=["href"],pt=["href"],_t={class:"end"},vt=["href"],ht=q({__name:"TableTrades",props:{trades:{},count:{},chain:{}},emits:["page"],setup(e,{emit:n}){const o=n,{page:s,onPage:l}=ee(),r=X(s,200);Y(r,t=>{o("page",t)});const{relativeTime:i}=ae(),a=t=>t<1?t.toFixed(4):t>1e3?t.toFixed(0):t.toFixed(2);return(t,d)=>{const u=te,_=me,m=I,C=$;return b(),g(C,{title:"Trades"},{actions:p(()=>[h(u,{"items-count":t.count,"items-per-page":10,page:v(s),onPage:v(l)},null,8,["items-count","page","onPage"])]),default:p(()=>[h(m,{class:"trades-table",rows:t.trades,columns:[{label:"Bought",align:"end"},"","",{label:"Sold",align:"end"},"","","Market Maker",{label:"Time",align:"end"}]},{row:p(({item:y})=>[c("div",ut,w(a(y.amountBought)),1),h(_,{chain:t.chain,address:y.tokenBought.address},null,8,["chain","address"]),c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.tokenBought.address}`},w(y.tokenBought.symbol),9,ct)]),c("div",dt,w(a(y.amountSold)),1),h(_,{chain:t.chain,address:y.tokenSold.address},null,8,["chain","address"]),c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.tokenSold.address}`},w(y.tokenSold.symbol),9,mt)]),c("div",null,[c("a",{target:"_blank",href:`https://etherscan.io/address/${y.buyer}`,onClick:d[0]||(d[0]=K(()=>{},["stop"]))},w(("addressShort"in t?t.addressShort:v(j))(y.buyer)),9,pt)]),c("div",_t,[c("a",{target:"_blank",href:`https://etherscan.io/tx/${y.txHash}`,onClick:d[1]||(d[1]=K(()=>{},["stop"]))},w(v(i)(y.timestamp.getUTCTimestamp())),9,vt)])]),_:1},8,["rows"])]),_:1})}}}),Gt=B(ht,[["__scopeId","data-v-6212d8d5"]]);export{Xt as C,Ft as T,Vt as _,zt as a,It as b,jt as c,Qt as d,Nt as e,Et as f,Rt as g,At as h,Ht as i,Pt as j,Mt as k,Kt as l,Wt as m,Bt as n,Ut as o,Gt as p,Yt as q,Ot as u};

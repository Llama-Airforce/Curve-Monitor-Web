import{q as g,O as m,u as p,f as d,ay as b,H as _,r as q,ah as v,aj as $,a9 as C}from"./index-D9HG0aMx.js";import{e as I,b as P,i as w,d as j,j as F}from"./getAction-Yab9b6nX.js";import{u as i}from"./useQuery-D63AZpyD.js";import{t as k,f as y,g as l,F as D}from"./timestamp-CoE2HNXc.js";/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=g("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=g("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);async function X(t,e){const{abi:r,address:a,args:o,functionName:s,...c}=e,n=I({abi:r,args:o,functionName:s});try{const{data:u}=await P(t,w,"call")({...c,data:n,to:a});return j({abi:r,args:o,functionName:s,data:u||"0x"})}catch(u){throw F(u,{abi:r,address:a,args:o,docsPath:"/docs/contract/readContract",functionName:s})}}function K(t){return t.state.chainId}function O(t,e){const{onChange:r}=e;return t.subscribe(a=>a.chainId,r)}function f(t,e){if(e){const r=e(t);if(r===void 0&&m(t)||r!==void 0)return r}if(Array.isArray(t))return t.map(r=>f(r,e));if(typeof t=="object"&&N(t)){const r=Object.entries(t).map(([a,o])=>[a,f(o,e)]);return Object.fromEntries(r)}return t}function B(t){return f(t,e=>{if(m(e))return B(p(e))})}function N(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function G(t){const e=d(()=>({...p(t),queryKeyHashFn:b})),r=i(e);return r.queryKey=p(e).queryKey,r}function T(t={}){const e=_(t),r=q(K(e)),a=O(e,{onChange(o){r.value=o}});return v(()=>a()),$(r)}const h=t=>{var e;return{timestamp:k(t.dt),id:t.vote_id,type:t.vote_type.toLocaleLowerCase()==="parameter"?"parameter":"ownership",metadata:(e=t.metadata)!=null&&e.startsWith('"')?t.metadata.substring(1):t.metadata??"",proposer:t.creator,block:t.snapshot_block,start:t.start_date,end:t.start_date+604800,quorum:Number(BigInt(t.min_accept_quorum))/10**18,support:Number(BigInt(t.support_required))/10**18,voteCount:t.vote_count,votesFor:Number(BigInt(t.votes_for))/10**18,votesAgainst:Number(BigInt(t.votes_against))/10**18,executed:t.executed,totalSupply:Number(BigInt(t.total_supply))/10**18,txCreation:t.transaction_hash}},A=t=>({...h(t),txExecution:t.execution_tx?t.execution_tx:void 0,script:t.script,votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,votingPower:Number(BigInt(e.voting_power))/10**18,txHash:e.transaction_hash}))}),H=t=>({proposal:h(t.proposal),votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,weight:BigInt(Math.round(parseFloat(e.voting_power))),txHash:e.transaction_hash}))});async function E(t,e=10,r,a,o,s){const c=l(s),n=await y(`${c}/v1/dao/proposals?pagination=${e}&page=${t}&search_string=${r}&type_filter=${a}&status_filter=${o}`);return{proposals:n.proposals.map(h),count:n.count}}async function Q(t,e,r,a){const o=l(a),s=await y(`${o}/v1/dao/proposals/details/${e}/${t}`);return A(s)}async function U(t,e=1,r=100,a){try{const o=l(a);return(await y(`${o}/v1/dao/proposals/votes/user/${t}?pagination=${r}&page=${e}`)).data.map(H)}catch(o){if(o instanceof D)return[];throw o}}function L(){return{initialData:[],initialDataUpdatedAt:0}}function Y(t,e,r){return i({queryKey:["proposal",t,e],queryFn:({queryKey:[,a,o]})=>Q(a,o),...r&&{enabled:r}})}function Z(t,e,r,a){return i({queryKey:["proposals",t,a,e,r],queryFn:({queryKey:[,o,s,c,n]})=>E(o,void 0,s,c,n),placeholderData:C})}function z(t){return i({queryKey:["proposal-user-votes",d(()=>t.value)],queryFn:({queryKey:[,e]})=>U(e),enabled:d(()=>!!t.value),...L()})}export{J as C,W as X,G as a,z as b,Z as c,B as d,Y as e,X as r,T as u};

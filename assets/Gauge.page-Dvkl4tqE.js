import{_ as E,a as H}from"./TabItem.vue_vue_type_script_setup_true_lang-BTIO3Ac2.js";import{d as T,g as N,T as M,U,f as C,V as K,h as f,o,_ as A,u as s,w as u,a as d,b as r,L as I,W as w,c as p,t as k,i as $,e as V,F as P,j,Q as D,l as q,r as z,O as J,a4 as X,a5 as Y,N as Z,R as x,a2 as W}from"./index-CB0lbOkp.js";import{b as ee,c as ae,d as se,e as te}from"./gauge-9PV8Kv1n.js";import{_ as G}from"./AsyncValue-C0jBgRNU.js";import{_ as oe}from"./TokenIcon-Cqe8ofer.js";import{_ as ne}from"./KPI-B53x3jTq.js";import{u as re,b as le,c as ie,_ as ue,a as de}from"./UseLightweightChart-D45Z5owe.js";import{r as ge}from"./Number-BucUTk9j.js";import{_ as R,a as ce}from"./Table-NQndpLny.js";import{_ as pe}from"./InputText-CXpNFmeS.js";import{u as _e,_ as me}from"./UsePagination-BGn7VvEt.js";import{u as he}from"./UseSort-Dqih-eKL.js";import{a as fe}from"./index-Cu8Dsk6r.js";import{u as ve}from"./UseTabNavigation-CDHT1-ln.js";import"./timestamp-Dfir0V72.js";import"./useQuery-B6SWxrK9.js";import"./Object-DOSYkgA0.js";const ke={style:{display:"flex"}},be={ref:"chartRef",class:"chart"},ye=T({__name:"ChartWeightHistory",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=ee(N(()=>b.gaugeAddress)),c=M(),e=U("card"),{chart:a,series:g}=re({createChartOptions:ie(),series:{type:"Area",name:"weight",options:C(()=>({priceFormat:{type:"custom",formatter:_=>ge(_,1)},lineWidth:2,lineType:le.WithSteps,lineColor:c.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});K(l);function l(){if(!a.value||!g.weight)return;const _=n.value.map(m=>({time:m.epoch,value:Number(m.weight)/10**18})).uniqWith((m,v)=>m.time===v.time).orderBy(m=>m.time,"asc");_.length>0&&g.weight.setData(_),a.value.timeScale().fitContent()}return(_,m)=>{const v=ue,t=de,i=A;return o(),f(i,{ref_key:"card",ref:e,title:"Weight",loading:s(h)},{actions:u(()=>[d("div",ke,[r(v,{filename:"weight",series:s(g)},null,8,["series"]),r(t,{chart:s(a),target:s(e)},null,8,["chart","target"])])]),default:u(()=>[d("div",be,null,512)]),_:1},8,["loading"])}}}),$e=["href"],we=["href"],Te=["innerHTML"],Ce=T({__name:"TableDeployment",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=ae(N(()=>b.gaugeAddress)),c=C(()=>{var e;return(e=n.value)!=null&&e.calldataDecoded?n.value.calldataDecoded.replace(/(?:\r\n|\r|\n)/g,"<br>").replace("/├/g","├").replace("/─/g","─").replace(/0x[a-fA-F0-9]{40}/g,a=>/[A-F]/g.test(a)&&I(a)?`<a target='_blank' href='https://etherscan.io/address/${a}'>${a}</a>`:a):null});return(e,a)=>{const g=ce,l=R,_=A;return o(),f(_,{title:"Deployment",loading:s(h)},{default:u(()=>[s(n)?(o(),f(l,{key:0},{default:u(()=>[r(g,null,{default:u(()=>[a[2]||(a[2]=d("div",null,"Date",-1)),d("div",null,k(s(n).timestamp.toLocaleDateString()),1)]),_:1}),r(g,null,{default:u(()=>[a[3]||(a[3]=d("div",null,"From",-1)),d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${s(n).addressFrom}`,onClick:a[0]||(a[0]=$(()=>{},["stop"]))},k(s(n).addressFrom),9,$e)])]),_:1}),s(n).addressTo?(o(),f(g,{key:0},{default:u(()=>[a[4]||(a[4]=d("div",null,"To",-1)),d("div",null,[d("a",{class:"font-mono trim",target:"_blank",href:`https://etherscan.io/address/${s(n).addressTo}`,onClick:a[1]||(a[1]=$(()=>{},["stop"]))},k(s(n).addressTo),9,we)])]),_:1})):w("",!0)]),_:1})):w("",!0),s(c)?(o(),p("div",{key:1,class:"calldata font-mono",innerHTML:s(c)},null,8,Te)):w("",!0)]),_:1},8,["loading"])}}}),Ve=V(Ce,[["__scopeId","data-v-2856e0e1"]]),Ae={class:"dashboard-grid"},Se=["href"],Le={key:1},De=["href"],Ne={key:1},Fe={key:2},Pe=["href"],We={key:1},Be={key:0,class:"tokens"},Ie={key:1},Ge=["href"],Re=T({__name:"GaugeOverview",props:{gauge:{}},setup(b){const h=C(()=>{var e;return(e=b.gauge)==null?void 0:e.address});function n(e){return I(e,{strict:!1})?D(e):e.replace("Curve.fi","").replace("Gauge Deposit","").trim()}function c(e){switch(e){case"arbitrum":return"arbiscan.io";case"ethereum":return"etherscan.io";default:return"etherscan.io"}}return(e,a)=>{var v;const g=A,l=ne,_=oe,m=G;return o(),p(P,null,[(v=e.gauge)!=null&&v.killed?(o(),f(g,{key:0,class:"killed border-flash"},{default:u(()=>a[4]||(a[4]=[j(" This gauge has been killed! ")])),_:1})):w("",!0),d("div",Ae,[r(l,{style:{"grid-area":"title"},label:"Gauge","has-value":!!e.gauge},{default:u(()=>[e.gauge?(o(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${e.gauge.address}`,onClick:a[0]||(a[0]=$(()=>{},["stop"]))},k(n(e.gauge.name??e.gauge.address)),9,Se)):(o(),p("span",Le," ?"))]),_:1},8,["has-value"]),r(l,{style:{"grid-area":"underlying"},label:"Market / Pool","has-value":!!e.gauge},{default:u(()=>{var t,i;return[(t=e.gauge)!=null&&t.pool?(o(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.pool.address}`,onClick:a[1]||(a[1]=$(()=>{},["stop"]))},k(n(e.gauge.pool.name)),9,De)):(i=e.gauge)!=null&&i.market?(o(),p("span",Ne,k(n(e.gauge.market.name)),1)):(o(),p("span",Fe,"No underlying market or pool"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"lp-token"},label:"LP Token","has-value":!!e.gauge},{default:u(()=>{var t,i;return[(t=e.gauge)!=null&&t.lpToken&&((i=e.gauge)!=null&&i.pool)?(o(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.lpToken}`,onClick:a[2]||(a[2]=$(()=>{},["stop"]))},k(("addressShort"in e?e.addressShort:s(D))(e.gauge.lpToken)),9,Pe)):(o(),p("span",We,"No LP token"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"tokens"},label:"Tokens","has-value":!!e.gauge},{default:u(()=>{var t;return[(t=e.gauge)!=null&&t.tokens&&e.gauge.tokens.length>0?(o(),p("div",Be,[(o(!0),p(P,null,q(e.gauge.tokens,i=>(o(),f(_,{key:i.address,clickable:"",class:"token",address:i.address},null,8,["address"]))),128))])):(o(),p("span",Ie,"No tokens"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"weight"},label:"Weight","has-value":!!e.gauge},{default:u(()=>{var t;return[r(m,{value:Number(((t=e.gauge)==null?void 0:t.weight)??0)/10**18},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"emissions"},label:"Emissions","has-value":!!e.gauge},{default:u(()=>{var t;return[r(m,{value:((t=e.gauge)==null?void 0:t.emissions)??0},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"date"},label:"Creation Date","has-value":!!e.gauge},{default:u(()=>[e.gauge?(o(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${e.gauge.creationTx}`,onClick:a[3]||(a[3]=$(()=>{},["stop"]))},k(e.gauge.creationDate.toLocaleDateString()),9,Ge)):w("",!0)]),_:1},8,["has-value"]),r(Ve,{style:{"grid-area":"deployment"},"gauge-address":s(h)},null,8,["gauge-address"]),r(ye,{style:{"grid-area":"weight-chart"},"gauge-address":s(h)},null,8,["gauge-address"])])],64)}}}),Oe=V(Re,[["__scopeId","data-v-b5347363"]]),Qe={style:{display:"flex","flex-wrap":"wrap",gap:"1rem"}},Ee=["href"],He={class:"end"},Me={class:"end"},Ue={class:"end"},Ke=["href"],B=15,je=T({__name:"TableVotes",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=se(N(()=>b.gaugeAddress)),c=[{id:"voter",label:"Voter",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"block",label:"Block",sort:!0,align:"end"},{id:"time",label:"Timestamp",sort:!0,align:"end"}],{sorting:e,onSort:a}=he("time"),g=z(""),l=C(()=>n.value.filter(t=>{const i=g.value.toLocaleLowerCase().split(" ");return(S=>i.some(L=>S.toLocaleLowerCase().includes(L)))(t.user)}).orderBy(t=>{switch(e.value.column){case"time":return t.timestamp.getTime();case"weight":return t.weight;case"block":return t.blockNumber}},e.value.order)),{page:_,rowsPage:m,onPage:v}=_e(l,B);return(t,i)=>{const F=me,S=pe,L=G,O=R,Q=A;return o(),f(Q,{title:"Votes",loading:s(h)},{actions:u(()=>[d("div",Qe,[r(F,{"items-count":s(l).length,"items-per-page":B,page:s(_),onPage:s(v)},null,8,["items-count","page","onPage"]),r(S,{modelValue:s(g),"onUpdate:modelValue":i[0]||(i[0]=y=>J(g)?g.value=y:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])])]),default:u(()=>[r(O,{rows:s(m),columns:c,sorting:s(e),onSortColumn:s(a)},{row:u(({item:y})=>[d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.user}`,onClick:i[1]||(i[1]=$(()=>{},["stop"]))},k(("addressShort"in t?t.addressShort:s(D))(y.user)),9,Ee)]),d("div",He,[r(L,{value:y.weight},null,8,["value"])]),d("div",Me,k(y.blockNumber),1),d("div",Ue,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${y.tx}`,onClick:i[2]||(i[2]=$(()=>{},["stop"]))},k(y.timestamp.toLocaleDateString()),9,Ke)])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),qe=V(je,[["__scopeId","data-v-8779ea09"]]),ze={class:"dashboard-grid"},Je=T({__name:"Votes",props:{gauge:{}},setup(b){const h=C(()=>{var n;return(n=b.gauge)==null?void 0:n.address});return(n,c)=>(o(),p("div",ze,[r(qe,{style:{"grid-area":"votes"},"gauge-address":s(h)},null,8,["gauge-address"])]))}}),Xe=V(Je,[["__scopeId","data-v-73ae6153"]]),Ye={class:"dashboard"},Ze=T({__name:"Gauge.page",setup(b){const h=fe("gaugeAddr"),{isFetching:n,data:c}=te(h),{crumbs:e}=X(Y());Z(c,l=>{e.value=[{id:"gauges",label:"Gauges",pathName:"gauges"},{id:"gauge",label:`Gauge: ${(l==null?void 0:l.name)??(l==null?void 0:l.address)??"?"}`}]},{immediate:!0});const{tabActive:a,tabActiveIndex:g}=ve(["overview","votes"],"gauge",()=>({gaugeAddr:h.value}));return(l,_)=>{const m=x,v=E,t=H;return o(),p("div",Ye,[r(m,{loading:s(n)},null,8,["loading"]),!s(n)&&s(c)?(o(),f(t,{key:0,active:s(g),onTab:_[0]||(_[0]=i=>g.value=i.index)},{default:u(()=>[r(v,{header:"Overview"},{default:u(()=>[(o(),f(W,null,[s(a)==="overview"?(o(),f(Oe,{key:0,gauge:s(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1}),r(v,{header:"Votes"},{default:u(()=>[(o(),f(W,null,[s(a)==="votes"?(o(),f(Xe,{key:0,gauge:s(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1})]),_:1},8,["active"])):w("",!0)])}}}),ha=V(Ze,[["__scopeId","data-v-ffcdec4a"]]);export{ha as default};

import{aD as J,d as A,r as y,f as $,L as I,H as S,h as L,o as G,w as C,a as e,b as f,u as d,aE as O,O as x,S as T,ar as B,j as V,_ as F,aF as D,v as Y,e as R,N as K,m as Q,c as X}from"./index-CEOjmKtR.js";import{_ as Z}from"./InputNumber-BlKSk2dm.js";import{_ as M}from"./InputText-D-E_vOcO.js";import{n as ee}from"./Number-nBy8KE7n.js";import{e as N,b as te,i as ae,d as ne,j as se,h as oe}from"./getAction-BuKlpBy1.js";import{g as ie,a as P,w as k}from"./writeContract-C94YzeG9.js";/* empty css                                                                    */async function le(_,i){const{abi:c,address:o,args:t,dataSuffix:a,functionName:u,...r}=i,l=r.account?J(r.account):_.account,b=N({abi:c,args:t,functionName:u});try{const{data:p}=await te(_,ae,"call")({batch:!1,data:`${b}${a?a.replace("0x",""):""}`,to:o,...r,account:l}),s=ne({abi:c,args:t,functionName:u,data:p||"0x"}),m=c.filter(n=>"name"in n&&n.name===i.functionName);return{result:s,request:{abi:m,address:o,args:t,dataSuffix:a,functionName:u,...r,account:l}}}catch(p){throw se(p,{abi:c,address:o,args:t,docsPath:"/docs/contract/simulateContract",functionName:u,sender:l==null?void 0:l.address})}}async function ce(_,i){const{abi:c,chainId:o,connector:t,...a}=i;let u;i.account?u=i.account:u=(await ie(_,{chainId:o,connector:t})).account;const r=_.getClient({chainId:o}),l=oe(r,le,"simulateContract"),{result:b,request:p}=await l({...a,abi:c,account:u});return{chainId:r.chain.id,result:b,request:{...p,chainId:o}}}const ue=[{stateMutability:"nonpayable",type:"function",name:"deploy_gauge",inputs:[{name:"_receiver",type:"address"},{name:"_max_emissions",type:"uint256"}],outputs:[{name:"",type:"address"}]}],de={class:"add-new"},re={class:"form"},pe={class:"field"},me={class:"value"},_e={class:"field"},ge={class:"value"},fe=A({__name:"DeployGauge",emits:["gauge"],setup(_,{emit:i}){const c=i,o=y(!1),t=y(""),a=y(0),u=O,r=$(()=>I(t.value.toLocaleLowerCase())&&typeof a.value=="number"&&a.value>0),l=S();async function b(){const p=t.value.toLocaleLowerCase();typeof a.value=="string"&&(a.value=parseFloat(a.value));const s=ee(a.value,18n);return D(o,async()=>{const{result:m,request:n}=await ce(l,{abi:ue,address:Y,functionName:"deploy_gauge",args:[p,s]}),v=await P(l,n);await k(l,{hash:v}),c("gauge",m)})}return(p,s)=>{const m=M,n=Z,v=T,w=F;return G(),L(w,{title:"Gauge Creation"},{default:C(()=>[e("div",de,[e("div",re,[e("div",pe,[s[2]||(s[2]=e("div",{class:"label"},"Receiver:",-1)),e("div",me,[f(m,{modelValue:d(t),"onUpdate:modelValue":s[0]||(s[0]=g=>x(t)?t.value=g:null),placeholder:d(u)},null,8,["modelValue","placeholder"])])]),e("div",_e,[s[3]||(s[3]=e("div",{class:"label"},"CRV Amount (Max):",-1)),e("div",ge,[f(n,{modelValue:d(a),"onUpdate:modelValue":s[1]||(s[1]=g=>x(a)?a.value=g:null),min:1,max:3303030299},null,8,["modelValue"])])])]),f(v,{class:"action-button request primary",disabled:!d(r)||d(o),"chain-id":d(B).id,onClick:b},{default:C(()=>s[4]||(s[4]=[V(" Create Fundraising Gauge ")])),_:1},8,["disabled","chain-id"])])]),_:1})}}}),ve=R(fe,[["__scopeId","data-v-074b4a76"]]),be=[{constant:!1,inputs:[{name:"_target",type:"address"},{name:"_ethValue",type:"uint256"},{name:"_data",type:"bytes"}],name:"execute",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],ye=[{constant:!1,inputs:[{name:"_executionScript",type:"bytes"},{name:"_metadata",type:"string"},{name:"_castVote",type:"bool"},{name:"_executesIfDecided",type:"bool"}],name:"newVote",outputs:[{name:"voteId",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"}],he=[{name:"add_gauge",outputs:[],inputs:[{type:"address",name:"addr"},{type:"int128",name:"gauge_type"},{type:"uint256",name:"weight"}],stateMutability:"nonpayable",type:"function"}],Ve={class:"add-new"},we={class:"form"},Ce={class:"field"},xe={class:"value"},$e={class:"field"},Ne={class:"value"},Ae=A({__name:"GaugeVote",props:{gauge:{default:""}},emits:["request"],setup(_,{emit:i}){const c=i,o=y(!1),t=y(""),a=y("Add a grant gauge: "),u=O,r=$(()=>I(t.value)&&!!a.value),l=$(()=>r.value&&!o.value);K(()=>_.gauge,m=>{t.value=m.toLocaleLowerCase()});async function b(){if(t.value)return D(o,async()=>{await s(),c("request")})}const p=S();async function s(){const m="0xe478de485ad2fe566d49342cbd03e49ed7db3356",n="0x40907540d8a6c65c637785e8f8b742ae6b0b9968",v=(W,z)=>String(W).padStart(z,"0"),w=N({abi:he,functionName:"add_gauge",args:[t.value,10n,0n]});let g="0x00000001";const h=N({abi:be,functionName:"execute",args:[Q,0n,w]}).substring(2),E=v((Math.floor(h.length)/2).toString(16),8);g=`${g}${n.substring(2)}${E}${h}`;const q=new FormData,H={text:a.value.replace(/(\r\n|\n|\r)/gm,"")};q.append("file",JSON.stringify(H));const U=(await(await fetch("https://ipfs.infura.io:5001/api/v0/add",{method:"POST",body:q})).json()).Hash,j=await P(p,{abi:ye,address:m,functionName:"newVote",args:[g,`ipfs:${U}`,!1,!1]});await k(p,{hash:j})}return(m,n)=>{const v=M,w=T,g=F;return G(),L(g,{title:"Gauge Addition Vote"},{default:C(()=>[e("div",Ve,[e("div",we,[e("div",Ce,[n[2]||(n[2]=e("div",{class:"label"},"Gauge Address:",-1)),e("div",xe,[f(v,{modelValue:d(t),"onUpdate:modelValue":n[0]||(n[0]=h=>x(t)?t.value=h:null),placeholder:d(u)},null,8,["modelValue","placeholder"])])]),e("div",$e,[n[3]||(n[3]=e("div",{class:"label"},"Vote Description:",-1)),e("div",Ne,[f(v,{modelValue:d(a),"onUpdate:modelValue":n[1]||(n[1]=h=>x(a)?a.value=h:null)},null,8,["modelValue"])])])]),f(w,{class:"action-button request primary",disabled:!d(l),"chain-id":d(B).id,onClick:b},{default:C(()=>n[4]||(n[4]=[V(" Create Gauge Addition Vote ")])),_:1},8,["disabled","chain-id"])])]),_:1})}}}),Ge=R(Ae,[["__scopeId","data-v-de5e1b81"]]),Fe={class:"dashboard"},Re={class:"forms"},qe=A({__name:"VeFunder.page",setup(_){const i=y(""),c=o=>{i.value=o};return(o,t)=>{const a=F;return G(),X("div",Fe,[f(a,null,{default:C(()=>t[0]||(t[0]=[e("div",{class:"explanation"},[e("div",{class:"step-one"},[e("span",null,[e("strong",null,"veFunder"),V(" process:")]),e("ol",null,[e("li",null," Create a fundraising gauge contract that allows a receiver to get a certain amount of CRV. "),e("li",null,[V(" Request a vote to add the gauge to the controller."),e("br"),V("When passed, the newly created gauge can be voted on during gauge votes and can then receive gauge emissions. ")])])]),e("div",{class:"step-two"},[e("span",null,[e("strong",null,"Gauge vote requirements:")]),e("ol",null,[e("li",null,[V(" New gauge votes must have a vote on the governance forum "),e("a",{href:"https://gov.curve.fi/",target:"_blank"}," at this address ")]),e("li",null,"You must have a minimum of 2,500 veCRV to create this vote")])])],-1)])),_:1}),e("div",Re,[f(ve,{onGauge:c}),f(Ge,{gauge:d(i)},null,8,["gauge"])])])}}}),Ee=R(qe,[["__scopeId","data-v-2ec14f38"]]);export{Ee as default};

import{_ as oe}from"./KPI-BucudXEr.js";import{_ as le}from"./AsyncValue-CjNdb71H.js";import{_ as re}from"./SelectChain-C71IcTPX.js";import{a as ce,b as ie}from"./chains-CsdiGDKL.js";import{d as D,T as W,U as O,f as l,V as N,h as L,o as U,w as T,a as B,b as r,u as e,_ as q,e as z,r as ue,t as de,a3 as pe,c as me}from"./index-D_ZRdWWY.js";import{u as E,b as Q,c as X,_ as Y,a as K}from"./UseLightweightChart-CKO-jo9q.js";import{r as I,u as P}from"./Number-_oqacp-E.js";import{c as j,_ as G}from"./ChartStylesApex-RlMNSOXU.js";import{u as H,_ as J}from"./UseLegend-C-TEhwkE.js";import{c as Z}from"./String-TwmdtJxb.js";import{a as M}from"./index-DopUz7zm.js";import"./ChainIcon-Cb2czfB8.js";import"./timestamp-Dfir0V72.js";import"./useQuery-DHettQXn.js";import"./Object-DOSYkgA0.js";const _e=["crvusd","lending","pools","router","dao"],ve={style:{display:"flex"}},he={ref:"chartRef",class:"chart"},fe=D({__name:"ChartTxs",props:{txs:{}},setup(f){const y=W(),c=O("card"),{chart:g,series:n}=E({createChartOptions:X(),series:{type:"Area",name:"txs",options:l(()=>({priceFormat:{type:"custom",formatter:i=>`${I(i,0,"dollar")}${P(i)}`,minMove:.01},lineWidth:2,lineType:Q.WithSteps,lineColor:y.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});N(h);function h(){if(!g.value||!n.txs)return;const i=f.txs.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.txs.setData(i),g.value.timeScale().fitContent()}return(i,a)=>{const p=q;return U(),L(p,{ref_key:"card",ref:c,title:"Transactions"},{actions:T(()=>[B("div",ve,[r(e(Y),{filename:"txs",series:e(n)},null,8,["series"]),r(e(K),{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[B("div",he,null,512)]),_:1},512)}}}),ye={style:{display:"flex"}},ge={ref:"chartRef",class:"chart"},be=D({__name:"ChartUsers",props:{users:{}},setup(f){const y=W(),c=O("card"),{chart:g,series:n}=E({createChartOptions:X(),series:{type:"Area",name:"users",options:l(()=>({priceFormat:{type:"custom",formatter:i=>`${I(i,0,"dollar")}${P(i)}`,minMove:.01},lineWidth:2,lineType:Q.WithSteps,lineColor:y.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});N(h);function h(){if(!g.value||!n.users)return;const i=f.users.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.users.setData(i),g.value.timeScale().fitContent()}return(i,a)=>{const p=q;return U(),L(p,{ref_key:"card",ref:c,title:"Users"},{actions:T(()=>[B("div",ye,[r(e(Y),{filename:"users",series:e(n)},null,8,["series"]),r(e(K),{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[B("div",ge,null,512)]),_:1},512)}}}),xe=D({__name:"ChartRankingChains",props:{type:{},txs:{},users:{}},setup(f){const y=W(),c=l(()=>`Top Chains (${f.type==="all"?"All Types":Z(f.type)})`),{items:g,toggles:n,disabled:h}=H(()=>{const{blue:t,yellow:o}=y.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function i(t){return t.groupBy(o=>o.chain).entries().map(([o,_])=>{const u=_.reduce((v,x)=>v+x.value,0);return{chain:o,count:u}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=y.value;return j({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:b.value,labels:{formatter:S}},yaxis:{labels:{formatter:A}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?i(f.txs):[]),C=l(()=>n.users.value?i(f.users):[]),b=l(()=>p.value.concat(C.value).orderBy(t=>t.count,"desc").map(t=>t.chain).uniq()),k=l(()=>{const t=b.value.map(_=>{const u=p.value.find(v=>v.chain===_);return u?u.count:0}),o=b.value.map(_=>{const u=C.value.find(v=>v.chain===_);return u?u.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,A=t=>`${I(t,0,"dollar")}${P(t)}`;return(t,o)=>{const _=J,u=G,v=q;return U(),L(v,{title:e(c)},{"actions-secondary":T(()=>[r(_,{items:e(g),disabled:e(h),onToggle:o[0]||(o[0]=x=>e(n)[x].value=!e(n)[x].value)},null,8,["items","disabled"])]),default:T(()=>[r(u,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),Ce=z(xe,[["__scopeId","data-v-ce4cf7e7"]]),Te=D({__name:"ChartRankingTypes",props:{chain:{},txs:{},users:{}},setup(f){const y=W(),c=l(()=>`Top Types (${f.chain==="all"?"All Chains":Z(f.chain)})`),{items:g,toggles:n,disabled:h}=H(()=>{const{blue:t,yellow:o}=y.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function i(t){return t.groupBy(o=>o.type).entries().map(([o,_])=>{const u=_.reduce((v,x)=>v+x.value,0);return{type:o,count:u}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=y.value;return j({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:b.value,labels:{formatter:S}},yaxis:{labels:{formatter:A}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?i(f.txs):[]),C=l(()=>n.users.value?i(f.users):[]),b=l(()=>p.value.concat(C.value).orderBy(t=>t.count,"desc").map(t=>t.type).uniq()),k=l(()=>{const t=b.value.map(_=>{const u=p.value.find(v=>v.type===_);return u?u.count:0}),o=b.value.map(_=>{const u=C.value.find(v=>v.type===_);return u?u.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,A=t=>`${I(t,0,"dollar")}${P(t)}`;return(t,o)=>{const _=J,u=G,v=q;return U(),L(v,{title:e(c)},{"actions-secondary":T(()=>[r(_,{items:e(g),disabled:e(h),onToggle:o[0]||(o[0]=x=>e(n)[x].value=!e(n)[x].value)},null,8,["items","disabled"])]),default:T(()=>[r(u,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),we=z(Te,[["__scopeId","data-v-27837759"]]),$e={class:"option"},Se={class:"label"},Ae=D({__name:"ActivityTypeSelect",emits:["select"],setup(f,{emit:y}){const c=y,g=["all",..._e],n=ue("all");function h(a){switch(a){case"all":return"All Types";case"crvusd":return"crvUSD";case"lending":return"Lending";case"pools":return"Pools";case"router":return"Router";case"dao":return"DAO"}}function i(a){n.value=a,c("select",n.value)}return(a,p)=>{const C=pe;return U(),L(C,{options:g,selected:e(n),onSelect:i},{option:T(({option:b})=>[B("div",$e,[B("div",Se,de(h(b)),1)])]),_:1},8,["selected"])}}}),Be=z(Ae,[["__scopeId","data-v-5448f8e1"]]),ke={class:"dashboard"},De={class:"toolbar"},Ue=D({__name:"Chains.page",setup(f){const y=M("chain"),c=l({get(){return y.value?y.value:"all"},set(s){y.value=s}}),g=l(()=>{const s=p.value.map(m=>m.chain).concat(b.value.map(m=>m.chain)).concat(c.value!=="all"?[c.value]:[]).uniq().orderBy(m=>m,"asc"),w=["ethereum"],$=s.difference(w).orderBy(m=>m,"asc");return["all",...w,...$]}),n=M("type"),h=l({get(){return n.value?n.value:"all"},set(s){n.value=s}}),i=s=>{h.value=s},{isFetching:a,data:p}=ce(),{isFetching:C,data:b}=ie();function k(s,w,$,m){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).groupBy(d=>d.timestamp.getTime()).entries().map(([d,R])=>{const V=R.reduce((F,ne)=>F+m(ne),0);return{timestamp:Number(d)/1e3,count:V}})}const S=l(()=>k(p.value,c.value,h.value,s=>s.transactions)),A=l(()=>k(b.value,c.value,h.value,s=>s.users));function t(s){const m=Math.floor(Date.now()/1e3)-7*24*60*60,R=s.filter(V=>V.timestamp>=m).reduce((V,F)=>V+F.count,0);return Math.round(R/7)}const o=l(()=>{var s;return((s=S.value.at(-1))==null?void 0:s.count)??0}),_=l(()=>t(S.value)),u=l(()=>{var s;return((s=A.value.at(-1))==null?void 0:s.count)??0}),v=l(()=>t(A.value));function x(s,w,$,m){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).map(d=>({chain:d.chain,type:d.type,value:m(d)}))}const ee=l(()=>x(p.value,"all",h.value,s=>s.transactions)),te=l(()=>x(b.value,"all",h.value,s=>s.users)),se=l(()=>x(p.value,c.value,"all",s=>s.transactions)),ae=l(()=>x(b.value,c.value,"all",s=>s.users));return(s,w)=>{const $=re,m=le,d=oe;return U(),me("div",ke,[B("div",De,[r(e(Be),{style:{"grid-area":"type"},onSelect:i}),r($,{all:"",style:{"grid-area":"chain"},class:"chain-select",chain:e(c),chains:e(g),onSelectChain:w[0]||(w[0]=R=>c.value=R)},null,8,["chain","chains"])]),r(d,{style:{"grid-area":"kpi1"},label:"Transactions Today","has-value":!!e(a)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(o),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi2"},label:"Avg Transactions / 7 Days","has-value":!!e(a)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(_),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi3"},label:"Avg Users / 7 Days","has-value":!!e(C)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(u),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi4"},label:"Users Today","has-value":!!e(C)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(v),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(e(fe),{style:{"grid-area":"txs"},txs:e(S),loading:e(a)},null,8,["txs","loading"]),r(e(be),{style:{"grid-area":"users"},users:e(A),loading:e(C)},null,8,["users","loading"]),r(e(Ce),{style:{"grid-area":"top-chains"},type:e(h),txs:e(ee),users:e(te),loading:e(a)||e(C)},null,8,["type","txs","users","loading"]),r(e(we),{style:{"grid-area":"top-types"},chain:e(c),txs:e(se),users:e(ae),loading:e(a)||e(C)},null,8,["chain","txs","users","loading"])])}}}),Ye=z(Ue,[["__scopeId","data-v-be882189"]]);export{Ye as default};

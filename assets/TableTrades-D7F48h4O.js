import{t as U,g as T,f as S,a as se}from"./timestamp-DkvXAN4c.js";import{u as k}from"./useQuery-GHjouMSi.js";import{f,a9 as N,d as q,T as P,U as oe,V as M,h as g,o as b,_ as $,w as p,a as c,b as v,u as _,r as Q,j as V,e as B,W as ne,t as w,Q as j,K as X,N as Y,i as K}from"./index-CXYbPx9b.js";import{u as R,c as D,a as A,_ as ie,b as le,x as re,G as ue,r as ce}from"./UseLightweightChart-B8YGhKDU.js";import{r as L,u as W}from"./Number-Bxs3KMTV.js";import{_ as G}from"./ButtonToggle-BgGJijCo.js";import{c as z,_ as E}from"./ChartStylesApex-D2P0cyvn.js";import{u as J,_ as Z}from"./UseLegend-Cz0R_GHj.js";import{_ as I,a as de}from"./Table-CECkJBYj.js";import{_ as x}from"./AsyncValue-BhLVS80y.js";import{a as ee,_ as te}from"./UsePagination-DQB4U4Zi.js";import{u as ae}from"./UseRelativeTime-BO-PTM26.js";import{_ as me}from"./TokenIcon-D2L2NGEr.js";const pe=e=>({provider:e.provider,deposit:e.deposit?{amount:e.deposit.amount,n1:e.deposit.n1,n2:e.deposit.n2}:null,withdrawal:e.withdrawal?{amountBorrowed:e.withdrawal.amount_borrowed,amountCollateral:e.withdrawal.amount_collateral}:null,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),_e=e=>({idSold:e.sold_id,idBought:e.bought_id,tokenSold:{symbol:e.token_sold.symbol,address:e.token_sold.address},tokenBought:{symbol:e.token_bought.symbol,address:e.token_bought.address},amountSold:e.amount_sold,amountBought:e.amount_bought,price:e.price,buyer:e.buyer,feeX:e.fee_x,feeY:e.fee_y,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),ve=e=>({time:U(e.time),open:e.open??null,close:e.close??null,high:e.high??null,low:e.low??null,basePrice:e.base_price??null,oraclePrice:e.oracle_price??null,volume:e.volume??null});async function he({endpoint:e,chain:n,llamma:s,page:a=1,perPage:l=10},r){const i=T(r),t=new URLSearchParams({page:a.toString(),per_page:l.toString()}),o=await S(`${i}/v1/${e}/llamma_events/${n}/${s}??${t.toString()}`);return{events:o.data.map(pe),count:o.count}}async function fe({endpoint:e,chain:n,llamma:s,page:a=1,perPage:l=10},r){const i=T(r),t=new URLSearchParams({page:a.toString(),per_page:l.toString()}),o=await S(`${i}/v1/${e}/llamma_trades/${n}/${s}?${t.toString()}`);return{trades:o.data.map(_e),count:o.count}}async function ge({endpoint:e,chain:n,llamma:s,interval:a=1,units:l="hour",start:r,end:i},t){const o=T(t),d=se({start:r,end:i}),u=new URLSearchParams({agg_number:a.toString(),agg_units:l,start:d.start.toString(),end:d.end.toString()});return(await S(`${o}/v1/${e}/llamma_ohlc/${n}/${s}?${u.toString()}`)).data.map(ve)}function Ut(e,n,s,a){return k({queryKey:["llamma-market-events",n,a],queryFn:({queryKey:[,l,r]})=>he({endpoint:e,chain:s.value,llamma:l,page:r}),placeholderData:N,enabled:f(()=>!!n.value&&!!s.value)})}function Bt(e,n,s,a){return k({queryKey:["llamma-market-trades",n,a],queryFn:({queryKey:[,l,r]})=>fe({endpoint:e,chain:s.value,llamma:l,page:r}),placeholderData:N,enabled:f(()=>!!n.value&&!!s.value)})}function Ot(e,n,s){return k({queryKey:["llamma-market-ohlc",n],queryFn:({queryKey:[,a]})=>ge({endpoint:e,chain:s.value,llamma:a}),enabled:f(()=>!!n.value&&!!s.value)})}const be={style:{display:"flex"}},ye={ref:"chartRef",class:"chart"},Pt=q({__name:"ChartCollateralRatio",props:{ratios:{}},setup(e){const n=P(),s=oe("card"),{chart:a,series:l}=R({createChartOptions:A(),series:D({name:"ratios",color:f(()=>n.value.colors.blue),formatter:i=>`${L(i,0,"percentage")}%`,minMove:.01})});M(r);function r(){if(!a.value||!l.ratios)return;const i=e.ratios.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.ratio*100})).uniqWith((t,o)=>t.time===o.time).orderBy(t=>t.time,"asc");i.length>0&&l.ratios.setData(i),a.value.timeScale().fitContent()}return(i,t)=>{const o=ie,d=le,u=$;return b(),g(u,{ref_key:"card",ref:s,title:"Collateral Ratio"},{actions:p(()=>[c("div",be,[v(o,{filename:"collateral_ratio",series:_(l)},null,8,["series"]),v(d,{chart:_(a),target:_(s)},null,8,["chart","target"])])]),default:p(()=>[c("div",ye,null,512)]),_:1},512)}}}),qe={class:"button-group"},Mt=q({__name:"ChartLiqs",props:{liqs:{}},setup(e){const n=Q("count"),s=a=>{n.value!==a&&(n.value=a)};return(a,l)=>{const r=G,i=$;return b(),g(i,{title:"Self & Hard Liquidations"},{actions:p(()=>[c("div",qe,[v(r,{"model-value":_(n)==="count",onClick:l[0]||(l[0]=t=>s("count"))},{default:p(()=>l[2]||(l[2]=[V(" Count ")])),_:1,__:[2]},8,["model-value"]),v(r,{"model-value":_(n)==="value",onClick:l[1]||(l[1]=t=>s("value"))},{default:p(()=>l[3]||(l[3]=[V(" Value ")])),_:1,__:[3]},8,["model-value"])])]),default:p(()=>[_(n)==="count"?(b(),g(_($e),{key:0,liqs:a.liqs},null,8,["liqs"])):(b(),g(_(Le),{key:1,liqs:a.liqs},null,8,["liqs"]))]),_:1})}}}),we=q({__name:"ChartLiqsCount",props:{liqs:{}},setup(e){const n=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:s.value,labels:{formatter:r,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:l.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),s=f(()=>e.liqs.orderBy(t=>t.timestamp.getTime(),"asc").groupBy(t=>t.timestamp.getTime()).entries().map(([t])=>new Date(parseInt(t,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((t,o)=>o%8===0?t:"")),a=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.selfCount}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.hardCount}))}]),l=f(()=>Math.max(...e.liqs.groupBy(t=>t.timestamp.getTime()).entries().map(([,t])=>t.sumBy(o=>o.selfCount+o.hardCount)))*1.1),r=t=>t,i=t=>`${L(t,1,"dollar")}${W(t)}`;return(t,o)=>{const d=E;return b(),g(d,{options:_(n),series:_(a)},null,8,["options","series"])}}}),$e=B(we,[["__scopeId","data-v-6ff28a9f"]]),Ce=q({__name:"ChartLiqsValue",props:{liqs:{}},setup(e){const n=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:s.value,labels:{formatter:r,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:l.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),s=f(()=>e.liqs.orderBy(t=>t.timestamp.getTime(),"asc").groupBy(t=>t.timestamp.getTime()).entries().map(([t])=>new Date(parseInt(t,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((t,o)=>o%8===0?t:"")),a=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.selfValue}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.hardValue}))}]),l=f(()=>Math.max(...e.liqs.groupBy(t=>t.timestamp.getTime()).entries().map(([,t])=>t.sumBy(o=>o.selfValue+o.hardValue)))*1.1),r=t=>t,i=t=>`${L(t,1,"dollar")}${W(t)}`;return(t,o)=>{const d=E;return b(),g(d,{options:_(n),series:_(a)},null,8,["options","series"])}}}),Le=B(Ce,[["__scopeId","data-v-9067c7d2"]]),Te={ref:"chartRef",class:"chart"},Rt=q({__name:"ChartLiqsMedianLoss",props:{losses:{}},setup(e){const n=P(),{chart:s,series:a}=R({createChartOptions:A(),series:D({name:"losses",color:f(()=>n.value.colors.blue),formatter:r=>`${L(r,0,"percentage")}%`,minMove:.01})});M(l);function l(){if(!s.value||!a.losses)return;const r=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.pctLossMedian})).uniqWith((i,t)=>i.time===t.time).orderBy(i=>i.time,"asc");r.length>0&&a.losses.setData(r),s.value.timeScale().fitContent()}return(r,i)=>{const t=$;return b(),g(t,{title:"Median Loss % Among Loans with Losses"},{default:p(()=>[c("div",Te,null,512)]),_:1})}}}),Se={ref:"chartRef",class:"chart"},At=q({__name:"ChartLiqsLosersProportion",props:{losses:{}},setup(e){const n=P(),{chart:s,series:a}=R({createChartOptions:A(),series:D({name:"losses",color:f(()=>n.value.colors.blue),formatter:r=>`${L(r,0,"percentage")}%`})});M(l);function l(){if(!s.value||!a.losses)return;const r=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.numTotalUsers>0?100*i.numUsersWithLosses/i.numTotalUsers:0})).uniqWith((i,t)=>i.time===t.time).orderBy(i=>i.time,"asc");r.length>0&&a.losses.setData(r),s.value.timeScale().fitContent()}return(r,i)=>{const t=$;return b(),g(t,{title:"Proportion of Loans with Losses"},{default:p(()=>[c("div",Se,null,512)]),_:1})}}}),Ht=q({__name:"ChartLiqsHealthDeciles",props:{deciles:{}},setup(e){const n=f(()=>z({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1}},xaxis:{categories:s.value,labels:{formatter:l,rotate:-60},tickPlacement:"on"},yaxis:{labels:{formatter:r}},plotOptions:{bar:{columnWidth:"50%"}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:i=>{const t=i.series[0][i.dataPointIndex],o=i.series[1][i.dataPointIndex],d=i.series[2][i.dataPointIndex];return[`<div><b>Collat. (USD)</b>: ${r(o)}</div>`,`<div><b>Debt</b>: ${r(t)}</div>`,`<div><b>Stablecoin</b>: ${r(d)}</div>`].join("")}}})),s=f(()=>e.deciles.map(i=>i.decile)),a=f(()=>[{name:"Debt",data:Object.values(e.deciles).map(i=>i.debt)},{name:"Collateral",data:Object.values(e.deciles).map(i=>i.collateralUsdValue)},{name:"Stablecoin",data:Object.values(e.deciles).map(i=>i.stablecoin)}]),l=i=>i,r=i=>`$${L(i,0,"dollar")}${W(i)}`;return(i,t)=>{const o=E,d=$;return b(),g(d,{title:"Debt & Assets per Health Deciles"},{default:p(()=>[v(o,{options:_(n),series:_(a)},null,8,["options","series"])]),_:1})}}}),ke={ref:"chartRef",class:"chart"},Vt=q({__name:"ChartLiqsSoftLiqRatio",props:{ratios:{},pricesOracle:{}},setup(e){const n=P(),{items:s}=J(()=>[{id:"percentage",label:"% of loans in soft liquidation",color:n.value.colorsArray[0]},{id:"collateral-price",label:"Collateral price ($)",color:n.value.colorsArray[1]}]),{chart:a,series:l}=R({createChartOptions:A({leftPriceScale:{visible:!0}}),series:[D({name:"price",color:f(()=>n.value.colors.yellow),formatter:i=>`$${L(i,2,"dollar")}${W(i)}`}),D({name:"ratio",color:f(()=>n.value.colors.blue),formatter:i=>`${L(i,0,"percentage")}%`})]});M(r);function r(){if(!a.value||!l.price||!l.ratio)return;const i=e.ratios.map(o=>({time:o.timestamp.getUTCTimestamp(),value:o.proportion})).uniqWith((o,d)=>o.time===d.time).orderBy(o=>o.time,"asc");l.ratio.setData(i);const t=i.length>0?i[0].time:0;l.price.setData(e.pricesOracle.filter(o=>o.timestamp.getUTCTimestamp()>=t).map(o=>({time:o.timestamp.getUTCTimestamp(),value:o.priceOracle})).uniqWith((o,d)=>o.time===d.time).orderBy(o=>o.time,"asc")),a.value.timeScale().fitContent()}return(i,t)=>{const o=Z,d=$;return b(),g(d,{title:"Soft Liquidations Ratio"},{"actions-secondary":p(()=>[v(o,{items:_(s)},null,8,["items"])]),default:p(()=>[c("div",ke,null,512)]),_:1})}}}),De={ref:"chartRef",class:"chart"},Wt=q({__name:"ChartLiquidatorRevenue",props:{discounts:{},liqs:{}},setup(e){const n=P(),{items:s}=J(()=>[{id:"revenue",label:"Liquidator Revenue",color:n.value.colorsArray[0]},{id:"discount",label:"Discount",color:n.value.colorsArray[1]}]),{chart:a,series:l}=R({createChartOptions:A({leftPriceScale:{visible:!0}}),series:[D({name:"revenue",color:f(()=>n.value.colors.blue),formatter:"price",precision:0,minMove:1}),D({name:"discount",color:f(()=>n.value.colors.yellow),formatter:"percent",precision:6,minMove:1e-6})]});M(r);function r(){if(!a.value||!l.discount||!l.revenue)return;const i=e.liqs.map(o=>({time:o.timestamp.getUTCTimestamp(),value:o.debt})).uniqWith((o,d)=>o.time===d.time).orderBy(o=>o.time,"asc").reduce((o,d)=>{const u=o.length>0?o[o.length-1].value:0;return o.push({time:d.time,value:d.value+u}),o},[]);l.revenue.setData(i);const t=i.length>0?i[0].time:0;l.discount.setData(e.discounts.filter(o=>o.timestamp.getUTCTimestamp()>=t).map(o=>({time:o.timestamp.getUTCTimestamp(),value:o.discount*100})).uniqWith((o,d)=>o.time===d.time).orderBy(o=>o.time,"asc")),a.value.timeScale().fitContent()}return(i,t)=>{const o=Z,d=$;return b(),g(d,{title:"Liquidator Revenue"},{"actions-secondary":p(()=>[v(o,{items:_(s)},null,8,["items"])]),default:p(()=>[c("div",De,null,512)]),_:1})}}}),Ue={class:"end"},Be={class:"end"},Oe={class:"end"},Pe={class:"end"},Me={class:"end"},Re={class:"collateral end"},Ae={class:"end"},He=q({__name:"TableLiqOverview",props:{overview:{}},setup(e){const n=f(()=>{if(!e.overview)return 0;const s=e.overview.liqableDebtUsd,a=e.overview.liqableCollatUsd+e.overview.liqableBorrowedUsd,l=s-a;return l<=0?0:l});return(s,a)=>{const l=de,r=x,i=I,t=$;return b(),g(t,{title:"General Health Metrics"},{default:p(()=>[v(i,{class:"liq-overview-table"},{default:p(()=>[v(l,null,{default:p(()=>[a[0]||(a[0]=c("div",null,"Users in soft liquidation",-1)),c("div",Ue,w(s.overview?.softLiqUsers??0),1)]),_:1,__:[0]}),v(l,null,{default:p(()=>[a[1]||(a[1]=c("div",null,"Median health",-1)),c("div",Be,[v(r,{"show-zero":"",type:"percentage",value:s.overview?.medianHealth??0},null,8,["value"])])]),_:1,__:[1]}),v(l,null,{default:p(()=>[a[2]||(a[2]=c("div",null,"Collaterization ratio",-1)),c("div",Oe,[v(r,{"show-zero":"",type:"percentage",value:s.overview?.collatRatio??0},null,8,["value"])])]),_:1,__:[2]}),v(l,null,{default:p(()=>[a[3]||(a[3]=c("div",null,"Liquidatable positions",-1)),c("div",Pe,w(s.overview?.liqablePositions??0),1)]),_:1,__:[3]}),v(l,null,{default:p(()=>[a[4]||(a[4]=c("div",null,"Liquidatable positions' debt",-1)),c("div",Me,[v(r,{"show-zero":"",type:"dollar",value:s.overview?.liqableDebtUsd??0},null,8,["value"])])]),_:1,__:[4]}),v(l,null,{default:p(()=>[a[6]||(a[6]=c("div",null,"Liquidatable collateral (token / crvUSD)",-1)),c("div",Re,[v(r,{"show-zero":"",type:"dollar",value:s.overview?.liqableCollatUsd??0},null,8,["value"]),a[5]||(a[5]=V(" / ")),v(r,{"show-zero":"",type:"dollar",value:s.overview?.liqableBorrowedUsd??0},null,8,["value"])])]),_:1,__:[6]}),_(n)>0?(b(),g(l,{key:0},{default:p(()=>[a[7]||(a[7]=c("div",null,"Bad debt",-1)),c("div",Ae,[v(r,{"show-zero":"",class:"red",type:"dollar",value:_(n)},null,8,["value"])])]),_:1,__:[7]})):ne("",!0)]),_:1})]),_:1})}}}),Ft=B(He,[["__scopeId","data-v-472ed839"]]),Ve={class:"address"},We=["href"],Fe={class:"end"},Ke={class:"end"},Ie=q({__name:"TableTopLiquidators",props:{liqs:{}},setup(e){const n=f(()=>e.liqs.groupBy(s=>s.liquidator).entries().map(([s,a])=>({liquidator:s,count:a.length,value:a.sumBy(l=>l.collateralReceivedUsd)})).orderBy(s=>s.value,"desc").take(5));return(s,a)=>{const l=x,r=I,i=$;return b(),g(i,{title:"Top Liquidators"},{default:p(()=>[v(r,{class:"liquidators-table",rows:_(n),columns:["Address",{label:"Count",align:"end"},{label:"Value",align:"end"}]},{row:p(({item:t})=>[c("div",Ve,[c("a",{target:"_blank",href:`https://etherscan.io/address/${t.liquidator}`},w(("addressShort"in s?s.addressShort:_(j))(t.liquidator,8)),9,We)]),c("div",Fe,[v(l,{"show-zero":"",value:t.count,precision:0},null,8,["value"])]),c("div",Ke,[v(l,{type:"dollar",value:t.value,precision:1},null,8,["value"])])]),_:1},8,["rows"])]),_:1})}}}),Kt=B(Ie,[["__scopeId","data-v-b07f488e"]]),Qe=e=>({timestamp:U(e.timestamp),proportion:e.proportion/100}),je=e=>({timestamp:U(e.dt),user:e.user,liquidator:e.liquidator,self:e.self,collateralReceived:e.collateral_received,collateralReceivedUsd:e.collateral_received_usd,stablecoinReceived:e.stablecoin_received,priceOracle:e.oracle_price,debt:e.debt,n1:e.n1,n2:e.n2,tx:e.tx,block:e.block}),ze=e=>({timestamp:U(e.timestamp),selfCount:e.self_count,hardCount:e.hard_count,selfValue:e.self_value,hardValue:e.hard_value,price:e.price}),Ee=e=>({softLiqUsers:e.soft_liquidation_users,liqablePositions:e.liquidatable_positions,liqableDebtUsd:e.liquidatable_pos_debt_usd,liqableCollatUsd:e.liquidatable_collateral_usd,liqableBorrowedUsd:e.liquidatable_borrowed_usd,medianHealth:e.median_health,avgHealth:e.average_health,collatRatio:e.collat_ratio}),Ne=e=>({timestamp:U(e.timestamp),pctLossAverage:e.avg_pct_loss,pctLossMedian:e.median_pct_loss,absoluteLossAverage:e.avg_abs_loss,absoluteLossMedian:e.median_abs_loss,numTotalUsers:e.total_users,numUsersWithLosses:e.users_with_losses,ratio:e.ratio}),Xe=e=>({decile:e.health_decile,collateralUsdValue:e.collateral,debt:e.debt,stablecoin:e.stablecoin});async function Ye(e,n,s,a){const l=T(a);return(await S(`${l}/v1/${e}/liquidations/${n}/${s}/soft_liquidation_ratio`)).data.map(Qe)}async function Ge(e,n,s,a){const l=T(a);return(await S(`${l}/v1/${e}/liquidations/${n}/${s}/history/detailed`)).data.map(je)}async function Je(e,n,s,a){const l=T(a);return(await S(`${l}/v1/${e}/liquidations/${n}/${s}/history/aggregated`)).data.map(ze)}async function Ze(e,n,s,a){const l=T(a),r=await S(`${l}/v1/${e}/liquidations/${n}/${s}/overview?fetch_on_chain=true`);return Ee(r)}async function xe(e,n,s,a){const l=T(a);return(await S(`${l}/v1/${e}/liquidations/${n}/${s}/losses/history`)).data.map(Ne)}async function et(e,n,s,a){const l=T(a);return(await S(`${l}/v1/${e}/liquidations/${n}/${s}/health/distribution`)).data.map(Xe)}function F(){return{initialData:[],initialDataUpdatedAt:0}}function H(e,n){return{enabled:f(()=>!!e.value&&(n?!!n.value:!0))}}function It(e,n,s){return k({queryKey:["liqs-soft-liqs",s],queryFn:({queryKey:[,a]})=>Ye(e.value,n.value,a),...H(s,n),...F()})}function Qt(e,n,s){return k({queryKey:["liqs-detailed",s],queryFn:({queryKey:[,a]})=>Ge(e.value,n.value,a),...H(s,n),...F()})}function jt(e,n,s){return k({queryKey:["liqs-aggregate",s],queryFn:({queryKey:[,a]})=>Je(e.value,n.value,a),...H(s,n),...F()})}function zt(e,n,s){return k({queryKey:["liqs-overview",s],queryFn:({queryKey:[,a]})=>Ze(e.value,n.value,a),...H(s,n)})}function Et(e,n,s){return k({queryKey:["liqs-losses",s],queryFn:({queryKey:[,a]})=>xe(e.value,n.value,a),...H(s,n),...F()})}function Nt(e,n,s){return k({queryKey:["liqs-health-deciles",s],queryFn:({queryKey:[,a]})=>et(e.value,n.value,a),...H(s,n),...F()})}const tt={class:"controls"},at={ref:"chartRef",class:"chart"},st=q({__name:"ChartOHLC",props:{ohlc:{}},setup(e){const n=P(),s=Q(!1),a=Q(!1);let l=1,r=0;const{chart:i,series:t}=R({createChartOptions:A({localization:{priceFormatter:u=>d(u)}}),series:[{type:re,name:"ohlc",options:f(()=>{const{colors:u}=n.value;return{priceFormat:{type:"price",precision:6,minMove:1e-6},upColor:u.green,borderUpColor:u.green,wickUpColor:u.green,downColor:u.red,borderDownColor:u.red,wickDownColor:u.red}})},{type:ue,name:"oracle",options:f(()=>({priceFormat:{type:"price",precision:6,minMove:1e-6},lineWidth:2,lineType:ce.WithSteps,color:n.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}]});M(o);function o(){if(!i.value||!t.ohlc||!t.oracle)return;const u=s.value?-1:1,h=e.ohlc.filter(m=>m.open!==null&&m.high!==null&&m.low!==null&&m.close!==null).map(m=>({time:m.time.getUTCTimestamp(),open:Math.pow(m.open,u),high:Math.pow(m.high,u),low:Math.pow(m.low,u),close:Math.pow(m.close,u)})).uniqWith((m,C)=>m.time===C.time).orderBy(m=>m.time,"asc");h.length>0&&(t.ohlc.setData(h),r=Math.min(...h.map(m=>m.low)),l=Math.max(...h.map(m=>m.high))),t.oracle.setData(e.ohlc.filter(m=>m.oraclePrice!==null).map(m=>({time:m.time.getUTCTimestamp(),value:Math.pow(m.oraclePrice,u)})).uniqWith((m,C)=>m.time===C.time).orderBy(m=>m.time,"asc")),t.oracle.applyOptions({visible:a.value}),i.value.timeScale().fitContent()}function d(u){const h=l-r,m=h>1?h-Math.floor(h):h,C=-Math.floor(Math.log10(m)+1)+2;return`${L(u,C,"dollar")}${W(u)}`}return(u,h)=>{const m=G,C=$;return b(),g(C,{title:"Price"},{actions:p(()=>[c("div",tt,[v(m,{"model-value":_(a),onClick:h[0]||(h[0]=y=>a.value=!_(a))},{default:p(()=>h[2]||(h[2]=[V(" Oracle Price ")])),_:1,__:[2]},8,["model-value"]),v(m,{"model-value":_(s),onClick:h[1]||(h[1]=y=>s.value=!_(s))},{default:p(()=>h[3]||(h[3]=[V(" Invert ")])),_:1,__:[3]},8,["model-value"])])]),default:p(()=>[c("div",at,null,512)]),_:1})}}}),Xt=B(st,[["__scopeId","data-v-effb3c30"]]),ot={class:"end"},nt=["href"],it={class:"end"},lt=["href"],rt=q({__name:"TableEvents",props:{events:{},count:{}},emits:["page"],setup(e,{emit:n}){const s=n,{page:a,onPage:l}=ee(),r=X(a,200);Y(r,u=>{s("page",u)});const{relativeTime:i}=ae(),t=u=>u<1?u.toFixed(4):u>1e3?u.toFixed(0):u.toFixed(2),o=u=>t(u.deposit?.amount??u.withdrawal?.amountCollateral??0),d=u=>u.deposit?"Deposit":u.withdrawal?"Withdrawal":"Unknown";return(u,h)=>{const m=te,C=I,y=$;return b(),g(y,{title:"Events"},{actions:p(()=>[v(m,{"items-count":u.count,"items-per-page":10,page:_(a),onPage:_(l)},null,8,["items-count","page","onPage"])]),default:p(()=>[v(C,{class:"events-table",rows:u.events,columns:["Type",{label:"Amount",align:"end"},"","Provider",{label:"Time",align:"end"}]},{row:p(({item:O})=>[c("div",null,w(d(O)),1),c("div",ot,w(o(O)),1),h[2]||(h[2]=c("div",null,null,-1)),c("div",null,[c("a",{target:"_blank",href:`https://etherscan.io/address/${O.provider}`,onClick:h[0]||(h[0]=K(()=>{},["stop"]))},w(("addressShort"in u?u.addressShort:_(j))(O.provider)),9,nt)]),c("div",it,[c("a",{target:"_blank",href:`https://etherscan.io/tx/${O.txHash}`,onClick:h[1]||(h[1]=K(()=>{},["stop"]))},w(_(i)(O.timestamp.getUTCTimestamp())),9,lt)])]),_:1},8,["rows"])]),_:1})}}}),Yt=B(rt,[["__scopeId","data-v-7ae8399c"]]),ut={class:"end"},ct=["href"],dt={class:"end"},mt=["href"],pt=["href"],_t={class:"end"},vt=["href"],ht=q({__name:"TableTrades",props:{trades:{},count:{},chain:{}},emits:["page"],setup(e,{emit:n}){const s=n,{page:a,onPage:l}=ee(),r=X(a,200);Y(r,o=>{s("page",o)});const{relativeTime:i}=ae(),t=o=>o<1?o.toFixed(4):o>1e3?o.toFixed(0):o.toFixed(2);return(o,d)=>{const u=te,h=me,m=I,C=$;return b(),g(C,{title:"Trades"},{actions:p(()=>[v(u,{"items-count":o.count,"items-per-page":10,page:_(a),onPage:_(l)},null,8,["items-count","page","onPage"])]),default:p(()=>[v(m,{class:"trades-table",rows:o.trades,columns:[{label:"Bought",align:"end"},"","",{label:"Sold",align:"end"},"","","Market Maker",{label:"Time",align:"end"}]},{row:p(({item:y})=>[c("div",ut,w(t(y.amountBought)),1),v(h,{chain:o.chain,address:y.tokenBought.address},null,8,["chain","address"]),c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.tokenBought.address}`},w(y.tokenBought.symbol),9,ct)]),c("div",dt,w(t(y.amountSold)),1),v(h,{chain:o.chain,address:y.tokenSold.address},null,8,["chain","address"]),c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.tokenSold.address}`},w(y.tokenSold.symbol),9,mt)]),c("div",null,[c("a",{target:"_blank",href:`https://etherscan.io/address/${y.buyer}`,onClick:d[0]||(d[0]=K(()=>{},["stop"]))},w(("addressShort"in o?o.addressShort:_(j))(y.buyer)),9,pt)]),c("div",_t,[c("a",{target:"_blank",href:`https://etherscan.io/tx/${y.txHash}`,onClick:d[1]||(d[1]=K(()=>{},["stop"]))},w(_(i)(y.timestamp.getUTCTimestamp())),9,vt)])]),_:1},8,["rows"])]),_:1})}}}),Gt=B(ht,[["__scopeId","data-v-6212d8d5"]]);export{Xt as C,Ft as T,Vt as _,zt as a,It as b,jt as c,Qt as d,Nt as e,Et as f,Rt as g,At as h,Ht as i,Pt as j,Mt as k,Kt as l,Wt as m,Bt as n,Ut as o,Gt as p,Yt as q,Ot as u};

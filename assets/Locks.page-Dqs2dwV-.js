import{d as w,I,z as y,X as M,Y as O,a5 as V,a6 as L,Z as q,h as N,o as S,w as u,b as p,a as s,u as e,f as k,_ as B,g as D,t as R,Q as H,V as F,a1 as P,K as X,c as Y,aa as Z}from"./index-BYnNAfSP.js";import{a as W,b as j,c as G}from"./dao-B_d4UlBK.js";import{u as J,_ as ee}from"./UseLegend-CoonPT9k.js";import{_ as A}from"./ButtonToggle-Cf3bACCF.js";import{u as U,c as Q,_ as E,a as z}from"./UseLightweightChart-DudqJuBl.js";import{_ as K}from"./Table-CkrHHA0S.js";import{u as x}from"./UseSort-BgHBlkv6.js";import{_ as te}from"./IconExpander-Cg0RjqCc.js";import"./Object-DOSYkgA0.js";const oe={style:{display:"flex"}},ae={class:"actions-secondary"},se={class:"button-group"},le={ref:"chartRef",class:"chart"},ne=w({__name:"ChartSupply",setup(T){const n=I("1m"),C=y(()=>{switch(n.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:f,data:_}=W(C),g=M(),{items:b,toggles:a,disabled:d}=J(()=>{const{blue:l,yellow:o,purple:v}=g.value.colors;return[{id:"crv",label:"CRV",color:l,togglable:!0},{id:"circ",label:"Circulating",color:o,togglable:!0},{id:"vecrv",label:"veCRV",color:v,togglable:!0}]});a.circ.value=!1,a.crv.value=!1;const m=O("card"),{chart:c,series:t}=U({createChartOptions:Q(),series:[{type:"Line",name:"crv",options:y(()=>({priceFormat:{type:"custom",formatter:l=>`${V(l,2,"dollar")}${L(l)}`,minMove:.01},lineWidth:2,color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"circ",options:y(()=>({priceFormat:{type:"custom",formatter:l=>`${V(l,2,"dollar")}${L(l)}`,minMove:.01},lineWidth:2,color:g.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"vecrv",options:y(()=>({priceFormat:{type:"custom",formatter:l=>`${V(l,2,"dollar")}${L(l)}`,minMove:.01},lineWidth:2,color:g.value.colors.purple,lastValueVisible:!1,priceLineVisible:!1}))}]});q(i);function i(){if(!c.value||!t.crv||!t.circ||!t.vecrv)return;const l=_.value.map(r=>({time:r.timestamp.getUTCTimestamp(),value:Number(r.crvSupply)/10**18})).uniqWith((r,h)=>r.time===h.time).orderBy(r=>r.time,"asc"),o=_.value.map(r=>({time:r.timestamp.getUTCTimestamp(),value:Number(r.circulatingSupply)/10**18})).uniqWith((r,h)=>r.time===h.time).orderBy(r=>r.time,"asc"),v=_.value.map(r=>({time:r.timestamp.getUTCTimestamp(),value:Number(r.veCrvTotal)/10**18})).uniqWith((r,h)=>r.time===h.time).orderBy(r=>r.time,"asc");t.crv.setData(l),t.circ.setData(o),t.vecrv.setData(v),t.crv.applyOptions({visible:a.crv.value}),t.circ.applyOptions({visible:a.circ.value}),t.vecrv.applyOptions({visible:a.vecrv.value}),c.value.timeScale().fitContent()}return(l,o)=>{const v=A,r=ee,h=B;return S(),N(h,{ref_key:"card",ref:m,title:"Token Supply",class:"stack-actions",loading:e(f)},{actions:u(()=>[p("div",oe,[s(e(E),{filename:"token_supply",series:e(t)},null,8,["series"]),s(e(z),{chart:e(c),target:e(m)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",ae,[p("div",se,[s(v,{"model-value":e(n)==="1m",onClick:o[0]||(o[0]=$=>n.value="1m")},{default:u(()=>o[5]||(o[5]=[k(" 1m ")])),_:1},8,["model-value"]),s(v,{"model-value":e(n)==="3m",onClick:o[1]||(o[1]=$=>n.value="3m")},{default:u(()=>o[6]||(o[6]=[k(" 3m ")])),_:1},8,["model-value"]),s(v,{"model-value":e(n)==="6m",onClick:o[2]||(o[2]=$=>n.value="6m")},{default:u(()=>o[7]||(o[7]=[k(" 6m ")])),_:1},8,["model-value"]),s(v,{"model-value":e(n)==="1y",onClick:o[3]||(o[3]=$=>n.value="1y")},{default:u(()=>o[8]||(o[8]=[k(" 1y ")])),_:1},8,["model-value"])]),s(r,{items:e(b),disabled:e(d),onToggle:o[4]||(o[4]=$=>e(a)[$].value=!e(a)[$].value)},null,8,["items","disabled"])])]),default:u(()=>[p("div",le,null,512)]),_:1},8,["loading"])}}}),re=D(ne,[["__scopeId","data-v-215e2a9f"]]),ie={style:{display:"flex"}},ue={class:"button-group"},ce={ref:"chartRef",class:"chart"},me=w({__name:"ChartSupplyDelta",setup(T){const n=I("1m"),C=y(()=>{switch(n.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:f,data:_}=W(C),g=M(),b=O("card"),{chart:a,series:d}=U({createChartOptions:Q(),series:{type:"Histogram",name:"deltas",options:y(()=>({priceFormat:{type:"custom",formatter:c=>`${V(c,0,"dollar")}${L(c)}`,minMove:.01},color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}});q(m);function m(){if(!a.value||!d.deltas)return;const{colors:c}=g.value,t=_.value.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.veCrvTotal})).uniqWith((i,l)=>i.time===l.time).orderBy(i=>i.time,"asc").reduce((i,l,o,v)=>{if(o===0)return i;const r=l.value-v[o-1].value,h=r<0?c.red:c.green;return i.push({time:l.time,value:Number(r)/10**18,color:h}),i},[]);t.length>0&&(d.deltas.setData(t),a.value.timeScale().fitContent())}return(c,t)=>{const i=A,l=B;return S(),N(l,{ref_key:"card",ref:b,title:"veCRV Change",loading:e(f)},{actions:u(()=>[p("div",ie,[s(e(E),{filename:"distributions_delta",series:e(d)},null,8,["series"]),s(e(z),{chart:e(a),target:e(b)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",ue,[s(i,{"model-value":e(n)==="1m",onClick:t[0]||(t[0]=o=>n.value="1m")},{default:u(()=>t[4]||(t[4]=[k(" 1m ")])),_:1},8,["model-value"]),s(i,{"model-value":e(n)==="3m",onClick:t[1]||(t[1]=o=>n.value="3m")},{default:u(()=>t[5]||(t[5]=[k(" 3m ")])),_:1},8,["model-value"]),s(i,{"model-value":e(n)==="6m",onClick:t[2]||(t[2]=o=>n.value="6m")},{default:u(()=>t[6]||(t[6]=[k(" 6m ")])),_:1},8,["model-value"]),s(i,{"model-value":e(n)==="1y",onClick:t[3]||(t[3]=o=>n.value="1y")},{default:u(()=>t[7]||(t[7]=[k(" 1y ")])),_:1},8,["model-value"])])]),default:u(()=>[p("div",ce,null,512)]),_:1},8,["loading"])}}}),pe=w({__name:"TableLocks",setup(T){const{isFetching:n,data:C}=j(),f=[{id:"day",label:"Day",sort:!0},{id:"amount",label:"Amount",sort:!0,align:"end"}],{sorting:_,onSort:g}=x("day"),b=y(()=>C.value.orderBy(d=>{switch(_.value.column){case"day":return d.day.getTime();case"amount":return Number(d.amount)}},_.value.order));function a(d){return Math.round(Number(d.amount)/10**18)}return(d,m)=>{const c=F,t=K,i=B;return S(),N(i,{title:"Daily Lock Change",loading:e(n)},{default:u(()=>[s(t,{rows:e(b),columns:f,sorting:e(_),onSortColumn:e(g)},{row:u(({item:l})=>[p("div",null,R(l.day.toLocaleDateString()),1),p("div",{class:H(["end",{positive:a(l)>0,negative:a(l)<0}])},[s(c,{value:a(l),precision:2},null,8,["value"])],2)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),de=D(pe,[["__scopeId","data-v-3ae158f5"]]),ve=["href"],_e={class:"end"},ge={class:"end"},ye={class:"end"},fe=w({__name:"TableLockers",setup(T){const{isFetching:n,data:C}=G(),f=[{id:"locker",label:"Locker",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"ratio",label:"Ratio",sort:!0,align:"end"},{id:"unlock",label:"Unlock Date",sort:!0,align:"end"}],{sorting:_,onSort:g}=x("weight"),b=y(()=>C.value.orderBy(m=>{switch(_.value.column){case"weight":return Number(m.weight);case"ratio":return m.weightRatio;case"unlock":return m.unlockTime.getTime()}},_.value.order)),a=P();async function d(m){await a.push({name:"profile",params:{tab:"governance"},query:{user:m.user}})}return(m,c)=>{const t=F,i=te,l=K,o=B;return S(),N(o,{title:"Top Lockers",loading:e(n)},{default:u(()=>[s(l,{rows:e(b),columns:f,sorting:e(_),onSortColumn:e(g),onSelect:d},{row:u(({item:v})=>[p("div",null,[p("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${v.user}`,onClick:c[0]||(c[0]=X(()=>{},["stop"]))},R(v.user),9,ve)]),p("div",_e,[s(t,{value:Number(v.weight)/10**18},null,8,["value"])]),p("div",ge,[s(t,{type:"percentage",value:v.weightRatio,precision:2},null,8,["value"])]),p("div",ye,R(v.unlockTime.toLocaleDateString()),1),s(i)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),be=D(fe,[["__scopeId","data-v-46f8d26c"]]),Ce={class:"dashboard"},he={class:"two-sides"},ke={style:{display:"flex",gap:"0.5ch"}},$e=w({__name:"Locks.page",setup(T){const{isFetching:n,data:C}=W(),f=y(()=>C.value.orderBy(a=>a.timestamp.getTime(),"desc")[0]??void 0),_=y(()=>{var a;return Number(((a=f.value)==null?void 0:a.veCrvTotal)??0)/10**18}),g=y(()=>{var a;return Number(((a=f.value)==null?void 0:a.crvSupply)??0)/10**18}),b=y(()=>{var a;return Number(((a=f.value)==null?void 0:a.circulatingSupply)??0)/10**18});return(a,d)=>{const m=F,c=Z;return S(),Y("div",Ce,[s(c,{style:{"grid-area":"kpi1"},label:"veCRV Supply","has-value":!e(n)},{default:u(()=>[s(m,{type:"dollar",value:e(_),precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),s(c,{style:{"grid-area":"kpi2"},label:"CRV Supply / Circulating","has-value":!e(n)},{default:u(()=>[p("div",he,[p("div",ke,[s(m,{type:"dollar",value:e(g),precision:2,"show-symbol":!1},null,8,["value"]),d[0]||(d[0]=p("span",{style:{color:"var(--c-lvl5)"}},"/",-1)),s(m,{type:"dollar",value:e(b),precision:2,"show-symbol":!1},null,8,["value"])]),s(m,{type:"percentage",value:100*e(b)/e(g),precision:2},null,8,["value"])])]),_:1},8,["has-value"]),s(re,{style:{"grid-area":"supply"}}),s(me,{style:{"grid-area":"supply-delta"}}),s(de,{style:{"grid-area":"locks"}}),s(be,{style:{"grid-area":"lockers"}})])}}}),Fe=D($e,[["__scopeId","data-v-60485839"]]);export{Fe as default};

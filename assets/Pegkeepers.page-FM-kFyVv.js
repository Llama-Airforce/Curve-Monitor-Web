import{d as $,r as z,c as _,e as A,o as x,w as f,b as n,u as o,f as c,i as F,O as U,g as R,a9 as B,_ as S,W as K,X as I,Y as O,a as Q}from"./index-aGD7oz-u.js";import{_ as W}from"./Table-QwvIK97f.js";import{_ as E}from"./AsyncValue-D2chhg9L.js";import{_ as M}from"./TokenIcon-C4_LoTSB.js";import{_ as N}from"./InputText-76qLRkFM.js";import{f as D,g as j}from"./crvusd-2QPdzl_-.js";import{d as q}from"./pools-BCBxMCRh.js";import{u as X,_ as Y}from"./UseLegend-Cvet9Lce.js";import{u as G,a as H,c as J}from"./UseLightweightChart-DAGdKVOX.js";import{_ as Z,a as ee}from"./BtnChartLWFullscreen.vue_vue_type_script_setup_true_lang-Dw_e5NUf.js";import{r as se,u as oe}from"./Number-CJjP1isT.js";import"./api-Bfvlvlrj.js";import"./timestamp-C4C6eGnP.js";import"./useQuery-LuUyZeGb.js";import"./UseHost-DdNl-ipS.js";import"./Object-DOSYkgA0.js";function ae(h){return h!=null}const te={class:"end"},le={class:"end"},ne={class:"end"},re={class:"end"},ie={class:"end"},ce={class:"end"},de={class:"end"},ue={class:"end"},pe=$({__name:"TablePegkeepers",setup(h){const m=z(""),g=_(()=>P.value||L.value),C=_(()=>b.value.filter(e=>e.active).map(e=>{const l=T.value.find(t=>e.poolAddress===t.address);if(l)return{...l,...e,pool:l.address}}).filter(ae).orderBy(e=>e.tvlUsd,"desc")),p=_(()=>C.value.filter(e=>{const l=m.value.toLocaleLowerCase().split(" "),t=r=>l.some(s=>r.toLocaleLowerCase().includes(s));return t(e.name)||t(e.address)})),{isFetching:L,data:b}=D(),V=e=>`${e.pair[1].symbol} / ${e.pair[0].symbol}`,k=_(()=>b.value.map(e=>e.poolAddress)),w=q(z("ethereum"),k),P=_(()=>w.value.some(e=>e.isFetching)),T=_(()=>w.value.filter(e=>e.data).map(e=>e.data)),d=e=>e>=1e6?2:0,y=e=>e.pair.filter(l=>l.address.toLocaleLowerCase()!==B)[0].address;return(e,l)=>{const t=N,r=M,s=E,i=W,u=R;return x(),A(u,{class:"pegkeepers-card",title:"Pegkeepers",loading:o(g)},{actions:f(()=>[n(t,{modelValue:o(m),"onUpdate:modelValue":l[0]||(l[0]=a=>U(m)?m.value=a:null),search:"",placeholder:"Search for.."},null,8,["modelValue"])]),default:f(()=>[n(i,{class:"pegkeepers-table",rows:o(p),columns:["","Name",{label:"Debt",align:"end"},{label:"TVL",align:"end"},{label:"Volume",align:"end"},{label:"Fees",align:"end"}]},{row:f(({item:a})=>[n(r,{chain:"ethereum",address:y(a)},null,8,["address"]),c("div",null,F(V(a)),1),c("div",te,[n(s,{"show-zero":"",type:"dollar",value:a.totalDebt,precision:d},null,8,["value"])]),c("div",le,[n(s,{"show-zero":"",type:"dollar",value:a.tvlUsd,precision:d},null,8,["value"])]),c("div",ne,[n(s,{"show-zero":"",type:"dollar",value:a.tradingVolume24h,precision:d},null,8,["value"])]),c("div",re,[n(s,{"show-zero":"",type:"dollar",value:a.totalProfit,precision:d},null,8,["value"])])]),"row-aggregation":f(()=>[l[1]||(l[1]=c("div",null,null,-1)),l[2]||(l[2]=c("div",null,null,-1)),c("div",ie,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,v)=>a+v.totalDebt,0),precision:d},null,8,["value"])]),c("div",ce,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,v)=>a+v.tvlUsd,0),precision:d},null,8,["value"])]),c("div",de,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,v)=>a+v.tradingVolume24h,0),precision:d},null,8,["value"])]),c("div",ue,[n(s,{"show-zero":"",type:"dollar",value:o(p).reduce((a,v)=>a+v.totalProfit,0),precision:d},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),_e=S(pe,[["__scopeId","data-v-89367e94"]]),me={style:{display:"flex"}},ge={ref:"chartRef",class:"chart"},ve=$({__name:"ChartKeeperPrices",setup(h){const m=K(),g=["USDC","USDT"],{items:C,toggles:p,disabled:L}=X(()=>g.map((t,r)=>({id:t,label:t,color:m.value.colorsArray[r],togglable:!0}))),b=_(()=>V.value||P.value),{isFetching:V,data:k}=D(),w=_(()=>k.value.filter(t=>t.pair.some(({symbol:r})=>g.map(s=>s.toLocaleLowerCase()).includes(r.toLocaleLowerCase())))),{isFetching:P,data:T}=j(w),d=I("card"),{chart:y,series:e}=G({createChartOptions:J(),series:g.map((t,r)=>({type:"Line",name:t,options:_(()=>({priceFormat:{type:"custom",formatter:s=>`${se(s,3,"dollar")}${oe(s)}`},lineWidth:2,lineType:H.WithSteps,color:m.value.colorsArray[r],lastValueVisible:!1,priceLineVisible:!1,autoscaleInfoProvider:s=>{const i=s();return i!==null&&(i.priceRange.minValue=Math.max(.98,i.priceRange.minValue),i.priceRange.maxValue=Math.min(1.02,i.priceRange.maxValue)),i}}))}))});O(l);function l(){var t,r;if(!(!y.value||Object.values(e).length<0)){for(const[,s]of g.entries()){(t=e[s])==null||t.applyOptions({visible:p[s].value});const i=T.value.map(u=>({time:u.timestamp,value:u[s]})).uniqWith((u,a)=>u.time===a.time).orderBy(u=>u.time,"asc");i.length>0&&((r=e[s])==null||r.setData(i))}y.value.timeScale().fitContent()}}return(t,r)=>{const s=Y,i=R;return x(),A(i,{ref_key:"card",ref:d,title:"Pegkeepers Coin Prices",loading:o(b)},{actions:f(()=>[c("div",me,[n(o(Z),{filename:"keeper_prices",series:o(e)},null,8,["series"]),n(o(ee),{chart:o(y),target:o(d)},null,8,["chart","target"])])]),"actions-secondary":f(()=>[n(s,{items:o(C),disabled:o(L),onToggle:r[0]||(r[0]=u=>o(p)[u].value=!o(p)[u].value)},null,8,["items","disabled"])]),default:f(()=>[c("div",ge,null,512)]),_:1},8,["loading"])}}}),fe={class:"dashboard"},he=$({__name:"Pegkeepers.page",setup(h){return(m,g)=>(x(),Q("div",fe,[n(o(_e),{style:{"grid-area":"table"}}),n(o(ve),{style:{"grid-area":"chart"}})]))}}),Fe=S(he,[["__scopeId","data-v-9d916ab2"]]);export{Fe as default};

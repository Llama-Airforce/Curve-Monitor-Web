import{q as g,O as m,u as p,c as d,av as b,H as _,r as q,ag as v,aw as I,a8 as C}from"./index-CT4FqvTD.js";import{e as w,b as P,i as F,d as $,j}from"./getAction-9a4D1v2V.js";import{u as c}from"./useQuery-BavYuEWE.js";import{t as k,f as y,g as l,F as D}from"./timestamp-Dfir0V72.js";/**
 * @license lucide-vue-next v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=g("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=g("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);async function W(t,e){const{abi:r,address:o,args:a,functionName:s,...n}=e,i=w({abi:r,args:a,functionName:s});try{const{data:u}=await P(t,F,"call")({...n,data:i,to:o});return $({abi:r,args:a,functionName:s,data:u||"0x"})}catch(u){throw j(u,{abi:r,address:o,args:a,docsPath:"/docs/contract/readContract",functionName:s})}}function K(t){return t.state.chainId}function O(t,e){const{onChange:r}=e;return t.subscribe(o=>o.chainId,r)}function f(t,e){if(e){const r=e(t);if(r===void 0&&m(t)||r!==void 0)return r}if(Array.isArray(t))return t.map(r=>f(r,e));if(typeof t=="object"&&N(t)){const r=Object.entries(t).map(([o,a])=>[o,f(a,e)]);return Object.fromEntries(r)}return t}function B(t){return f(t,e=>{if(m(e))return B(p(e))})}function N(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function G(t){const e=d(()=>({...p(t),queryKeyHashFn:b})),r=c(e);return r.queryKey=p(e).queryKey,r}function T(t={}){const e=_(t),r=q(K(e)),o=O(e,{onChange(a){r.value=a}});return v(()=>o()),I(r)}const h=t=>{var e;return{timestamp:k(t.dt),id:t.vote_id,type:t.vote_type.toLocaleLowerCase()==="parameter"?"parameter":"ownership",metadata:(e=t.metadata)!=null&&e.startsWith('"')?t.metadata.substring(1):t.metadata??"",proposer:t.creator,block:t.snapshot_block,start:t.start_date,end:t.start_date+604800,quorum:Number(BigInt(t.min_accept_quorum))/10**18,support:Number(BigInt(t.support_required))/10**18,voteCount:t.vote_count,votesFor:Number(BigInt(t.votes_for))/10**18,votesAgainst:Number(BigInt(t.votes_against))/10**18,executed:t.executed,totalSupply:Number(BigInt(t.total_supply))/10**18,txCreation:t.transaction_hash}},A=t=>({...h(t),txExecution:t.execution_tx?t.execution_tx:void 0,script:t.script,votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,votingPower:Number(BigInt(e.voting_power))/10**18}))}),E=t=>({proposal:h(t.proposal),votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,weight:BigInt(Math.round(parseFloat(e.voting_power))),txHash:e.transaction_hash}))});async function Q(t,e,r,o,a){const s=l(a),n=await y(`${s}/v1/dao/proposals?pagination=10&page=${t}&search_string=${e}&type_filter=${r}&status_filter=${o}`);return{proposals:n.proposals.map(h),count:n.count}}async function U(t,e,r){const o=l(r),a=await y(`${o}/v1/dao/proposals/details/${e}/${t}`);return A(a)}async function H(t,e){try{const r=l(e);return(await y(`${r}/v1/dao/proposals/votes/user/${t}?pagination=100&page=1`)).data.map(E)}catch(r){if(r instanceof D)return[];throw r}}function L(){return{initialData:[],initialDataUpdatedAt:0}}function Y(t,e,r){return c({queryKey:["proposal",t,e],queryFn:({queryKey:[,o,a]})=>U(o,a),...r&&{enabled:r}})}function Z(t,e,r,o){return c({queryKey:["proposals",t,o,e,r],queryFn:({queryKey:[,a,s,n,i]})=>Q(a,s,n,i),placeholderData:C})}function z(t){return c({queryKey:["proposal-user-votes",d(()=>t.value)],queryFn:({queryKey:[,e]})=>H(e),enabled:d(()=>!!t.value),...L()})}export{X as C,J as X,G as a,z as b,Z as c,B as d,Y as e,W as r,T as u};

import{d as $,r as D,f as w,T as F,U as R,V as W,h as x,o as B,w as u,a as l,b as s,u as a,j as b,_ as A,e as L,t as T,O as I,a4 as M,a5 as N,$ as E,c as O}from"./index-CB0lbOkp.js";import{u as z,_ as Q}from"./UseLegend-BjWtFUgd.js";import{_ as j}from"./ButtonToggle-MT8WNIRs.js";import{u as q,b as V,c as K,_ as P,a as G}from"./UseLightweightChart-D45Z5owe.js";import{d as H,u as J}from"./crvusd-657i8rJZ.js";import{r as X,u as Y}from"./Number-BucUTk9j.js";/* empty css                                                                         *//* empty css                                                                    */import{_ as Z}from"./Table-NQndpLny.js";import{_ as ee}from"./AsyncValue-C0jBgRNU.js";import{_ as te}from"./TokenIcon-Cqe8ofer.js";import{_ as se}from"./IconExpander-D1g4JwOL.js";import{_ as oe}from"./InputText-CXpNFmeS.js";import"./Object-DOSYkgA0.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-B6SWxrK9.js";const le={style:{display:"flex"}},ae={class:"actions-secondary"},ne={class:"button-group"},re={ref:"chartRef",class:"chart"},ie=$({__name:"ChartCrvUsdSupply",setup(U){const r=D("3m"),y=w(()=>{switch(r.value){case"7d":return 7;case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 90}}),d=F(),{items:c}=z(()=>[{id:"supply",label:"Supply",color:d.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:d.value.colorsArray[1]}]),{isFetching:h,data:k}=H(y),p=R("card"),{chart:m,series:o}=q({createChartOptions:K(),series:[{type:"Area",name:"supply",options:w(()=>({priceFormat:{type:"custom",formatter:f},lineWidth:2,lineType:V.WithSteps,lineColor:d.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"debt",options:w(()=>({priceFormat:{type:"custom",formatter:f},lineWidth:2,lineType:V.WithSteps,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});W(v);function v(){if(!m.value||!o.debt||!o.supply)return;const _=k.value.groupBy(n=>n.timestamp.getTime()).entries().map(([,n])=>{var t;return{time:n[0].timestamp.getUTCTimestamp(),value:n.reduce((i,S)=>i+S.supply,0),debt:((t=n.find(i=>i.market==="Keepers debt"))==null?void 0:t.supply)??0}}).uniqWith((n,t)=>n.time===t.time).orderBy(n=>n.time,"asc"),e=_.map(n=>({time:n.time,value:n.value-n.debt}));_.length>0&&o.supply.setData(_),e.length>0&&o.debt.setData(e),m.value.timeScale().fitContent();const g=new Date(Date.UTC(2025,2,20));o.supply.setMarkers([{time:g.getUTCTimestamp(),position:"aboveBar",color:d.value.colors.red,shape:"arrowDown",text:"Resupply Launch"}])}function f(_){return`${X(_,0,"dollar")}${Y(_)}`}return(_,e)=>{const g=P,n=G,t=j,i=Q,S=A;return B(),x(S,{ref_key:"card",ref:p,title:"crvUSD Supply",class:"stack-actions",loading:a(h)},{actions:u(()=>[l("div",le,[s(g,{filename:"crvusd_supply",series:a(o)},null,8,["series"]),s(n,{chart:a(m),target:a(p)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[l("div",ae,[l("div",ne,[s(t,{"model-value":a(r)==="7d",onClick:e[0]||(e[0]=C=>r.value="7d")},{default:u(()=>e[5]||(e[5]=[b(" 7d ")])),_:1},8,["model-value"]),s(t,{"model-value":a(r)==="1m",onClick:e[1]||(e[1]=C=>r.value="1m")},{default:u(()=>e[6]||(e[6]=[b(" 1m ")])),_:1},8,["model-value"]),s(t,{"model-value":a(r)==="3m",onClick:e[2]||(e[2]=C=>r.value="3m")},{default:u(()=>e[7]||(e[7]=[b(" 3m ")])),_:1},8,["model-value"]),s(t,{"model-value":a(r)==="6m",onClick:e[3]||(e[3]=C=>r.value="6m")},{default:u(()=>e[8]||(e[8]=[b(" 6m ")])),_:1},8,["model-value"]),s(t,{"model-value":a(r)==="1y",onClick:e[4]||(e[4]=C=>r.value="1y")},{default:u(()=>e[9]||(e[9]=[b(" 1y ")])),_:1},8,["model-value"])]),s(i,{items:a(c)},null,8,["items"])])]),default:u(()=>[l("div",re,null,512)]),_:1},8,["loading"])}}}),de=L(ie,[["__scopeId","data-v-1a775a8c"]]),ue={class:"end"},ce={class:"end"},pe={class:"end"},me={class:"end"},_e={class:"end"},ve={class:"end"},fe={class:"end"},ye={class:"end"},ge={class:"end"},be={class:"end"},he={class:"end"},Ce=$({__name:"TableMarkets",emits:["select"],setup(U,{emit:r}){const y=r,d=D(""),c=w(()=>k.value.filter(m=>{const o=d.value.toLocaleLowerCase().split(" "),v=f=>o.some(_=>f.toLocaleLowerCase().includes(_));return v(m.name)||v(m.address)}).orderBy(m=>m.borrowed,"desc")),{isFetching:h,data:k}=J(),p=m=>m>=1e6?2:0;return(m,o)=>{const v=oe,f=se,_=te,e=ee,g=Z,n=A;return B(),x(n,{class:"markets-card",title:"Markets",loading:a(h)},{actions:u(()=>[s(v,{modelValue:a(d),"onUpdate:modelValue":o[0]||(o[0]=t=>I(d)?d.value=t:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:u(()=>[s(g,{class:"markets-table",rows:a(c),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:o[1]||(o[1]=t=>y("select",t))},{row:u(({item:t})=>[s(f),s(_,{chain:"ethereum",address:t.collateralToken.address},null,8,["address"]),l("div",null,T(t.name),1),l("div",ue,T(t.loans),1),l("div",ce,[s(e,{type:"percentage",value:t.rate*100,precision:2},null,8,["value"])]),l("div",pe,[s(e,{type:"dollar",value:t.borrowed,precision:p,"show-symbol":!1},null,8,["value"])]),l("div",me,[s(e,{type:"dollar",value:t.collateralAmountUsd,precision:p},null,8,["value"])]),l("div",_e,[s(e,{type:"dollar",value:t.fees.pending,precision:p},null,8,["value"])]),l("div",ve,[s(e,{"show-zero":"",type:"dollar",value:t.fees.collected,precision:p},null,8,["value"])])]),"row-aggregation":u(()=>[o[2]||(o[2]=l("div",null,null,-1)),o[3]||(o[3]=l("div",null,null,-1)),o[4]||(o[4]=l("div",null,null,-1)),l("div",fe,T(a(c).reduce((t,i)=>t+i.loans,0)),1),o[5]||(o[5]=l("div",null,null,-1)),l("div",ye,[s(e,{type:"dollar",value:a(c).reduce((t,i)=>t+i.borrowed,0),precision:p,"show-symbol":!1},null,8,["value"])]),l("div",ge,[s(e,{type:"dollar",value:a(c).reduce((t,i)=>t+i.collateralAmountUsd,0),precision:p},null,8,["value"])]),l("div",be,[s(e,{type:"dollar",value:a(c).reduce((t,i)=>t+i.fees.pending,0),precision:p},null,8,["value"])]),l("div",he,[s(e,{"show-zero":"",type:"dollar",value:a(c).reduce((t,i)=>t+i.fees.collected,0),precision:p},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),we=L(Ce,[["__scopeId","data-v-f583e6f5"]]),ke={class:"dashboard"},Se=$({__name:"CrvUsd.page",setup(U){const{crumbs:r}=M(N());r.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const y=E(),d=async c=>{await y.push({name:"crvusdmarket",params:{tab:"",marketAddr:c.address}})};return(c,h)=>(B(),O("div",ke,[s(a(we),{style:{"grid-area":"table"},onSelect:d}),s(a(de),{style:{"grid-area":"chart"}})]))}}),ze=L(Se,[["__scopeId","data-v-26d04f0d"]]);export{ze as default};

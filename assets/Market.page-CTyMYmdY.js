import{_ as X,a as Y}from"./TabItem.vue_vue_type_script_setup_true_lang-DTe1EXtF.js";import{d as C,g as b,T as D,f,V as I,h as y,o as h,_ as V,u as e,w as v,a as g,r as w,b as o,O as Z,e as A,c as R,t as q,W as B,S as H,j as x,a5 as ee,a6 as ae,N as te,R as se,a3 as E}from"./index-BBOHFnXS.js";import{e as M,u as ne}from"./crvusd-BJ7M5QBo.js";import{u as j,a as oe,b as re,c as ie,d as le,e as ce,f as de,T as ue,_ as me,g as _e,h as pe,i as ve,j as he,k as ge,l as fe,m as ke,n as be,o as ye,C as $e,p as Ce,q as Te}from"./TableTrades-SYj2q42E.js";import{u as Q,c as P,a as N,k as we,G as Le,r as qe}from"./UseLightweightChart-Dxkkslvj.js";import"./ChartStylesApex-CQIaECDe.js";import{_ as Ae}from"./KPI-BNdp5fCu.js";import{_ as Se}from"./AsyncValue-wMIVBtRI.js";import"./UseLegend-lrpdBFBK.js";import"./ButtonToggle-Byu6sjXf.js";/* empty css                                                                         */import{r as U,u as G}from"./Number-wfCN9KXp.js";import{_ as Fe}from"./InputNumber-z1i7Ybky.js";import{_ as K,a as Re}from"./Table-CQg7a1sX.js";import{L as z}from"./link-CjGzjYJp.js";import{_ as Ve}from"./TokenIcon-CQbNR5-u.js";import{a as Be}from"./index-B2qD6cve.js";import{u as Oe}from"./UseTabNavigation-DBAwp4AL.js";import"./timestamp-CoE2HNXc.js";import"./api-BCRV542q.js";import"./useQuery-CXlEW_Q7.js";import"./UsePagination-BRzqITkF.js";import"./UseRelativeTime-D7cSGaY8.js";import"./Object-DOSYkgA0.js";/* empty css                                                                    */const De={ref:"chartRef",class:"chart"},Ie=C({__name:"ChartMarketAvailableCap",props:{market:{}},setup(l){const{isFetching:s,data:u}=M(b(()=>l.market)),m=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:P({name:"available",color:f(()=>m.value.colors.blue),formatter:a=>`$${U(a,0,"dollar")}${G(a)}`})});I(r);function r(){!n.value||!t.available||(t.available.setData(u.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.borrowable})).uniqWith((a,i)=>a.time===i.time).orderBy(a=>a.time,"asc").dropWhile(a=>a.value===0)),n.value.timeScale().fitContent())}return(a,i)=>{const p=V;return h(),y(p,{title:"Borrowable & Debt Ceiling",loading:e(s)},{default:v(()=>[g("div",De,null,512)]),_:1},8,["loading"])}}}),Me={ref:"chartRef",class:"chart"},Qe=C({__name:"ChartMarketLoans",props:{market:{}},setup(l){const{isFetching:s,data:u}=M(b(()=>l.market)),m=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:{type:we,name:"loans",options:f(()=>({color:m.value.colors.yellow,lastValueVisible:!1,priceFormat:{type:"volume"},priceLineVisible:!1}))}});I(r);function r(){!n.value||!t.loans||(t.loans.setData(u.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.nLoans})).uniqWith((a,i)=>a.time===i.time).orderBy(a=>a.time,"asc")),n.value.timeScale().fitContent())}return(a,i)=>{const p=V;return h(),y(p,{title:"Loans",loading:e(s)},{default:v(()=>[g("div",Me,null,512)]),_:1},8,["loading"])}}}),Ne={ref:"chartRef",class:"chart"},We=C({__name:"ChartMarketRates",props:{market:{}},setup(l){const{isFetching:s,data:u}=M(b(()=>l.market)),m=D(),n=w(null),{chart:t,series:r}=Q({createChartOptions:N(),series:[P({name:"rates",color:f(()=>m.value.colors.blue),formatter:i}),{type:Le,name:"ema",options:f(()=>({priceFormat:{type:"custom",formatter:i},lineWidth:2,lineType:qe.WithSteps,color:m.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});I(a);function a(){if(!t.value||!r.rates||!r.ema)return;const _=u.value.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.rate})).uniqWith((c,$)=>c.time===$.time).orderBy(c=>c.time,"asc"),k=p(_.map(c=>c.value),n.value??31).zip(_).map(c=>({time:c[1].time,value:c[0]}));r.ema.setData(k),r.rates.setData(_),t.value.timeScale().fitContent()}function i(_){return`${U(_*100,0,"percentage")}%`}const p=(_,d=7)=>_.map((k,c)=>{const $=Math.max(c-(d-1),0),S=c+1,L=_.slice($,S);return L.sumBy(O=>O)/L.length});return(_,d)=>{const k=Fe,c=V;return h(),y(c,{title:"Rates",loading:e(s)},{actions:v(()=>[o(k,{modelValue:e(n),"onUpdate:modelValue":d[0]||(d[0]=$=>Z(n)?n.value=$:null),class:"avg-span",placeholder:"Avg span (days)",min:1,max:1/0},null,8,["modelValue"])]),default:v(()=>[g("div",Ne,null,512)]),_:1},8,["loading"])}}}),Ee=A(We,[["__scopeId","data-v-4c10cf91"]]),Pe={ref:"chartRef",class:"chart"},Ue=C({__name:"ChartMarketVolume",props:{market:{},chain:{}},setup(l){const{isFetching:s,data:u}=j("crvusd",f(()=>{var a;return(a=l.market)==null?void 0:a.llamma}),b(()=>l.chain)),m=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:P({name:"volume",color:f(()=>m.value.colors.blue),formatter:a=>`$${U(a,0,"dollar")}${G(a)}`})});I(r);function r(){if(!n.value||!t.volume)return;const a=(u.value??[]).map(i=>({time:i.time.getUTCTimestamp(),value:i.volume})).uniqWith((i,p)=>i.time===p.time).orderBy(i=>i.time,"asc");a.length>0&&t.volume.setData(a),n.value.timeScale().fitContent()}return(a,i)=>{const p=V;return h(),y(p,{title:"Volume",loading:e(s)},{default:v(()=>[g("div",Pe,null,512)]),_:1},8,["loading"])}}}),He={class:"dashboard-grid"},je=C({__name:"Liquidations",props:{market:{},chain:{}},setup(l){const s=f(()=>{var T;return(T=l.market)==null?void 0:T.address}),{isFetching:u,data:m}=oe(w("crvusd"),b(()=>l.chain),s),{isFetching:n,data:t}=M(b(()=>l.market)),r=f(()=>t.value.map(({timestamp:T,priceOracle:F})=>({timestamp:T,priceOracle:F}))),a=f(()=>t.value.map(({timestamp:T,discountLiquidation:F})=>({timestamp:T,discount:F}))),i=f(()=>t.value.map(({timestamp:T,totalCollateralUsd:F,totalDebt:J})=>({timestamp:T,ratio:F/J}))),{isFetching:p,data:_}=re(w("crvusd"),b(()=>l.chain),s),{isFetching:d,data:k}=ie(w("crvusd"),b(()=>l.chain),s),{isFetching:c,data:$}=le(w("crvusd"),b(()=>l.chain),s),{isFetching:S,data:L}=ce(w("crvusd"),b(()=>l.chain),s),{isFetching:W,data:O}=de(w("crvusd"),b(()=>l.chain),s);return(T,F)=>(h(),R("div",He,[o(e(ue),{overview:e(m),loading:e(u)},null,8,["overview","loading"]),o(e(me),{ratios:e(_),"prices-oracle":e(r),loading:e(p)||e(n)},null,8,["ratios","prices-oracle","loading"]),o(e(_e),{losses:e(O),loading:e(W)},null,8,["losses","loading"]),o(e(pe),{losses:e(O),loading:e(W)},null,8,["losses","loading"]),o(e(ve),{deciles:e(L),loading:e(S)},null,8,["deciles","loading"]),o(e(he),{ratios:e(i),loading:e(n)},null,8,["ratios","loading"]),o(e(ge),{liqs:e(k),loading:e(d)},null,8,["liqs","loading"]),o(e(fe),{liqs:e($),loading:e(c)},null,8,["liqs","loading"]),o(e(ke),{discounts:e(a),liqs:e($),loading:e(n)||e(c)},null,8,["discounts","liqs","loading"])]))}}),Ge=A(je,[["__scopeId","data-v-6ad4864c"]]),Ke=["href"],ze={key:1},Je=C({__name:"Addresses",props:{market:{}},setup(l){const s=f(()=>{var n,t,r;return[{description:"Controller",address:(n=l.market)==null?void 0:n.address},{description:"Factory",address:(t=l.market)==null?void 0:t.factoryAddress},{description:"Llamma",address:(r=l.market)==null?void 0:r.llamma}]}),u=n=>`https://etherscan.io/address/${n}`,m=async n=>{await navigator.clipboard.writeText(n)};return(n,t)=>{const r=z,a=H,i=K,p=V;return h(),y(p,{class:"addresses",title:"Addresses"},{default:v(()=>[o(i,{class:"addresses-table",rows:e(s)},{row:v(({item:{description:_,address:d}})=>[g("div",null,q(_),1),g("div",null,[d?(h(),R("a",{key:0,class:"font-mono",target:"_blank",href:u(d)},q(d),9,Ke)):(h(),R("span",ze,"?"))]),g("div",null,[d?(h(),y(a,{key:0,onClick:k=>m(d)},{default:v(()=>[o(r)]),_:2},1032,["onClick"])):B("",!0)])]),_:1},8,["rows"])]),_:1})}}}),Xe=A(Je,[["__scopeId","data-v-2bb26947"]]),Ye={class:"token-info"},Ze=["href"],xe={class:"token-info"},ea=["href"],aa=C({__name:"Properties",props:{market:{},chain:{}},setup(l){const s=f(()=>{var t,r,a,i;return{type:"token",symbol:((r=(t=l.market)==null?void 0:t.collateralToken)==null?void 0:r.symbol)??"?",address:((i=(a=l.market)==null?void 0:a.collateralToken)==null?void 0:i.address)??"?"}}),u=f(()=>{var t,r,a,i;return{type:"token",symbol:((r=(t=l.market)==null?void 0:t.stablecoinToken)==null?void 0:r.symbol)??"?",address:((i=(a=l.market)==null?void 0:a.stablecoinToken)==null?void 0:i.address)??"?"}}),m=t=>`https://etherscan.io/address/${t}`,n=async t=>{await navigator.clipboard.writeText(t)};return(t,r)=>{const a=Ve,i=z,p=H,_=Re,d=K,k=V;return h(),y(k,{class:"properties",title:"Properties"},{default:v(()=>[o(d,{class:"properties-table"},{default:v(()=>[o(_,null,{default:v(()=>[r[2]||(r[2]=g("div",null,"Collateral",-1)),g("div",Ye,[o(a,{chain:t.chain,address:e(s).address},null,8,["chain","address"]),g("div",null,q(e(s).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:m(e(s).address)},q(e(s).address),9,Ze)]),g("div",null,[o(p,{onClick:r[0]||(r[0]=c=>n(e(s).address))},{default:v(()=>[o(i)]),_:1})])])]),_:1,__:[2]}),o(_,null,{default:v(()=>[r[3]||(r[3]=g("div",null,"Borrowed",-1)),g("div",xe,[o(a,{chain:t.chain,address:e(u).address},null,8,["chain","address"]),g("div",null,q(e(u).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:m(e(u).address)},q(e(u).address),9,ea)]),g("div",null,[o(p,{onClick:r[1]||(r[1]=c=>n(e(u).address))},{default:v(()=>[o(i)]),_:1})])])]),_:1,__:[3]})]),_:1})]),_:1})}}}),ta=A(aa,[["__scopeId","data-v-61c51caa"]]),sa={class:"dashboard-grid"},na=C({__name:"MarketOverview",props:{market:{},chain:{}},setup(l){return(s,u)=>{const m=Se,n=Ae;return h(),R("div",sa,[o(n,{style:{"grid-area":"kpi1"},label:"Borrow Rate","has-value":!!s.market},{default:v(()=>{var t;return[o(m,{type:"percentage",value:100*(((t=s.market)==null?void 0:t.rate)??0)},null,8,["value"])]}),_:1},8,["has-value"]),o(n,{style:{"grid-area":"kpi2"},label:"Borrowed","has-value":!!s.market},{default:v(()=>{var t;return[o(m,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowed},null,8,["value"])]}),_:1},8,["has-value"]),o(n,{style:{"grid-area":"kpi3"},label:"Borrowable","has-value":!!s.market},{default:v(()=>{var t;return[o(m,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowable},null,8,["value"])]}),_:1},8,["has-value"]),o(n,{style:{"grid-area":"kpi4"},label:"Loans","has-value":!!s.market},{default:v(()=>{var t;return[x(q(((t=s.market)==null?void 0:t.loans)??0),1)]}),_:1},8,["has-value"]),o(e(Ee),{style:{"grid-area":"rates"},market:s.market},null,8,["market"]),o(e(Ie),{style:{"grid-area":"cap"},market:s.market},null,8,["market"]),o(e(Qe),{style:{"grid-area":"loans"},market:s.market},null,8,["market"]),o(e(Ue),{style:{"grid-area":"volume"},market:s.market,chain:s.chain},null,8,["market","chain"]),o(e(ta),{style:{"grid-area":"properties"},market:s.market,chain:s.chain},null,8,["market","chain"]),o(e(Xe),{style:{"grid-area":"addresses"},market:s.market,chain:s.chain},null,8,["market","chain"])])}}}),oa=A(na,[["__scopeId","data-v-efc50c6b"]]),ra={class:"dashboard-grid"},ia=C({__name:"Trading",props:{market:{},chain:{}},setup(l){const s=f(()=>{var _;return(_=l.market)==null?void 0:_.llamma}),{isFetching:u,data:m}=j("crvusd",s,b(()=>l.chain)),n=w(1),{isFetching:t,data:r}=be("crvusd",s,b(()=>l.chain),n),a=w(1),{isFetching:i,data:p}=ye("crvusd",s,b(()=>l.chain),a);return(_,d)=>{var k,c,$,S;return h(),R("div",ra,[o(e($e),{style:{"grid-area":"ohlc"},ohlc:e(m)??[],loading:e(u)},null,8,["ohlc","loading"]),o(e(Ce),{style:{"grid-area":"trades"},trades:((k=e(r))==null?void 0:k.trades)??[],count:((c=e(r))==null?void 0:c.count)??0,chain:_.chain,loading:e(t),onPage:d[0]||(d[0]=L=>n.value=L)},null,8,["trades","count","chain","loading"]),o(e(Te),{style:{"grid-area":"events"},events:(($=e(p))==null?void 0:$.events)??[],count:((S=e(p))==null?void 0:S.count)??0,loading:e(i),onPage:d[1]||(d[1]=L=>a.value=L)},null,8,["events","count","loading"])])}}}),la=A(ia,[["__scopeId","data-v-13550918"]]),ca={class:"dashboard"},da=C({__name:"Market.page",setup(l){const s=Be("marketAddr"),{isFetching:u,data:m}=ne(),n=f(()=>m.value.find(i=>i.address===s.value)),{crumbs:t}=ee(ae());te(n,i=>{t.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:`Market: ${(i==null?void 0:i.name)??"?"}`}]},{immediate:!0});const{tabActive:r,tabActiveIndex:a}=Oe(["overview","trading","liquidations"],"crvusdmarket",()=>({marketAddr:s.value}));return(i,p)=>{const _=se,d=X,k=Y;return h(),R("div",ca,[o(_,{loading:e(u)},null,8,["loading"]),!e(u)&&e(n)?(h(),y(k,{key:0,active:e(a),onTab:p[0]||(p[0]=c=>a.value=c.index)},{default:v(()=>[o(d,{header:"Overview"},{default:v(()=>[(h(),y(E,null,[e(r)==="overview"?(h(),y(oa,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),o(d,{header:"Trading"},{default:v(()=>[(h(),y(E,null,[e(r)==="trading"?(h(),y(la,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),o(d,{header:"Liquidations"},{default:v(()=>[(h(),y(E,null,[e(r)==="liquidations"?(h(),y(Ge,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1})]),_:1},8,["active"])):B("",!0)])}}}),Ia=A(da,[["__scopeId","data-v-3ac83fbe"]]);export{Ia as default};

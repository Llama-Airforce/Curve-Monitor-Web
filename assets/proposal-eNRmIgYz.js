import{q as m,O as b,u as p,f as d,ay as _,H as q,r as v,ah as $,aj as C,a9 as I}from"./index-D82onfKO.js";import{e as P,b as w,i as j,d as F,j as D}from"./getAction-D1enAJ2z.js";import{u as i}from"./useQuery-GdPs83pA.js";import{t as g,f as l,g as y,F as k}from"./timestamp-DkvXAN4c.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=m("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=m("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);async function W(t,e){const{abi:r,address:a,args:o,functionName:s,...c}=e,n=P({abi:r,args:o,functionName:s});try{const{data:u}=await w(t,j,"call")({...c,data:n,to:a});return F({abi:r,args:o,functionName:s,data:u||"0x"})}catch(u){throw D(u,{abi:r,address:a,args:o,docsPath:"/docs/contract/readContract",functionName:s})}}function K(t){return t.state.chainId}function O(t,e){const{onChange:r}=e;return t.subscribe(a=>a.chainId,r)}function f(t,e){if(e){const r=e(t);if(r===void 0&&b(t)||r!==void 0)return r}if(Array.isArray(t))return t.map(r=>f(r,e));if(typeof t=="object"&&N(t)){const r=Object.entries(t).map(([a,o])=>[a,f(o,e)]);return Object.fromEntries(r)}return t}function B(t){return f(t,e=>{if(b(e))return B(p(e))})}function N(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function X(t){const e=d(()=>({...p(t),queryKeyHashFn:_})),r=i(e);return r.queryKey=p(e).queryKey,r}function G(t={}){const e=q(t),r=v(K(e)),a=O(e,{onChange(o){r.value=o}});return $(()=>a()),C(r)}const h=t=>({timestamp:g(t.dt),id:t.vote_id,type:t.vote_type.toLocaleLowerCase()==="parameter"?"parameter":"ownership",metadata:t.metadata?.startsWith('"')?t.metadata.substring(1):t.metadata??"",proposer:t.creator,block:t.snapshot_block,start:t.start_date,end:t.start_date+604800,quorum:Number(BigInt(t.min_accept_quorum))/10**18,support:Number(BigInt(t.support_required))/10**18,voteCount:t.vote_count,votesFor:Number(BigInt(t.votes_for))/10**18,votesAgainst:Number(BigInt(t.votes_against))/10**18,executionTx:t.execution_tx,executionDate:t.execution_date?g(t.execution_date):null,executed:t.executed,totalSupply:Number(BigInt(t.total_supply))/10**18,txCreation:t.transaction_hash}),A=t=>({...h(t),txExecution:t.execution_tx?t.execution_tx:void 0,script:t.script,votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,votingPower:Number(BigInt(e.voting_power))/10**18,txHash:e.transaction_hash}))}),H=t=>({proposal:h(t.proposal),votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,weight:BigInt(Math.round(parseFloat(e.voting_power))),txHash:e.transaction_hash}))});async function E(t,e=10,r,a,o,s){const c=y(s),n=await l(`${c}/v1/dao/proposals?pagination=${e}&page=${t}&search_string=${r}&type_filter=${a}&status_filter=${o}`);return{proposals:n.proposals.map(h),count:n.count}}async function Q(t,e,r,a){const o=y(a),s=await l(`${o}/v1/dao/proposals/details/${e}/${t}`);return A(s)}async function U(t,e=1,r=100,a){try{const o=y(a);return(await l(`${o}/v1/dao/proposals/votes/user/${t}?pagination=${r}&page=${e}`)).data.map(H)}catch(o){if(o instanceof k)return[];throw o}}function L(){return{initialData:[],initialDataUpdatedAt:0}}function Y(t,e,r){return i({queryKey:["proposal",t,e],queryFn:({queryKey:[,a,o]})=>Q(a,o),...r&&{enabled:r}})}function Z(t,e,r,a){return i({queryKey:["proposals",t,a,e,r],queryFn:({queryKey:[,o,s,c,n]})=>E(o,void 0,s,c,n),placeholderData:I})}function x(t){return i({queryKey:["proposal-user-votes",d(()=>t.value)],queryFn:({queryKey:[,e]})=>U(e),enabled:d(()=>!!t.value),...L()})}export{J as C,T as X,X as a,x as b,Z as c,B as d,Y as e,W as r,G as u};

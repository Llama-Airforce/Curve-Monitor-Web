import{t as U,g as T,f as S,a as se}from"./timestamp-Dfir0V72.js";import{u as k}from"./useQuery-Ds_Sub25.js";import{f,a8 as N,d as C,T as O,U as oe,V as W,h as g,o as y,_ as $,w as p,a as d,b as h,u as _,r as Q,j as A,e as V,W as ie,t as w,Q as j,K as X,N as Y,i as K}from"./index-5B2tI7Zc.js";import{u as M,a as D,c as P}from"./UseLightweightChart-C1SS2I-H.js";import{_ as ne,a as le}from"./BtnChartLWFullscreen.vue_vue_type_script_setup_true_lang-B0dd4bO7.js";import{r as L,u as F}from"./Number-Bqyeu7gj.js";import{_ as G}from"./ButtonToggle-CmOxPJil.js";import{_ as I,a as re}from"./Table-Br42HHVv.js";import{c as z,_ as E}from"./ChartStylesApex-DiqR34V4.js";import{u as J,_ as Z}from"./UseLegend-ifWC3xyM.js";import{_ as x}from"./AsyncValue-BrxM0dB4.js";import{a as ee,_ as te}from"./UsePagination-Bav67_-y.js";import{u as ae}from"./UseRelativeTime-CazFgpUx.js";import{_ as ce}from"./TokenIcon-SHuc7s7h.js";const ue=e=>({provider:e.provider,deposit:e.deposit?{amount:e.deposit.amount,n1:e.deposit.n1,n2:e.deposit.n2}:null,withdrawal:e.withdrawal?{amountBorrowed:e.withdrawal.amount_borrowed,amountCollateral:e.withdrawal.amount_collateral}:null,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),de=e=>({idSold:e.sold_id,idBought:e.bought_id,tokenSold:{symbol:e.token_sold.symbol,address:e.token_sold.address},tokenBought:{symbol:e.token_bought.symbol,address:e.token_bought.address},amountSold:e.amount_sold,amountBought:e.amount_bought,price:e.price,buyer:e.buyer,feeX:e.fee_x,feeY:e.fee_y,blockNumber:e.block_number,timestamp:U(e.timestamp),txHash:e.transaction_hash}),me=e=>({time:U(e.time),open:e.open,close:e.close,high:e.high,low:e.low,basePrice:e.base_price,oraclePrice:e.oracle_price,volume:e.volume});async function pe({endpoint:e,chain:o,llamma:s,page:a=1,perPage:n=10},c){const i=T(c),t=new URLSearchParams({page:a.toString(),per_page:n.toString()}),l=await S(`${i}/v1/${e}/llamma_events/${o}/${s}??${t.toString()}`);return{events:l.data.map(ue),count:l.count}}async function _e({endpoint:e,chain:o,llamma:s,page:a=1,perPage:n=10},c){const i=T(c),t=new URLSearchParams({page:a.toString(),per_page:n.toString()}),l=await S(`${i}/v1/${e}/llamma_trades/${o}/${s}?${t.toString()}`);return{trades:l.data.map(de),count:l.count}}async function he({endpoint:e,chain:o,llamma:s,interval:a=1,units:n="hour",start:c,end:i},t){const l=T(t),r=se({start:c,end:i}),u=new URLSearchParams({agg_number:a.toString(),agg_units:n,start:r.start.toString(),end:r.end.toString()});return(await S(`${l}/v1/${e}/llamma_ohlc/${o}/${s}?${u.toString()}`)).data.map(me)}function kt(e,o,s,a){return k({queryKey:["llamma-market-events",o,a],queryFn:({queryKey:[,n,c]})=>pe({endpoint:e,chain:s.value,llamma:n,page:c}),placeholderData:N,enabled:f(()=>!!o.value&&!!s.value)})}function Dt(e,o,s,a){return k({queryKey:["llamma-market-trades",o,a],queryFn:({queryKey:[,n,c]})=>_e({endpoint:e,chain:s.value,llamma:n,page:c}),placeholderData:N,enabled:f(()=>!!o.value&&!!s.value)})}function Ut(e,o,s){return k({queryKey:["llamma-market-ohlc",o],queryFn:({queryKey:[,a]})=>he({endpoint:e,chain:s.value,llamma:a}),enabled:f(()=>!!o.value&&!!s.value)})}const ve={style:{display:"flex"}},fe={ref:"chartRef",class:"chart"},Vt=C({__name:"ChartCollateralRatio",props:{ratios:{}},setup(e){const o=O(),s=oe("card"),{chart:a,series:n}=M({createChartOptions:P(),series:{type:"Area",name:"ratios",options:f(()=>({priceFormat:{type:"custom",formatter:i=>`${L(i,0,"percentage")}%`,minMove:.1},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});W(c);function c(){if(!a.value||!n.ratios)return;const i=e.ratios.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.ratio*100})).uniqWith((t,l)=>t.time===l.time).orderBy(t=>t.time,"asc");i.length>0&&n.ratios.setData(i),a.value.timeScale().fitContent()}return(i,t)=>{const l=$;return y(),g(l,{ref_key:"card",ref:s,title:"Collateral Ratio"},{actions:p(()=>[d("div",ve,[h(_(ne),{filename:"collateral_ratio",series:_(n)},null,8,["series"]),h(_(le),{chart:_(a),target:_(s)},null,8,["chart","target"])])]),default:p(()=>[d("div",fe,null,512)]),_:1},512)}}}),be={class:"button-group"},Bt=C({__name:"ChartLiqs",props:{liqs:{}},setup(e){const o=Q("count"),s=a=>{o.value!==a&&(o.value=a)};return(a,n)=>{const c=G,i=$;return y(),g(i,{title:"Self & Hard Liquidations"},{actions:p(()=>[d("div",be,[h(c,{"model-value":_(o)==="count",onClick:n[0]||(n[0]=t=>s("count"))},{default:p(()=>n[2]||(n[2]=[A(" Count ")])),_:1},8,["model-value"]),h(c,{"model-value":_(o)==="value",onClick:n[1]||(n[1]=t=>s("value"))},{default:p(()=>n[3]||(n[3]=[A(" Value ")])),_:1},8,["model-value"])])]),default:p(()=>[_(o)==="count"?(y(),g(_(ye),{key:0,liqs:a.liqs},null,8,["liqs"])):(y(),g(_(Ce),{key:1,liqs:a.liqs},null,8,["liqs"]))]),_:1})}}}),ge=C({__name:"ChartLiqsCount",props:{liqs:{}},setup(e){const o=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:s.value,labels:{formatter:c,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:n.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),s=f(()=>e.liqs.orderBy(t=>t.timestamp.getTime(),"asc").groupBy(t=>t.timestamp.getTime()).entries().map(([t])=>new Date(parseInt(t,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((t,l)=>l%8===0?t:"")),a=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.selfCount}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.hardCount}))}]),n=f(()=>Math.max(...e.liqs.groupBy(t=>t.timestamp.getTime()).entries().map(([,t])=>t.reduce((l,r)=>l+r.selfCount+r.hardCount,0)))*1.1),c=t=>t,i=t=>`${L(t,1,"dollar")}${F(t)}`;return(t,l)=>{const r=E;return y(),g(r,{options:_(o),series:_(a)},null,8,["options","series"])}}}),ye=V(ge,[["__scopeId","data-v-4bc8078d"]]),qe=C({__name:"ChartLiqsValue",props:{liqs:{}},setup(e){const o=f(()=>z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:s.value,labels:{formatter:c,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:i},min:0,max:n.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),s=f(()=>e.liqs.orderBy(t=>t.timestamp.getTime(),"asc").groupBy(t=>t.timestamp.getTime()).entries().map(([t])=>new Date(parseInt(t,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((t,l)=>l%8===0?t:"")),a=f(()=>[{name:"Self liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.selfValue}))},{name:"Hard liquidations",data:Object.values(e.liqs).map(t=>({x:t.timestamp.toLocaleDateString(),y:t.hardValue}))}]),n=f(()=>Math.max(...e.liqs.groupBy(t=>t.timestamp.getTime()).entries().map(([,t])=>t.reduce((l,r)=>l+r.selfValue+r.hardValue,0)))*1.1),c=t=>t,i=t=>`${L(t,1,"dollar")}${F(t)}`;return(t,l)=>{const r=E;return y(),g(r,{options:_(o),series:_(a)},null,8,["options","series"])}}}),Ce=V(qe,[["__scopeId","data-v-ac62292c"]]),we={ref:"chartRef",class:"chart"},Ot=C({__name:"ChartLiqsMedianLoss",props:{losses:{}},setup(e){const o=O(),{chart:s,series:a}=M({createChartOptions:P(),series:{type:"Area",name:"losses",options:f(()=>({priceFormat:{type:"custom",formatter:c=>`${L(c,0,"percentage")}%`,minMove:.1},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});W(n);function n(){if(!s.value||!a.losses)return;const c=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.pctLossMedian})).uniqWith((i,t)=>i.time===t.time).orderBy(i=>i.time,"asc");c.length>0&&a.losses.setData(c),s.value.timeScale().fitContent()}return(c,i)=>{const t=$;return y(),g(t,{title:"Median Loss % Among Loans with Losses"},{default:p(()=>[d("div",we,null,512)]),_:1})}}}),$e={ref:"chartRef",class:"chart"},Wt=C({__name:"ChartLiqsLosersProportion",props:{losses:{}},setup(e){const o=O(),{chart:s,series:a}=M({createChartOptions:P(),series:{type:"Area",name:"losses",options:f(()=>({priceFormat:{type:"custom",formatter:c=>`${L(c,0,"percentage")}%`,minMove:.1},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});W(n);function n(){if(!s.value||!a.losses)return;const c=e.losses.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.numTotalUsers>0?100*i.numUsersWithLosses/i.numTotalUsers:0})).uniqWith((i,t)=>i.time===t.time).orderBy(i=>i.time,"asc");c.length>0&&a.losses.setData(c),s.value.timeScale().fitContent()}return(c,i)=>{const t=$;return y(),g(t,{title:"Proportion of Loans with Losses"},{default:p(()=>[d("div",$e,null,512)]),_:1})}}}),Mt=C({__name:"ChartLiqsHealthDeciles",props:{deciles:{}},setup(e){const o=f(()=>z({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1}},xaxis:{categories:s.value,labels:{formatter:n,rotate:-60},tickPlacement:"on"},yaxis:{labels:{formatter:c}},plotOptions:{bar:{columnWidth:"50%"}},legend:{show:!0},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:i=>{const t=i.series[0][i.dataPointIndex],l=i.series[1][i.dataPointIndex],r=i.series[2][i.dataPointIndex];return[`<div><b>Collat. (USD)</b>: ${c(l)}</div>`,`<div><b>Debt</b>: ${c(t)}</div>`,`<div><b>Stablecoin</b>: ${c(r)}</div>`].join("")}}})),s=f(()=>e.deciles.map(i=>i.decile)),a=f(()=>[{name:"Debt",data:Object.values(e.deciles).map(i=>i.debt)},{name:"Collateral",data:Object.values(e.deciles).map(i=>i.collateralUsdValue)},{name:"Stablecoin",data:Object.values(e.deciles).map(i=>i.stablecoin)}]),n=i=>i,c=i=>`$${L(i,0,"dollar")}${F(i)}`;return(i,t)=>{const l=E,r=$;return y(),g(r,{title:"Debt & Assets per Health Deciles"},{default:p(()=>[h(l,{options:_(o),series:_(a)},null,8,["options","series"])]),_:1})}}}),Le={ref:"chartRef",class:"chart"},Pt=C({__name:"ChartLiqsSoftLiqRatio",props:{ratios:{},pricesOracle:{}},setup(e){const o=O(),{items:s}=J(()=>[{id:"percentage",label:"% of loans in soft liquidation",color:o.value.colorsArray[0]},{id:"collateral-price",label:"Collateral price ($)",color:o.value.colorsArray[1]}]),{chart:a,series:n}=M({createChartOptions:P({leftPriceScale:{visible:!0}}),series:[{type:"Area",name:"price",options:f(()=>({priceFormat:{type:"custom",formatter:i=>`$${L(i,2,"dollar")}${F(i)}`},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.yellow,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Area",name:"ratio",options:f(()=>({priceFormat:{type:"custom",formatter:i=>`${L(i,0,"percentage")}%`},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.blue,priceScaleId:"left",topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}]});W(c);function c(){if(!a.value||!n.price||!n.ratio)return;const i=e.ratios.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.proportion})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc"),t=i.length>0?i[0].time:0,l=e.pricesOracle.filter(r=>r.timestamp.getUTCTimestamp()>=t).map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.priceOracle})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");l.length>0&&n.price.setData(l),i.length>0&&n.ratio.setData(i),a.value.timeScale().fitContent()}return(i,t)=>{const l=Z,r=$;return y(),g(r,{title:"Soft Liquidations Ratio"},{"actions-secondary":p(()=>[h(l,{items:_(s)},null,8,["items"])]),default:p(()=>[d("div",Le,null,512)]),_:1})}}}),Te={ref:"chartRef",class:"chart"},Rt=C({__name:"ChartLiquidatorRevenue",props:{discounts:{},liqs:{}},setup(e){const o=O(),{items:s}=J(()=>[{id:"revenue",label:"Liquidator Revenue",color:o.value.colorsArray[0]},{id:"discount",label:"Discount",color:o.value.colorsArray[1]}]),{chart:a,series:n}=M({createChartOptions:P({leftPriceScale:{visible:!0}}),series:[{type:"Area",name:"revenue",options:f(()=>({priceFormat:{type:"price",precision:0,minMove:1},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Area",name:"discount",options:f(()=>({priceFormat:{type:"percent",precision:6,minMove:1e-6},lineWidth:2,lineType:D.WithSteps,lineColor:o.value.colors.yellow,priceScaleId:"left",topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}]});W(c);function c(){if(!a.value||!n.discount||!n.revenue)return;const i=e.liqs.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.debt})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc").reduce((r,u)=>{const m=r.length>0?r[r.length-1].value:0;return r.push({time:u.time,value:u.value+m}),r},[]),t=i.length>0?i[0].time:0,l=e.discounts.filter(r=>r.timestamp.getUTCTimestamp()>=t).map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.discount*100})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");i.length>0&&n.revenue.setData(i),l.length>0&&n.discount.setData(l),a.value.timeScale().fitContent()}return(i,t)=>{const l=Z,r=$;return y(),g(r,{title:"Liquidator Revenue"},{"actions-secondary":p(()=>[h(l,{items:_(s)},null,8,["items"])]),default:p(()=>[d("div",Te,null,512)]),_:1})}}}),Se={class:"end"},ke={class:"end"},De={class:"end"},Ue={class:"end"},Ve={class:"end"},Be={class:"collateral end"},Oe={class:"end"},We=C({__name:"TableLiqOverview",props:{overview:{}},setup(e){const o=f(()=>{if(!e.overview)return 0;const s=e.overview.liqableDebtUsd,a=e.overview.liqableCollatUsd+e.overview.liqableBorrowedUsd,n=s-a;return n<=0?0:n});return(s,a)=>{const n=re,c=x,i=I,t=$;return y(),g(t,{title:"General Health Metrics"},{default:p(()=>[h(i,{class:"liq-overview-table"},{default:p(()=>[h(n,null,{default:p(()=>{var l;return[a[0]||(a[0]=d("div",null,"Users in soft liquidation",-1)),d("div",Se,w(((l=s.overview)==null?void 0:l.softLiqUsers)??0),1)]}),_:1}),h(n,null,{default:p(()=>{var l;return[a[1]||(a[1]=d("div",null,"Median health",-1)),d("div",ke,[h(c,{"show-zero":"",type:"percentage",value:((l=s.overview)==null?void 0:l.medianHealth)??0},null,8,["value"])])]}),_:1}),h(n,null,{default:p(()=>{var l;return[a[2]||(a[2]=d("div",null,"Collaterization ratio",-1)),d("div",De,[h(c,{"show-zero":"",type:"percentage",value:((l=s.overview)==null?void 0:l.collatRatio)??0},null,8,["value"])])]}),_:1}),h(n,null,{default:p(()=>{var l;return[a[3]||(a[3]=d("div",null,"Liquidatable positions",-1)),d("div",Ue,w(((l=s.overview)==null?void 0:l.liqablePositions)??0),1)]}),_:1}),h(n,null,{default:p(()=>{var l;return[a[4]||(a[4]=d("div",null,"Liquidatable positions' debt",-1)),d("div",Ve,[h(c,{"show-zero":"",type:"dollar",value:((l=s.overview)==null?void 0:l.liqableDebtUsd)??0},null,8,["value"])])]}),_:1}),h(n,null,{default:p(()=>{var l,r;return[a[6]||(a[6]=d("div",null,"Liquidatable collateral (token / crvUSD)",-1)),d("div",Be,[h(c,{"show-zero":"",type:"dollar",value:((l=s.overview)==null?void 0:l.liqableCollatUsd)??0},null,8,["value"]),a[5]||(a[5]=A(" / ")),h(c,{"show-zero":"",type:"dollar",value:((r=s.overview)==null?void 0:r.liqableBorrowedUsd)??0},null,8,["value"])])]}),_:1}),_(o)>0?(y(),g(n,{key:0},{default:p(()=>[a[7]||(a[7]=d("div",null,"Bad debt",-1)),d("div",Oe,[h(c,{"show-zero":"",class:"red",type:"dollar",value:_(o)},null,8,["value"])])]),_:1})):ie("",!0)]),_:1})]),_:1})}}}),At=V(We,[["__scopeId","data-v-472ed839"]]),Me={class:"address"},Pe=["href"],Re={class:"end"},Ae={class:"end"},Fe=C({__name:"TableTopLiquidators",props:{liqs:{}},setup(e){const o=f(()=>e.liqs.groupBy(s=>s.liquidator).entries().map(([s,a])=>({liquidator:s,count:a.length,value:a.reduce((n,c)=>n+c.collateralReceivedUsd,0)})).orderBy(s=>s.value,"desc").take(5));return(s,a)=>{const n=x,c=I,i=$;return y(),g(i,{title:"Top Liquidators"},{default:p(()=>[h(c,{class:"liquidators-table",rows:_(o),columns:["Address",{label:"Count",align:"end"},{label:"Value",align:"end"}]},{row:p(({item:t})=>[d("div",Me,[d("a",{target:"_blank",href:`https://etherscan.io/address/${t.liquidator}`},w(("addressShort"in s?s.addressShort:_(j))(t.liquidator,8)),9,Pe)]),d("div",Re,[h(n,{"show-zero":"",value:t.count,precision:0},null,8,["value"])]),d("div",Ae,[h(n,{type:"dollar",value:t.value,precision:1},null,8,["value"])])]),_:1},8,["rows"])]),_:1})}}}),Ft=V(Fe,[["__scopeId","data-v-31325472"]]),He=e=>({timestamp:U(e.timestamp),proportion:e.proportion/100}),Ke=e=>({timestamp:U(e.dt),user:e.user,liquidator:e.liquidator,self:e.self,collateralReceived:e.collateral_received,collateralReceivedUsd:e.collateral_received_usd,stablecoinReceived:e.stablecoin_received,priceOracle:e.oracle_price,debt:e.debt,n1:e.n1,n2:e.n2,tx:e.tx,block:e.block}),Ie=e=>({timestamp:U(e.timestamp),selfCount:e.self_count,hardCount:e.hard_count,selfValue:e.self_value,hardValue:e.hard_value,price:e.price}),Qe=e=>({softLiqUsers:e.soft_liquidation_users,liqablePositions:e.liquidatable_positions,liqableDebtUsd:e.liquidatable_pos_debt_usd,liqableCollatUsd:e.liquidatable_collateral_usd,liqableBorrowedUsd:e.liquidatable_borrowed_usd,medianHealth:e.median_health,avgHealth:e.average_health,collatRatio:e.collat_ratio}),je=e=>({timestamp:U(e.timestamp),pctLossAverage:e.avg_pct_loss,pctLossMedian:e.median_pct_loss,absoluteLossAverage:e.avg_abs_loss,absoluteLossMedian:e.median_abs_loss,numTotalUsers:e.total_users,numUsersWithLosses:e.users_with_losses,ratio:e.ratio}),ze=e=>({decile:e.health_decile,collateralUsdValue:e.collateral,debt:e.debt,stablecoin:e.stablecoin});async function Ee(e,o,s,a){const n=T(a);return(await S(`${n}/v1/${e}/liquidations/${o}/${s}/soft_liquidation_ratio`)).data.map(He)}async function Ne(e,o,s,a){const n=T(a);return(await S(`${n}/v1/${e}/liquidations/${o}/${s}/history/detailed`)).data.map(Ke)}async function Xe(e,o,s,a){const n=T(a);return(await S(`${n}/v1/${e}/liquidations/${o}/${s}/history/aggregated`)).data.map(Ie)}async function Ye(e,o,s,a){const n=T(a),c=await S(`${n}/v1/${e}/liquidations/${o}/${s}/overview?fetch_on_chain=true`);return Qe(c)}async function Ge(e,o,s,a){const n=T(a);return(await S(`${n}/v1/${e}/liquidations/${o}/${s}/losses/history`)).data.map(je)}async function Je(e,o,s,a){const n=T(a);return(await S(`${n}/v1/${e}/liquidations/${o}/${s}/health/distribution`)).data.map(ze)}function H(){return{initialData:[],initialDataUpdatedAt:0}}function R(e,o){return{enabled:f(()=>!!e.value&&(o?!!o.value:!0))}}function Ht(e,o,s){return k({queryKey:["liqs-soft-liqs",s],queryFn:({queryKey:[,a]})=>Ee(e.value,o.value,a),...R(s,o),...H()})}function Kt(e,o,s){return k({queryKey:["liqs-detailed",s],queryFn:({queryKey:[,a]})=>Ne(e.value,o.value,a),...R(s,o),...H()})}function It(e,o,s){return k({queryKey:["liqs-aggregate",s],queryFn:({queryKey:[,a]})=>Xe(e.value,o.value,a),...R(s,o),...H()})}function Qt(e,o,s){return k({queryKey:["liqs-overview",s],queryFn:({queryKey:[,a]})=>Ye(e.value,o.value,a),...R(s,o)})}function jt(e,o,s){return k({queryKey:["liqs-losses",s],queryFn:({queryKey:[,a]})=>Ge(e.value,o.value,a),...R(s,o),...H()})}function zt(e,o,s){return k({queryKey:["liqs-health-deciles",s],queryFn:({queryKey:[,a]})=>Je(e.value,o.value,a),...R(s,o),...H()})}const Ze={class:"controls"},xe={ref:"chartRef",class:"chart"},et=C({__name:"ChartOHLC",props:{ohlc:{}},setup(e){const o=O(),s=Q(!1),a=Q(!1);let n=1,c=0;const{chart:i,series:t}=M({createChartOptions:P({localization:{priceFormatter:u=>r(u)}}),series:[{type:"Candlestick",name:"ohlc",options:f(()=>{const{colors:u}=o.value;return{priceFormat:{type:"price",precision:6,minMove:1e-6},upColor:u.green,borderUpColor:u.green,wickUpColor:u.green,downColor:u.red,borderDownColor:u.red,wickDownColor:u.red}})},{type:"Line",name:"oracle",options:f(()=>({priceFormat:{type:"price",precision:6,minMove:1e-6},lineWidth:2,lineType:D.WithSteps,color:o.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}]});W(l);function l(){if(!i.value||!t.ohlc||!t.oracle)return;const u=s.value?-1:1,m=e.ohlc.map(v=>({time:v.time.getUTCTimestamp(),open:Math.pow(v.open,u),high:Math.pow(v.high,u),low:Math.pow(v.low,u),close:Math.pow(v.close,u)})).uniqWith((v,b)=>v.time===b.time).orderBy(v=>v.time,"asc");m.length>0&&(t.ohlc.setData(m),c=Math.min(...m.map(v=>v.low)),n=Math.max(...m.map(v=>v.high)));const q=e.ohlc.map(v=>({time:v.time.getUTCTimestamp(),value:Math.pow(v.oraclePrice,u)})).uniqWith((v,b)=>v.time===b.time).orderBy(v=>v.time,"asc");q.length>0&&t.oracle.setData(q),t.oracle.applyOptions({visible:a.value}),i.value.timeScale().fitContent()}function r(u){const m=n-c,q=m>1?m-Math.floor(m):m,v=-Math.floor(Math.log10(q)+1)+2;return`${L(u,v,"dollar")}${F(u)}`}return(u,m)=>{const q=G,v=$;return y(),g(v,{title:"Price"},{actions:p(()=>[d("div",Ze,[h(q,{"model-value":_(a),onClick:m[0]||(m[0]=b=>a.value=!_(a))},{default:p(()=>m[2]||(m[2]=[A(" Oracle Price ")])),_:1},8,["model-value"]),h(q,{"model-value":_(s),onClick:m[1]||(m[1]=b=>s.value=!_(s))},{default:p(()=>m[3]||(m[3]=[A(" Invert ")])),_:1},8,["model-value"])])]),default:p(()=>[d("div",xe,null,512)]),_:1})}}}),Et=V(et,[["__scopeId","data-v-ccf3db4c"]]),tt={class:"end"},at=["href"],st={class:"end"},ot=["href"],it=C({__name:"TableEvents",props:{events:{},count:{}},emits:["page"],setup(e,{emit:o}){const s=o,{page:a,onPage:n}=ee(),c=X(a,200);Y(c,u=>{s("page",u)});const{relativeTime:i}=ae(),t=u=>u<1?u.toFixed(4):u>1e3?u.toFixed(0):u.toFixed(2),l=u=>{var m,q;return t(((m=u.deposit)==null?void 0:m.amount)??((q=u.withdrawal)==null?void 0:q.amountCollateral)??0)},r=u=>u.deposit?"Deposit":u.withdrawal?"Withdrawal":"Unknown";return(u,m)=>{const q=te,v=I,b=$;return y(),g(b,{title:"Events"},{actions:p(()=>[h(q,{"items-count":u.count,"items-per-page":10,page:_(a),onPage:_(n)},null,8,["items-count","page","onPage"])]),default:p(()=>[h(v,{class:"events-table",rows:u.events,columns:["Type",{label:"Amount",align:"end"},"","Provider",{label:"Time",align:"end"}]},{row:p(({item:B})=>[d("div",null,w(r(B)),1),d("div",tt,w(l(B)),1),m[2]||(m[2]=d("div",null,null,-1)),d("div",null,[d("a",{target:"_blank",href:`https://etherscan.io/address/${B.provider}`,onClick:m[0]||(m[0]=K(()=>{},["stop"]))},w(("addressShort"in u?u.addressShort:_(j))(B.provider)),9,at)]),d("div",st,[d("a",{target:"_blank",href:`https://etherscan.io/tx/${B.txHash}`,onClick:m[1]||(m[1]=K(()=>{},["stop"]))},w(_(i)(B.timestamp.getUTCTimestamp())),9,ot)])]),_:1},8,["rows"])]),_:1})}}}),Nt=V(it,[["__scopeId","data-v-7ae8399c"]]),nt={class:"end"},lt=["href"],rt={class:"end"},ct=["href"],ut=["href"],dt={class:"end"},mt=["href"],pt=C({__name:"TableTrades",props:{trades:{},count:{},chain:{}},emits:["page"],setup(e,{emit:o}){const s=o,{page:a,onPage:n}=ee(),c=X(a,200);Y(c,l=>{s("page",l)});const{relativeTime:i}=ae(),t=l=>l<1?l.toFixed(4):l>1e3?l.toFixed(0):l.toFixed(2);return(l,r)=>{const u=te,m=ce,q=I,v=$;return y(),g(v,{title:"Trades"},{actions:p(()=>[h(u,{"items-count":l.count,"items-per-page":10,page:_(a),onPage:_(n)},null,8,["items-count","page","onPage"])]),default:p(()=>[h(q,{class:"trades-table",rows:l.trades,columns:[{label:"Bought",align:"end"},"","",{label:"Sold",align:"end"},"","","Market Maker",{label:"Time",align:"end"}]},{row:p(({item:b})=>[d("div",nt,w(t(b.amountBought)),1),h(m,{chain:l.chain,address:b.tokenBought.address},null,8,["chain","address"]),d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${b.tokenBought.address}`},w(b.tokenBought.symbol),9,lt)]),d("div",rt,w(t(b.amountSold)),1),h(m,{chain:l.chain,address:b.tokenSold.address},null,8,["chain","address"]),d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${b.tokenSold.address}`},w(b.tokenSold.symbol),9,ct)]),d("div",null,[d("a",{target:"_blank",href:`https://etherscan.io/address/${b.buyer}`,onClick:r[0]||(r[0]=K(()=>{},["stop"]))},w(("addressShort"in l?l.addressShort:_(j))(b.buyer)),9,ut)]),d("div",dt,[d("a",{target:"_blank",href:`https://etherscan.io/tx/${b.txHash}`,onClick:r[1]||(r[1]=K(()=>{},["stop"]))},w(_(i)(b.timestamp.getUTCTimestamp())),9,mt)])]),_:1},8,["rows"])]),_:1})}}}),Xt=V(pt,[["__scopeId","data-v-6212d8d5"]]);export{Et as C,At as T,Pt as _,Qt as a,Ht as b,It as c,Kt as d,zt as e,jt as f,Ot as g,Wt as h,Mt as i,Vt as j,Bt as k,Ft as l,Rt as m,Dt as n,kt as o,Xt as p,Nt as q,Ut as u};

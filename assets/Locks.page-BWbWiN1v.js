import{_ as X}from"./KPI-BOHntknC.js";import{_ as F}from"./AsyncValue-DBs1jcjK.js";import{a as I,b as G,c as H}from"./dao-B-RTVAhv.js";import{d as $,r as M,f as g,T as O,U,V as q,h as B,o as w,w as r,a as c,b as s,u as a,j as h,_ as N,e as D,$ as Y,i as Z,t as W,X as ee,c as te}from"./index-CmdpEOf2.js";import{u as oe,_ as ae}from"./UseLegend-4fuqFmSa.js";import{_ as A}from"./ButtonToggle-wXeqXCFQ.js";import{u as E,J as R,a as x,_ as Q,b as J,y as se}from"./UseLightweightChart-D9Dl3EjI.js";import{r as L,u as V}from"./Number-D99EWjzz.js";import{_ as j}from"./Table-DY_kBkCZ.js";import{_ as le}from"./IconExpander-6DR_JouC.js";import{u as z}from"./UseSort-D-ddrWJN.js";import"./timestamp-DkvXAN4c.js";import"./useQuery-BSLRV5Ma.js";import"./Object-DOSYkgA0.js";const ne={style:{display:"flex"}},re={class:"actions-secondary"},ie={class:"button-group"},ue={ref:"chartRef",class:"chart"},ce=$({__name:"ChartSupply",setup(T){const l=M("1m"),b=g(()=>{switch(l.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:y,data:p}=I(b),d=O(),{items:f,toggles:n,disabled:m}=oe(()=>{const{blue:e,yellow:o,purple:v}=d.value.colors;return[{id:"crv",label:"CRV",color:e,togglable:!0},{id:"circ",label:"Circulating",color:o,togglable:!0},{id:"vecrv",label:"veCRV",color:v,togglable:!0}]});n.circ.value=!1,n.crv.value=!1;const u=U("card"),{chart:i,series:t}=E({createChartOptions:x(),series:[{type:R,name:"crv",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"circ",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"vecrv",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.purple,lastValueVisible:!1,priceLineVisible:!1}))}]});q(_);function _(){!i.value||!t.crv||!t.circ||!t.vecrv||(t.crv.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.crvSupply)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.circ.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.circulatingSupply)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.vecrv.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.veCrvTotal)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.crv.applyOptions({visible:n.crv.value}),t.circ.applyOptions({visible:n.circ.value}),t.vecrv.applyOptions({visible:n.vecrv.value}),i.value.timeScale().fitContent())}return(e,o)=>{const v=Q,C=J,S=A,K=ae,P=N;return w(),B(P,{ref_key:"card",ref:u,title:"Token Supply",class:"stack-actions",loading:a(y)},{actions:r(()=>[c("div",ne,[s(v,{filename:"token_supply",series:a(t)},null,8,["series"]),s(C,{chart:a(i),target:a(u)},null,8,["chart","target"])])]),"actions-secondary":r(()=>[c("div",re,[c("div",ie,[s(S,{"model-value":a(l)==="1m",onClick:o[0]||(o[0]=k=>l.value="1m")},{default:r(()=>o[5]||(o[5]=[h(" 1m ")])),_:1,__:[5]},8,["model-value"]),s(S,{"model-value":a(l)==="3m",onClick:o[1]||(o[1]=k=>l.value="3m")},{default:r(()=>o[6]||(o[6]=[h(" 3m ")])),_:1,__:[6]},8,["model-value"]),s(S,{"model-value":a(l)==="6m",onClick:o[2]||(o[2]=k=>l.value="6m")},{default:r(()=>o[7]||(o[7]=[h(" 6m ")])),_:1,__:[7]},8,["model-value"]),s(S,{"model-value":a(l)==="1y",onClick:o[3]||(o[3]=k=>l.value="1y")},{default:r(()=>o[8]||(o[8]=[h(" 1y ")])),_:1,__:[8]},8,["model-value"])]),s(K,{items:a(f),disabled:a(m),onToggle:o[4]||(o[4]=k=>a(n)[k].value=!a(n)[k].value)},null,8,["items","disabled"])])]),default:r(()=>[c("div",ue,null,512)]),_:1},8,["loading"])}}}),me=D(ce,[["__scopeId","data-v-d7698cd4"]]),pe={style:{display:"flex"}},de={class:"button-group"},ve={ref:"chartRef",class:"chart"},_e=$({__name:"ChartSupplyDelta",setup(T){const l=M("1m"),b=g(()=>{switch(l.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:y,data:p}=I(b),d=O(),f=U("card"),{chart:n,series:m}=E({createChartOptions:x(),series:{type:se,name:"deltas",options:g(()=>({priceFormat:{type:"custom",formatter:i=>`${L(i,0,"dollar")}${V(i)}`,minMove:.01},color:d.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}});q(u);function u(){if(!n.value||!m.deltas)return;const{colors:i}=d.value;m.deltas.setData(p.value.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.veCrvTotal})).uniqWith((t,_)=>t.time===_.time).orderBy(t=>t.time,"asc").reduce((t,_,e,o)=>{if(e===0)return t;const v=_.value-o[e-1].value,C=v<0?i.red:i.green;return t.push({time:_.time,value:Number(v)/10**18,color:C}),t},[])),n.value.timeScale().fitContent()}return(i,t)=>{const _=Q,e=J,o=A,v=N;return w(),B(v,{ref_key:"card",ref:f,title:"veCRV Change",loading:a(y)},{actions:r(()=>[c("div",pe,[s(_,{filename:"distributions_delta",series:a(m)},null,8,["series"]),s(e,{chart:a(n),target:a(f)},null,8,["chart","target"])])]),"actions-secondary":r(()=>[c("div",de,[s(o,{"model-value":a(l)==="1m",onClick:t[0]||(t[0]=C=>l.value="1m")},{default:r(()=>t[4]||(t[4]=[h(" 1m ")])),_:1,__:[4]},8,["model-value"]),s(o,{"model-value":a(l)==="3m",onClick:t[1]||(t[1]=C=>l.value="3m")},{default:r(()=>t[5]||(t[5]=[h(" 3m ")])),_:1,__:[5]},8,["model-value"]),s(o,{"model-value":a(l)==="6m",onClick:t[2]||(t[2]=C=>l.value="6m")},{default:r(()=>t[6]||(t[6]=[h(" 6m ")])),_:1,__:[6]},8,["model-value"]),s(o,{"model-value":a(l)==="1y",onClick:t[3]||(t[3]=C=>l.value="1y")},{default:r(()=>t[7]||(t[7]=[h(" 1y ")])),_:1,__:[7]},8,["model-value"])])]),default:r(()=>[c("div",ve,null,512)]),_:1},8,["loading"])}}}),ge=["href"],ye={class:"end"},fe={class:"end"},be={class:"end"},he=$({__name:"TableLockers",setup(T){const{isFetching:l,data:b}=G(),y=[{id:"locker",label:"Locker",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"ratio",label:"Ratio",sort:!0,align:"end"},{id:"unlock",label:"Unlock Date",sort:!0,align:"end"}],{sorting:p,onSort:d}=z("weight"),f=g(()=>b.value.orderBy(u=>{switch(p.value.column){case"weight":return Number(u.weight);case"ratio":return u.weightRatio;case"unlock":return u.unlockTime?.getTime()??0}},p.value.order)),n=Y();async function m(u){await n.push({name:"profile",params:{tab:"governance"},query:{user:u.user}})}return(u,i)=>{const t=F,_=le,e=j,o=N;return w(),B(o,{title:"Top Lockers",loading:a(l)},{default:r(()=>[s(e,{rows:a(f),columns:y,sorting:a(p),onSortColumn:a(d),onSelect:m},{row:r(({item:v})=>[c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${v.user}`,onClick:i[0]||(i[0]=Z(()=>{},["stop"]))},W(v.user),9,ge)]),c("div",ye,[s(t,{value:Number(v.weight)/10**18},null,8,["value"])]),c("div",fe,[s(t,{type:"percentage",value:v.weightRatio,precision:2},null,8,["value"])]),c("div",be,W(v.unlockTime?.toLocaleDateString()??"?"),1),s(_)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ce=D(he,[["__scopeId","data-v-16d8eb1a"]]),ke=$({__name:"TableLocks",setup(T){const{isFetching:l,data:b}=H(),y=[{id:"day",label:"Day",sort:!0},{id:"amount",label:"Amount",sort:!0,align:"end"}],{sorting:p,onSort:d}=z("day"),f=g(()=>b.value.orderBy(m=>{switch(p.value.column){case"day":return m.day.getTime();case"amount":return Number(m.amount)}},p.value.order));function n(m){return Math.round(Number(m.amount)/10**18)}return(m,u)=>{const i=F,t=j,_=N;return w(),B(_,{title:"Daily Lock Change",loading:a(l)},{default:r(()=>[s(t,{rows:a(f),columns:y,sorting:a(p),onSortColumn:a(d)},{row:r(({item:e})=>[c("div",null,W(e.day.toLocaleDateString()),1),c("div",{class:ee(["end",{positive:n(e)>0,negative:n(e)<0}])},[s(i,{value:n(e),precision:2},null,8,["value"])],2)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),$e=D(ke,[["__scopeId","data-v-3ae158f5"]]),we={class:"dashboard"},Te={class:"two-sides"},Se={style:{display:"flex",gap:"0.5ch"}},Le=$({__name:"Locks.page",setup(T){const{isFetching:l,data:b}=I(),y=g(()=>b.value.orderBy(n=>n.timestamp.getTime(),"desc")[0]??void 0),p=g(()=>Number(y.value?.veCrvTotal??0)/10**18),d=g(()=>Number(y.value?.crvSupply??0)/10**18),f=g(()=>Number(y.value?.circulatingSupply??0)/10**18);return(n,m)=>{const u=F,i=X;return w(),te("div",we,[s(i,{style:{"grid-area":"kpi1"},label:"veCRV Supply","has-value":!a(l)},{default:r(()=>[s(u,{type:"dollar",value:a(p),precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),s(i,{style:{"grid-area":"kpi2"},label:"CRV Supply / Circulating","has-value":!a(l)},{default:r(()=>[c("div",Te,[c("div",Se,[s(u,{type:"dollar",value:a(d),precision:2,"show-symbol":!1},null,8,["value"]),m[0]||(m[0]=c("span",{style:{color:"var(--c-lvl5)"}},"/",-1)),s(u,{type:"dollar",value:a(f),precision:2,"show-symbol":!1},null,8,["value"])]),s(u,{type:"percentage",value:100*a(f)/a(d),precision:2},null,8,["value"])])]),_:1},8,["has-value"]),s(me,{style:{"grid-area":"supply"}}),s(_e,{style:{"grid-area":"supply-delta"}}),s($e,{style:{"grid-area":"locks"}}),s(Ce,{style:{"grid-area":"lockers"}})])}}}),xe=D(Le,[["__scopeId","data-v-85843182"]]);export{xe as default};

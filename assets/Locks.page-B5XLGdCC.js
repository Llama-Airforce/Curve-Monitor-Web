import{_ as P}from"./KPI-gvg_QKrq.js";import{_ as W}from"./AsyncValue-CbYy8a0C.js";import{a as F,b as X,c as G}from"./dao-C2wuc6Ux.js";import{d as $,r as I,f,T as M,U as O,V as U,h as B,o as S,w as u,a as p,b as l,u as t,j as k,_ as N,e as D,$ as J,i as Y,t as R,X as Z,c as ee}from"./index-CJ72FfhI.js";import{u as te,_ as oe}from"./UseLegend-CQvswvHT.js";import{_ as q}from"./ButtonToggle-De5nGt9z.js";import{u as A,a as E,_ as x,b as Q}from"./UseLightweightChart-L-GEj9vf.js";import{r as L,u as V}from"./Number-8faaTcbD.js";import{_ as j}from"./Table-De5pchPN.js";import{_ as ae}from"./IconExpander-CZwHvmJs.js";import{u as z}from"./UseSort-BJxoEjq9.js";import"./timestamp-Dfir0V72.js";import"./useQuery-kRkUkwUi.js";import"./Object-DOSYkgA0.js";const se={style:{display:"flex"}},le={class:"actions-secondary"},ne={class:"button-group"},re={ref:"chartRef",class:"chart"},ie=$({__name:"ChartSupply",setup(T){const r=I("1m"),h=f(()=>{switch(r.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:b,data:v}=F(h),g=M(),{items:C,toggles:s,disabled:d}=te(()=>{const{blue:n,yellow:o,purple:_}=g.value.colors;return[{id:"crv",label:"CRV",color:n,togglable:!0},{id:"circ",label:"Circulating",color:o,togglable:!0},{id:"vecrv",label:"veCRV",color:_,togglable:!0}]});s.circ.value=!1,s.crv.value=!1;const m=O("card"),{chart:i,series:e}=A({createChartOptions:E(),series:[{type:"Line",name:"crv",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${L(n,2,"dollar")}${V(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"circ",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${L(n,2,"dollar")}${V(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"vecrv",options:f(()=>({priceFormat:{type:"custom",formatter:n=>`${L(n,2,"dollar")}${V(n)}`,minMove:.01},lineWidth:2,color:g.value.colors.purple,lastValueVisible:!1,priceLineVisible:!1}))}]});U(c);function c(){if(!i.value||!e.crv||!e.circ||!e.vecrv)return;const n=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.crvSupply)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc"),o=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.circulatingSupply)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc"),_=v.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:Number(a.veCrvTotal)/10**18})).uniqWith((a,y)=>a.time===y.time).orderBy(a=>a.time,"asc");e.crv.setData(n),e.circ.setData(o),e.vecrv.setData(_),e.crv.applyOptions({visible:s.crv.value}),e.circ.applyOptions({visible:s.circ.value}),e.vecrv.applyOptions({visible:s.vecrv.value}),i.value.timeScale().fitContent()}return(n,o)=>{const _=x,a=Q,y=q,H=oe,K=N;return S(),B(K,{ref_key:"card",ref:m,title:"Token Supply",class:"stack-actions",loading:t(b)},{actions:u(()=>[p("div",se,[l(_,{filename:"token_supply",series:t(e)},null,8,["series"]),l(a,{chart:t(i),target:t(m)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",le,[p("div",ne,[l(y,{"model-value":t(r)==="1m",onClick:o[0]||(o[0]=w=>r.value="1m")},{default:u(()=>o[5]||(o[5]=[k(" 1m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="3m",onClick:o[1]||(o[1]=w=>r.value="3m")},{default:u(()=>o[6]||(o[6]=[k(" 3m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="6m",onClick:o[2]||(o[2]=w=>r.value="6m")},{default:u(()=>o[7]||(o[7]=[k(" 6m ")])),_:1},8,["model-value"]),l(y,{"model-value":t(r)==="1y",onClick:o[3]||(o[3]=w=>r.value="1y")},{default:u(()=>o[8]||(o[8]=[k(" 1y ")])),_:1},8,["model-value"])]),l(H,{items:t(C),disabled:t(d),onToggle:o[4]||(o[4]=w=>t(s)[w].value=!t(s)[w].value)},null,8,["items","disabled"])])]),default:u(()=>[p("div",re,null,512)]),_:1},8,["loading"])}}}),ue=D(ie,[["__scopeId","data-v-0c7362d6"]]),ce={style:{display:"flex"}},me={class:"button-group"},pe={ref:"chartRef",class:"chart"},de=$({__name:"ChartSupplyDelta",setup(T){const r=I("1m"),h=f(()=>{switch(r.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:b,data:v}=F(h),g=M(),C=O("card"),{chart:s,series:d}=A({createChartOptions:E(),series:{type:"Histogram",name:"deltas",options:f(()=>({priceFormat:{type:"custom",formatter:i=>`${L(i,0,"dollar")}${V(i)}`,minMove:.01},color:g.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}});U(m);function m(){if(!s.value||!d.deltas)return;const{colors:i}=g.value,e=v.value.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.veCrvTotal})).uniqWith((c,n)=>c.time===n.time).orderBy(c=>c.time,"asc").reduce((c,n,o,_)=>{if(o===0)return c;const a=n.value-_[o-1].value,y=a<0?i.red:i.green;return c.push({time:n.time,value:Number(a)/10**18,color:y}),c},[]);e.length>0&&(d.deltas.setData(e),s.value.timeScale().fitContent())}return(i,e)=>{const c=x,n=Q,o=q,_=N;return S(),B(_,{ref_key:"card",ref:C,title:"veCRV Change",loading:t(b)},{actions:u(()=>[p("div",ce,[l(c,{filename:"distributions_delta",series:t(d)},null,8,["series"]),l(n,{chart:t(s),target:t(C)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[p("div",me,[l(o,{"model-value":t(r)==="1m",onClick:e[0]||(e[0]=a=>r.value="1m")},{default:u(()=>e[4]||(e[4]=[k(" 1m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="3m",onClick:e[1]||(e[1]=a=>r.value="3m")},{default:u(()=>e[5]||(e[5]=[k(" 3m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="6m",onClick:e[2]||(e[2]=a=>r.value="6m")},{default:u(()=>e[6]||(e[6]=[k(" 6m ")])),_:1},8,["model-value"]),l(o,{"model-value":t(r)==="1y",onClick:e[3]||(e[3]=a=>r.value="1y")},{default:u(()=>e[7]||(e[7]=[k(" 1y ")])),_:1},8,["model-value"])])]),default:u(()=>[p("div",pe,null,512)]),_:1},8,["loading"])}}}),ve=["href"],_e={class:"end"},ge={class:"end"},ye={class:"end"},fe=$({__name:"TableLockers",setup(T){const{isFetching:r,data:h}=X(),b=[{id:"locker",label:"Locker",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"ratio",label:"Ratio",sort:!0,align:"end"},{id:"unlock",label:"Unlock Date",sort:!0,align:"end"}],{sorting:v,onSort:g}=z("weight"),C=f(()=>h.value.orderBy(m=>{var i;switch(v.value.column){case"weight":return Number(m.weight);case"ratio":return m.weightRatio;case"unlock":return((i=m.unlockTime)==null?void 0:i.getTime())??0}},v.value.order)),s=J();async function d(m){await s.push({name:"profile",params:{tab:"governance"},query:{user:m.user}})}return(m,i)=>{const e=W,c=ae,n=j,o=N;return S(),B(o,{title:"Top Lockers",loading:t(r)},{default:u(()=>[l(n,{rows:t(C),columns:b,sorting:t(v),onSortColumn:t(g),onSelect:d},{row:u(({item:_})=>{var a;return[p("div",null,[p("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${_.user}`,onClick:i[0]||(i[0]=Y(()=>{},["stop"]))},R(_.user),9,ve)]),p("div",_e,[l(e,{value:Number(_.weight)/10**18},null,8,["value"])]),p("div",ge,[l(e,{type:"percentage",value:_.weightRatio,precision:2},null,8,["value"])]),p("div",ye,R(((a=_.unlockTime)==null?void 0:a.toLocaleDateString())??"?"),1),l(c)]}),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),be=D(fe,[["__scopeId","data-v-16d8eb1a"]]),Ce=$({__name:"TableLocks",setup(T){const{isFetching:r,data:h}=G(),b=[{id:"day",label:"Day",sort:!0},{id:"amount",label:"Amount",sort:!0,align:"end"}],{sorting:v,onSort:g}=z("day"),C=f(()=>h.value.orderBy(d=>{switch(v.value.column){case"day":return d.day.getTime();case"amount":return Number(d.amount)}},v.value.order));function s(d){return Math.round(Number(d.amount)/10**18)}return(d,m)=>{const i=W,e=j,c=N;return S(),B(c,{title:"Daily Lock Change",loading:t(r)},{default:u(()=>[l(e,{rows:t(C),columns:b,sorting:t(v),onSortColumn:t(g)},{row:u(({item:n})=>[p("div",null,R(n.day.toLocaleDateString()),1),p("div",{class:Z(["end",{positive:s(n)>0,negative:s(n)<0}])},[l(i,{value:s(n),precision:2},null,8,["value"])],2)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),he=D(Ce,[["__scopeId","data-v-3ae158f5"]]),ke={class:"dashboard"},we={class:"two-sides"},$e={style:{display:"flex",gap:"0.5ch"}},Se=$({__name:"Locks.page",setup(T){const{isFetching:r,data:h}=F(),b=f(()=>h.value.orderBy(s=>s.timestamp.getTime(),"desc")[0]??void 0),v=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.veCrvTotal)??0)/10**18}),g=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.crvSupply)??0)/10**18}),C=f(()=>{var s;return Number(((s=b.value)==null?void 0:s.circulatingSupply)??0)/10**18});return(s,d)=>{const m=W,i=P;return S(),ee("div",ke,[l(i,{style:{"grid-area":"kpi1"},label:"veCRV Supply","has-value":!t(r)},{default:u(()=>[l(m,{type:"dollar",value:t(v),precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),l(i,{style:{"grid-area":"kpi2"},label:"CRV Supply / Circulating","has-value":!t(r)},{default:u(()=>[p("div",we,[p("div",$e,[l(m,{type:"dollar",value:t(g),precision:2,"show-symbol":!1},null,8,["value"]),d[0]||(d[0]=p("span",{style:{color:"var(--c-lvl5)"}},"/",-1)),l(m,{type:"dollar",value:t(C),precision:2,"show-symbol":!1},null,8,["value"])]),l(m,{type:"percentage",value:100*t(C)/t(g),precision:2},null,8,["value"])])]),_:1},8,["has-value"]),l(ue,{style:{"grid-area":"supply"}}),l(de,{style:{"grid-area":"supply-delta"}}),l(he,{style:{"grid-area":"locks"}}),l(be,{style:{"grid-area":"lockers"}})])}}}),Ae=D(Se,[["__scopeId","data-v-85843182"]]);export{Ae as default};

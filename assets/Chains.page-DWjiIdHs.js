import{_ as oe}from"./KPI-DRB0vuVV.js";import{_ as le}from"./AsyncValue-DqxYCO4a.js";import{_ as re}from"./SelectChain-g_p5IF6P.js";import{a as ce,b as ue}from"./chains-BaMM2Xda.js";import{d as D,T as q,U as O,f as l,V,h as W,o as U,w as T,a as A,b as r,u as e,_ as z,e as I,r as ie,t as de,a4 as pe,c as me}from"./index-C4h5EpGr.js";import{u as N,c as Q,a as X,_ as Y,b as K}from"./UseLightweightChart-BUxLx6C5.js";import{r as P,u as E}from"./Number-AtrYJDP3.js";import{c as j,_ as G}from"./ChartStylesApex-DiGd2UZL.js";import{u as H,_ as J}from"./UseLegend-DN2d1t3L.js";import{c as Z}from"./String-TwmdtJxb.js";import{a as M}from"./index-BF3OLDG4.js";import"./ChainIcon-B_Dubh8-.js";import"./timestamp-BfMWSCVv.js";import"./useQuery-DTta5F3P.js";import"./Object-DOSYkgA0.js";const _e=["crvusd","lending","pools","router","dao"],ve={style:{display:"flex"}},he={ref:"chartRef",class:"chart"},fe=D({__name:"ChartTxs",props:{txs:{}},setup(g){const x=q(),c=O("card"),{chart:b,series:n}=N({createChartOptions:X(),series:Q({name:"txs",color:l(()=>x.value.colors.blue),formatter:u=>`${P(u,0,"dollar")}${E(u)}`,minMove:.01})});V(y);function y(){if(!b.value||!n.txs)return;const u=g.txs.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.txs.setData(u),b.value.timeScale().fitContent()}return(u,a)=>{const p=Y,v=K,m=z;return U(),W(m,{ref_key:"card",ref:c,title:"Transactions"},{actions:T(()=>[A("div",ve,[r(p,{filename:"txs",series:e(n)},null,8,["series"]),r(v,{chart:e(b),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[A("div",he,null,512)]),_:1},512)}}}),ye={style:{display:"flex"}},ge={ref:"chartRef",class:"chart"},xe=D({__name:"ChartUsers",props:{users:{}},setup(g){const x=q(),c=O("card"),{chart:b,series:n}=N({createChartOptions:X(),series:Q({name:"users",color:l(()=>x.value.colors.blue),formatter:u=>`${P(u,0,"dollar")}${E(u)}`,minMove:.01})});V(y);function y(){if(!b.value||!n.users)return;const u=g.users.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.users.setData(u),b.value.timeScale().fitContent()}return(u,a)=>{const p=Y,v=K,m=z;return U(),W(m,{ref_key:"card",ref:c,title:"Users"},{actions:T(()=>[A("div",ye,[r(p,{filename:"users",series:e(n)},null,8,["series"]),r(v,{chart:e(b),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[A("div",ge,null,512)]),_:1},512)}}}),be=D({__name:"ChartRankingChains",props:{type:{},txs:{},users:{}},setup(g){const x=q(),c=l(()=>`Top Chains (${g.type==="all"?"All Types":Z(g.type)})`),{items:b,toggles:n,disabled:y}=H(()=>{const{blue:t,yellow:o}=x.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function u(t){return t.groupBy(o=>o.chain).entries().map(([o,h])=>{const i=h.reduce((f,C)=>f+C.value,0);return{chain:o,count:i}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=x.value;return j({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:m.value,labels:{formatter:S}},yaxis:{labels:{formatter:B}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?u(g.txs):[]),v=l(()=>n.users.value?u(g.users):[]),m=l(()=>p.value.concat(v.value).orderBy(t=>t.count,"desc").map(t=>t.chain).uniq()),k=l(()=>{const t=m.value.map(h=>{const i=p.value.find(f=>f.chain===h);return i?i.count:0}),o=m.value.map(h=>{const i=v.value.find(f=>f.chain===h);return i?i.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,B=t=>`${P(t,0,"dollar")}${E(t)}`;return(t,o)=>{const h=J,i=G,f=z;return U(),W(f,{title:e(c)},{"actions-secondary":T(()=>[r(h,{items:e(b),disabled:e(y),onToggle:o[0]||(o[0]=C=>e(n)[C].value=!e(n)[C].value)},null,8,["items","disabled"])]),default:T(()=>[r(i,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),Ce=I(be,[["__scopeId","data-v-ce4cf7e7"]]),Te=D({__name:"ChartRankingTypes",props:{chain:{},txs:{},users:{}},setup(g){const x=q(),c=l(()=>`Top Types (${g.chain==="all"?"All Chains":Z(g.chain)})`),{items:b,toggles:n,disabled:y}=H(()=>{const{blue:t,yellow:o}=x.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function u(t){return t.groupBy(o=>o.type).entries().map(([o,h])=>{const i=h.reduce((f,C)=>f+C.value,0);return{type:o,count:i}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=x.value;return j({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:m.value,labels:{formatter:S}},yaxis:{labels:{formatter:B}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?u(g.txs):[]),v=l(()=>n.users.value?u(g.users):[]),m=l(()=>p.value.concat(v.value).orderBy(t=>t.count,"desc").map(t=>t.type).uniq()),k=l(()=>{const t=m.value.map(h=>{const i=p.value.find(f=>f.type===h);return i?i.count:0}),o=m.value.map(h=>{const i=v.value.find(f=>f.type===h);return i?i.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,B=t=>`${P(t,0,"dollar")}${E(t)}`;return(t,o)=>{const h=J,i=G,f=z;return U(),W(f,{title:e(c)},{"actions-secondary":T(()=>[r(h,{items:e(b),disabled:e(y),onToggle:o[0]||(o[0]=C=>e(n)[C].value=!e(n)[C].value)},null,8,["items","disabled"])]),default:T(()=>[r(i,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),we=I(Te,[["__scopeId","data-v-27837759"]]),$e={class:"option"},Se={class:"label"},Be=D({__name:"ActivityTypeSelect",emits:["select"],setup(g,{emit:x}){const c=x,b=["all",..._e],n=ie("all");function y(a){switch(a){case"all":return"All Types";case"crvusd":return"crvUSD";case"lending":return"Lending";case"pools":return"Pools";case"router":return"Router";case"dao":return"DAO"}}function u(a){n.value=a,c("select",n.value)}return(a,p)=>{const v=pe;return U(),W(v,{options:b,selected:e(n),onSelect:u},{option:T(({option:m})=>[A("div",$e,[A("div",Se,de(y(m)),1)])]),_:1},8,["selected"])}}}),Ae=I(Be,[["__scopeId","data-v-5448f8e1"]]),ke={class:"dashboard"},De={class:"toolbar"},Ue=D({__name:"Chains.page",setup(g){const x=M("chain"),c=l({get(){return x.value?x.value:"all"},set(s){x.value=s}}),b=l(()=>{const s=p.value.map(_=>_.chain).concat(m.value.map(_=>_.chain)).concat(c.value!=="all"?[c.value]:[]).uniq().orderBy(_=>_,"asc"),w=["ethereum"],$=s.difference(w).orderBy(_=>_,"asc");return["all",...w,...$]}),n=M("type"),y=l({get(){return n.value?n.value:"all"},set(s){n.value=s}}),u=s=>{y.value=s},{isFetching:a,data:p}=ce(),{isFetching:v,data:m}=ue();function k(s,w,$,_){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).groupBy(d=>d.timestamp.getTime()).entries().map(([d,L])=>{const R=L.reduce((F,ne)=>F+_(ne),0);return{timestamp:Number(d)/1e3,count:R}})}const S=l(()=>k(p.value,c.value,y.value,s=>s.transactions)),B=l(()=>k(m.value,c.value,y.value,s=>s.users));function t(s){const _=Math.floor(Date.now()/1e3)-7*24*60*60,L=s.filter(R=>R.timestamp>=_).reduce((R,F)=>R+F.count,0);return Math.round(L/7)}const o=l(()=>{var s;return((s=S.value.at(-1))==null?void 0:s.count)??0}),h=l(()=>t(S.value)),i=l(()=>{var s;return((s=B.value.at(-1))==null?void 0:s.count)??0}),f=l(()=>t(B.value));function C(s,w,$,_){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).map(d=>({chain:d.chain,type:d.type,value:_(d)}))}const ee=l(()=>C(p.value,"all",y.value,s=>s.transactions)),te=l(()=>C(m.value,"all",y.value,s=>s.users)),se=l(()=>C(p.value,c.value,"all",s=>s.transactions)),ae=l(()=>C(m.value,c.value,"all",s=>s.users));return(s,w)=>{const $=re,_=le,d=oe;return U(),me("div",ke,[A("div",De,[r(e(Ae),{style:{"grid-area":"type"},onSelect:u}),r($,{all:"",style:{"grid-area":"chain"},class:"chain-select",chain:e(c),chains:e(b),onSelectChain:w[0]||(w[0]=L=>c.value=L)},null,8,["chain","chains"])]),r(d,{style:{"grid-area":"kpi1"},label:"Transactions Today","has-value":!!e(a)},{default:T(()=>[r(_,{"show-zero":"",type:"dollar",value:e(o),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi2"},label:"Avg Transactions / 7 Days","has-value":!!e(a)},{default:T(()=>[r(_,{"show-zero":"",type:"dollar",value:e(h),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi3"},label:"Avg Users / 7 Days","has-value":!!e(v)},{default:T(()=>[r(_,{"show-zero":"",type:"dollar",value:e(i),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi4"},label:"Users Today","has-value":!!e(v)},{default:T(()=>[r(_,{"show-zero":"",type:"dollar",value:e(f),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(e(fe),{style:{"grid-area":"txs"},txs:e(S),loading:e(a)},null,8,["txs","loading"]),r(e(xe),{style:{"grid-area":"users"},users:e(B),loading:e(v)},null,8,["users","loading"]),r(e(Ce),{style:{"grid-area":"top-chains"},type:e(y),txs:e(ee),users:e(te),loading:e(a)||e(v)},null,8,["type","txs","users","loading"]),r(e(we),{style:{"grid-area":"top-types"},chain:e(c),txs:e(se),users:e(ae),loading:e(a)||e(v)},null,8,["chain","txs","users","loading"])])}}}),Ye=I(Ue,[["__scopeId","data-v-be882189"]]);export{Ye as default};

import{d as D,X as z,Y as O,z as l,a5 as I,a6 as W,Z as N,h as L,o as U,w as T,b as B,a as r,u as e,_ as q,g as P,I as oe,t as le,a7 as re,a8 as ce,a9 as ie,c as ue,V as de,aa as pe}from"./index-BYnNAfSP.js";import{_ as me}from"./SelectChain-JCHea49Q.js";import{u as X,b as Y,c as E,_ as Q,a as K}from"./UseLightweightChart-DudqJuBl.js";import{c as Z,_ as j}from"./ChartStylesApex-KBYYWdgj.js";import{u as G,_ as H}from"./UseLegend-CoonPT9k.js";import{c as J}from"./String-TwmdtJxb.js";import{a as M}from"./index-CQR0y8Z1.js";import"./Chain-DEbNFSfB.js";import"./Object-DOSYkgA0.js";const _e=["crvusd","lending","pools","router","dao"],ve={style:{display:"flex"}},he={ref:"chartRef",class:"chart"},ye=D({__name:"ChartTxs",props:{txs:{}},setup(y){const f=z(),c=O("card"),{chart:g,series:n}=X({createChartOptions:E(),series:{type:"Area",name:"txs",options:l(()=>({priceFormat:{type:"custom",formatter:i=>`${I(i,0,"dollar")}${W(i)}`,minMove:.01},lineWidth:2,lineType:Y.WithSteps,lineColor:f.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});N(h);function h(){if(!g.value||!n.txs)return;const i=y.txs.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.txs.setData(i),g.value.timeScale().fitContent()}return(i,a)=>{const p=q;return U(),L(p,{ref_key:"card",ref:c,title:"Transactions"},{actions:T(()=>[B("div",ve,[r(e(Q),{filename:"txs",series:e(n)},null,8,["series"]),r(e(K),{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[B("div",he,null,512)]),_:1},512)}}}),fe={style:{display:"flex"}},ge={ref:"chartRef",class:"chart"},be=D({__name:"ChartUsers",props:{users:{}},setup(y){const f=z(),c=O("card"),{chart:g,series:n}=X({createChartOptions:E(),series:{type:"Area",name:"users",options:l(()=>({priceFormat:{type:"custom",formatter:i=>`${I(i,0,"dollar")}${W(i)}`,minMove:.01},lineWidth:2,lineType:Y.WithSteps,lineColor:f.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});N(h);function h(){if(!g.value||!n.users)return;const i=y.users.map(a=>({time:a.timestamp,value:a.count})).uniqWith((a,p)=>a.time===p.time).orderBy(a=>a.time,"asc");n.users.setData(i),g.value.timeScale().fitContent()}return(i,a)=>{const p=q;return U(),L(p,{ref_key:"card",ref:c,title:"Users"},{actions:T(()=>[B("div",fe,[r(e(Q),{filename:"users",series:e(n)},null,8,["series"]),r(e(K),{chart:e(g),target:e(c)},null,8,["chart","target"])])]),default:T(()=>[B("div",ge,null,512)]),_:1},512)}}}),xe=D({__name:"ChartRankingChains",props:{type:{},txs:{},users:{}},setup(y){const f=z(),c=l(()=>`Top Chains (${y.type==="all"?"All Types":J(y.type)})`),{items:g,toggles:n,disabled:h}=G(()=>{const{blue:t,yellow:o}=f.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function i(t){return t.groupBy(o=>o.chain).entries().map(([o,_])=>{const u=_.reduce((v,x)=>v+x.value,0);return{chain:o,count:u}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=f.value;return Z({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:b.value,labels:{formatter:S}},yaxis:{labels:{formatter:A}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?i(y.txs):[]),C=l(()=>n.users.value?i(y.users):[]),b=l(()=>p.value.concat(C.value).orderBy(t=>t.count,"desc").map(t=>t.chain).uniq()),k=l(()=>{const t=b.value.map(_=>{const u=p.value.find(v=>v.chain===_);return u?u.count:0}),o=b.value.map(_=>{const u=C.value.find(v=>v.chain===_);return u?u.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,A=t=>`${I(t,0,"dollar")}${W(t)}`;return(t,o)=>{const _=H,u=j,v=q;return U(),L(v,{title:e(c)},{"actions-secondary":T(()=>[r(_,{items:e(g),disabled:e(h),onToggle:o[0]||(o[0]=x=>e(n)[x].value=!e(n)[x].value)},null,8,["items","disabled"])]),default:T(()=>[r(u,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),Ce=P(xe,[["__scopeId","data-v-14a5021b"]]),Te=D({__name:"ChartRankingTypes",props:{chain:{},txs:{},users:{}},setup(y){const f=z(),c=l(()=>`Top Types (${y.chain==="all"?"All Chains":J(y.chain)})`),{items:g,toggles:n,disabled:h}=G(()=>{const{blue:t,yellow:o}=f.value.colors;return[{id:"txs",label:"Transactions",color:t,togglable:!0},{id:"users",label:"Users",color:o,togglable:!0}]});function i(t){return t.groupBy(o=>o.type).entries().map(([o,_])=>{const u=_.reduce((v,x)=>v+x.value,0);return{type:o,count:u}}).orderBy(o=>o.count,"desc")}const a=l(()=>{const{colors:t}=f.value;return Z({chart:{type:"bar",animations:{enabled:!1}},colors:[t.blue,t.yellow],xaxis:{categories:b.value,labels:{formatter:S}},yaxis:{labels:{formatter:A}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{enabled:!1}})}),p=l(()=>n.txs.value?i(y.txs):[]),C=l(()=>n.users.value?i(y.users):[]),b=l(()=>p.value.concat(C.value).orderBy(t=>t.count,"desc").map(t=>t.type).uniq()),k=l(()=>{const t=b.value.map(_=>{const u=p.value.find(v=>v.type===_);return u?u.count:0}),o=b.value.map(_=>{const u=C.value.find(v=>v.type===_);return u?u.count:0});return[{data:n.txs.value?t:[]},{data:n.users.value?o:[]}]}),S=t=>t,A=t=>`${I(t,0,"dollar")}${W(t)}`;return(t,o)=>{const _=H,u=j,v=q;return U(),L(v,{title:e(c)},{"actions-secondary":T(()=>[r(_,{items:e(g),disabled:e(h),onToggle:o[0]||(o[0]=x=>e(n)[x].value=!e(n)[x].value)},null,8,["items","disabled"])]),default:T(()=>[r(u,{options:e(a),series:e(k)},null,8,["options","series"])]),_:1},8,["title"])}}}),we=P(Te,[["__scopeId","data-v-1a22e72b"]]),$e={class:"option"},Se={class:"label"},Ae=D({__name:"ActivityTypeSelect",emits:["select"],setup(y,{emit:f}){const c=f,g=["all",..._e],n=oe("all");function h(a){switch(a){case"all":return"All Types";case"crvusd":return"crvUSD";case"lending":return"Lending";case"pools":return"Pools";case"router":return"Router";case"dao":return"DAO"}}function i(a){n.value=a,c("select",n.value)}return(a,p)=>{const C=re;return U(),L(C,{options:g,selected:e(n),onSelect:i},{option:T(({option:b})=>[B("div",$e,[B("div",Se,le(h(b)),1)])]),_:1},8,["selected"])}}}),Be=P(Ae,[["__scopeId","data-v-8dcf6e5e"]]),ke={class:"dashboard"},De={class:"toolbar"},Ue=D({__name:"Chains.page",setup(y){const f=M("chain"),c=l({get(){return f.value?f.value:"all"},set(s){f.value=s}}),g=l(()=>{const s=p.value.map(m=>m.chain).concat(b.value.map(m=>m.chain)).concat(c.value!=="all"?[c.value]:[]).uniq().orderBy(m=>m,"asc"),w=["ethereum"],$=s.difference(w).orderBy(m=>m,"asc");return["all",...w,...$]}),n=M("type"),h=l({get(){return n.value?n.value:"all"},set(s){n.value=s}}),i=s=>{h.value=s},{isFetching:a,data:p}=ce(),{isFetching:C,data:b}=ie();function k(s,w,$,m){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).groupBy(d=>d.timestamp.getTime()).entries().map(([d,R])=>{const V=R.reduce((F,ne)=>F+m(ne),0);return{timestamp:Number(d)/1e3,count:V}})}const S=l(()=>k(p.value,c.value,h.value,s=>s.transactions)),A=l(()=>k(b.value,c.value,h.value,s=>s.users));function t(s){const m=Math.floor(Date.now()/1e3)-7*24*60*60,R=s.filter(V=>V.timestamp>=m).reduce((V,F)=>V+F.count,0);return Math.round(R/7)}const o=l(()=>{var s;return((s=S.value.at(-1))==null?void 0:s.count)??0}),_=l(()=>t(S.value)),u=l(()=>{var s;return((s=A.value.at(-1))==null?void 0:s.count)??0}),v=l(()=>t(A.value));function x(s,w,$,m){return s.filter(d=>w==="all"?!0:d.chain===w).filter(d=>$==="all"?!0:d.type===$).map(d=>({chain:d.chain,type:d.type,value:m(d)}))}const ee=l(()=>x(p.value,"all",h.value,s=>s.transactions)),te=l(()=>x(b.value,"all",h.value,s=>s.users)),se=l(()=>x(p.value,c.value,"all",s=>s.transactions)),ae=l(()=>x(b.value,c.value,"all",s=>s.users));return(s,w)=>{const $=me,m=de,d=pe;return U(),ue("div",ke,[B("div",De,[r(e(Be),{style:{"grid-area":"type"},onSelect:i}),r($,{all:"",style:{"grid-area":"chain"},class:"chain-select",chain:e(c),chains:e(g),onSelectChain:w[0]||(w[0]=R=>c.value=R)},null,8,["chain","chains"])]),r(d,{style:{"grid-area":"kpi1"},label:"Transactions Today","has-value":!!e(a)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(o),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi2"},label:"Avg Transactions / 7 Days","has-value":!!e(a)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(_),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi3"},label:"Avg Users / 7 Days","has-value":!!e(C)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(u),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(d,{style:{"grid-area":"kpi4"},label:"Users Today","has-value":!!e(C)},{default:T(()=>[r(m,{"show-zero":"",type:"dollar",value:e(v),"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),r(e(ye),{style:{"grid-area":"txs"},txs:e(S),loading:e(a)},null,8,["txs","loading"]),r(e(be),{style:{"grid-area":"users"},users:e(A),loading:e(C)},null,8,["users","loading"]),r(e(Ce),{style:{"grid-area":"top-chains"},type:e(h),txs:e(ee),users:e(te),loading:e(a)||e(C)},null,8,["type","txs","users","loading"]),r(e(we),{style:{"grid-area":"top-types"},chain:e(c),txs:e(se),users:e(ae),loading:e(a)||e(C)},null,8,["chain","txs","users","loading"])])}}}),Me=P(Ue,[["__scopeId","data-v-5d70631c"]]);export{Me as default};

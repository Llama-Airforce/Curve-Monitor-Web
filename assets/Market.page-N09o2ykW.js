import{_ as X,a as Y}from"./TabItem.vue_vue_type_script_setup_true_lang-Brn5Dep7.js";import{d as C,g as b,T as D,f as k,V as I,h as y,o as v,_ as V,u as e,w as h,a as g,r as T,b as r,O as Z,e as S,c as F,t as q,W as B,S as H,j as x,a4 as ee,a5 as ae,N as te,R as se,a2 as E}from"./index-CEOjmKtR.js";import{e as M,u as ne}from"./crvusd-Du_tfejE.js";import{u as j,a as oe,b as re,c as ie,d as le,e as ce,f as de,T as ue,_ as me,g as _e,h as pe,i as he,j as ve,k as ge,l as fe,m as ke,n as be,o as ye,C as $e,p as we,q as Ce}from"./TableTrades-ZbGfvzS8.js";import{u as Q,c as P,a as N,d as Te}from"./UseLightweightChart-D6IbOW_8.js";import"./ChartStylesApex-Cs2g9yl9.js";import{_ as Le}from"./KPI-C9fTZmfG.js";import{_ as qe}from"./AsyncValue-k8yzPf6l.js";import"./UseLegend-DXfplF16.js";import"./ButtonToggle-DOQ7XXrK.js";/* empty css                                                                         */import{r as U,u as K}from"./Number-nBy8KE7n.js";import{_ as Se}from"./InputNumber-BlKSk2dm.js";import{_ as z,a as Ae}from"./Table-DR8Omo3G.js";import{L as G}from"./link-DPyTbxEd.js";import{_ as Re}from"./TokenIcon-BUfLytfP.js";import{a as Fe}from"./index-C0PzODp0.js";import{u as Ve}from"./UseTabNavigation--UtxkSuI.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-C8O3Jmvc.js";import"./UsePagination-1UehUDjm.js";import"./UseRelativeTime-CsG15NWs.js";import"./Object-DOSYkgA0.js";/* empty css                                                                    */const Be={ref:"chartRef",class:"chart"},Oe=C({__name:"ChartMarketAvailableCap",props:{market:{}},setup(l){const{isFetching:s,data:_}=M(b(()=>l.market)),p=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:P({name:"available",color:k(()=>p.value.colors.blue),formatter:o=>`$${U(o,0,"dollar")}${K(o)}`})});I(i);function i(){if(!n.value||!t.available)return;const o=_.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.borrowable})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc").dropWhile(a=>a.value===0);o.length>0&&t.available.setData(o),n.value.timeScale().fitContent()}return(o,a)=>{const c=V;return v(),y(c,{title:"Borrowable & Debt Ceiling",loading:e(s)},{default:h(()=>[g("div",Be,null,512)]),_:1},8,["loading"])}}}),De={ref:"chartRef",class:"chart"},Ie=C({__name:"ChartMarketLoans",props:{market:{}},setup(l){const{isFetching:s,data:_}=M(b(()=>l.market)),p=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:{type:"Histogram",name:"loans",options:k(()=>({color:p.value.colors.yellow,lastValueVisible:!1,priceFormat:{type:"volume"},priceLineVisible:!1}))}});I(i);function i(){if(!n.value||!t.loans)return;const o=_.value.map(a=>({time:a.timestamp.getUTCTimestamp(),value:a.nLoans})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc");o.length>0&&(t.loans.setData(o),n.value.timeScale().fitContent())}return(o,a)=>{const c=V;return v(),y(c,{title:"Loans",loading:e(s)},{default:h(()=>[g("div",De,null,512)]),_:1},8,["loading"])}}}),Me={ref:"chartRef",class:"chart"},Qe=C({__name:"ChartMarketRates",props:{market:{}},setup(l){const{isFetching:s,data:_}=M(b(()=>l.market)),p=D(),n=T(null),{chart:t,series:i}=Q({createChartOptions:N(),series:[P({name:"rates",color:k(()=>p.value.colors.blue),formatter:a}),{type:"Line",name:"ema",options:k(()=>({priceFormat:{type:"custom",formatter:a},lineWidth:2,lineType:Te.WithSteps,color:p.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});I(o);function o(){if(!t.value||!i.rates||!i.ema)return;const u=_.value.map(d=>({time:d.timestamp.getUTCTimestamp(),value:d.rate})).uniqWith((d,$)=>d.time===$.time).orderBy(d=>d.time,"asc"),f=c(u.map(d=>d.value),n.value??31).zip(u).map(d=>({time:d[1].time,value:d[0]}));f.length>0&&i.ema.setData(f),u.length>0&&(i.rates.setData(u),t.value.timeScale().fitContent())}function a(u){return`${U(u*100,0,"percentage")}%`}const c=(u,m=7)=>u.map((f,d)=>{const $=Math.max(d-(m-1),0),A=d+1,L=u.slice($,A);return L.reduce((O,w)=>O+w,0)/L.length});return(u,m)=>{const f=Se,d=V;return v(),y(d,{title:"Rates",loading:e(s)},{actions:h(()=>[r(f,{modelValue:e(n),"onUpdate:modelValue":m[0]||(m[0]=$=>Z(n)?n.value=$:null),class:"avg-span",placeholder:"Avg span (days)",min:1,max:1/0},null,8,["modelValue"])]),default:h(()=>[g("div",Me,null,512)]),_:1},8,["loading"])}}}),Ne=S(Qe,[["__scopeId","data-v-cbe8a50e"]]),We={ref:"chartRef",class:"chart"},Ee=C({__name:"ChartMarketVolume",props:{market:{},chain:{}},setup(l){const{isFetching:s,data:_}=j("crvusd",k(()=>{var o;return(o=l.market)==null?void 0:o.llamma}),b(()=>l.chain)),p=D(),{chart:n,series:t}=Q({createChartOptions:N(),series:P({name:"volume",color:k(()=>p.value.colors.blue),formatter:o=>`$${U(o,0,"dollar")}${K(o)}`})});I(i);function i(){if(!n.value||!t.volume)return;const o=(_.value??[]).map(a=>({time:a.time.getUTCTimestamp(),value:a.volume})).uniqWith((a,c)=>a.time===c.time).orderBy(a=>a.time,"asc");o.length>0&&t.volume.setData(o),n.value.timeScale().fitContent()}return(o,a)=>{const c=V;return v(),y(c,{title:"Volume",loading:e(s)},{default:h(()=>[g("div",We,null,512)]),_:1},8,["loading"])}}}),Pe={class:"dashboard-grid"},Ue=C({__name:"Liquidations",props:{market:{},chain:{}},setup(l){const s=k(()=>{var w;return(w=l.market)==null?void 0:w.address}),{isFetching:_,data:p}=oe(T("crvusd"),b(()=>l.chain),s),{isFetching:n,data:t}=M(b(()=>l.market)),i=k(()=>t.value.map(({timestamp:w,priceOracle:R})=>({timestamp:w,priceOracle:R}))),o=k(()=>t.value.map(({timestamp:w,discountLiquidation:R})=>({timestamp:w,discount:R}))),a=k(()=>t.value.map(({timestamp:w,totalCollateralUsd:R,totalDebt:J})=>({timestamp:w,ratio:R/J}))),{isFetching:c,data:u}=re(T("crvusd"),b(()=>l.chain),s),{isFetching:m,data:f}=ie(T("crvusd"),b(()=>l.chain),s),{isFetching:d,data:$}=le(T("crvusd"),b(()=>l.chain),s),{isFetching:A,data:L}=ce(T("crvusd"),b(()=>l.chain),s),{isFetching:W,data:O}=de(T("crvusd"),b(()=>l.chain),s);return(w,R)=>(v(),F("div",Pe,[r(e(ue),{overview:e(p),loading:e(_)},null,8,["overview","loading"]),r(e(me),{ratios:e(u),"prices-oracle":e(i),loading:e(c)||e(n)},null,8,["ratios","prices-oracle","loading"]),r(e(_e),{losses:e(O),loading:e(W)},null,8,["losses","loading"]),r(e(pe),{losses:e(O),loading:e(W)},null,8,["losses","loading"]),r(e(he),{deciles:e(L),loading:e(A)},null,8,["deciles","loading"]),r(e(ve),{ratios:e(a),loading:e(n)},null,8,["ratios","loading"]),r(e(ge),{liqs:e(f),loading:e(m)},null,8,["liqs","loading"]),r(e(fe),{liqs:e($),loading:e(d)},null,8,["liqs","loading"]),r(e(ke),{discounts:e(o),liqs:e($),loading:e(n)||e(d)},null,8,["discounts","liqs","loading"])]))}}),He=S(Ue,[["__scopeId","data-v-6ad4864c"]]),je=["href"],Ke={key:1},ze=C({__name:"Addresses",props:{market:{}},setup(l){const s=k(()=>{var n,t,i;return[{description:"Controller",address:(n=l.market)==null?void 0:n.address},{description:"Factory",address:(t=l.market)==null?void 0:t.factoryAddress},{description:"Llamma",address:(i=l.market)==null?void 0:i.llamma}]}),_=n=>`https://etherscan.io/address/${n}`,p=async n=>{await navigator.clipboard.writeText(n)};return(n,t)=>{const i=G,o=H,a=z,c=V;return v(),y(c,{class:"addresses",title:"Addresses"},{default:h(()=>[r(a,{class:"addresses-table",rows:e(s)},{row:h(({item:{description:u,address:m}})=>[g("div",null,q(u),1),g("div",null,[m?(v(),F("a",{key:0,class:"font-mono",target:"_blank",href:_(m)},q(m),9,je)):(v(),F("span",Ke,"?"))]),g("div",null,[m?(v(),y(o,{key:0,onClick:f=>p(m)},{default:h(()=>[r(i)]),_:2},1032,["onClick"])):B("",!0)])]),_:1},8,["rows"])]),_:1})}}}),Ge=S(ze,[["__scopeId","data-v-2bb26947"]]),Je={class:"token-info"},Xe=["href"],Ye={class:"token-info"},Ze=["href"],xe=C({__name:"Properties",props:{market:{},chain:{}},setup(l){const s=k(()=>{var t,i,o,a;return{type:"token",symbol:((i=(t=l.market)==null?void 0:t.collateralToken)==null?void 0:i.symbol)??"?",address:((a=(o=l.market)==null?void 0:o.collateralToken)==null?void 0:a.address)??"?"}}),_=k(()=>{var t,i,o,a;return{type:"token",symbol:((i=(t=l.market)==null?void 0:t.stablecoinToken)==null?void 0:i.symbol)??"?",address:((a=(o=l.market)==null?void 0:o.stablecoinToken)==null?void 0:a.address)??"?"}}),p=t=>`https://etherscan.io/address/${t}`,n=async t=>{await navigator.clipboard.writeText(t)};return(t,i)=>{const o=Re,a=G,c=H,u=Ae,m=z,f=V;return v(),y(f,{class:"properties",title:"Properties"},{default:h(()=>[r(m,{class:"properties-table"},{default:h(()=>[r(u,null,{default:h(()=>[i[2]||(i[2]=g("div",null,"Collateral",-1)),g("div",Je,[r(o,{chain:t.chain,address:e(s).address},null,8,["chain","address"]),g("div",null,q(e(s).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:p(e(s).address)},q(e(s).address),9,Xe)]),g("div",null,[r(c,{onClick:i[0]||(i[0]=d=>n(e(s).address))},{default:h(()=>[r(a)]),_:1})])])]),_:1}),r(u,null,{default:h(()=>[i[3]||(i[3]=g("div",null,"Borrowed",-1)),g("div",Ye,[r(o,{chain:t.chain,address:e(_).address},null,8,["chain","address"]),g("div",null,q(e(_).symbol),1),g("div",null,[g("a",{class:"font-mono",target:"_blank",href:p(e(_).address)},q(e(_).address),9,Ze)]),g("div",null,[r(c,{onClick:i[1]||(i[1]=d=>n(e(_).address))},{default:h(()=>[r(a)]),_:1})])])]),_:1})]),_:1})]),_:1})}}}),ea=S(xe,[["__scopeId","data-v-61c51caa"]]),aa={class:"dashboard-grid"},ta=C({__name:"MarketOverview",props:{market:{},chain:{}},setup(l){return(s,_)=>{const p=qe,n=Le;return v(),F("div",aa,[r(n,{style:{"grid-area":"kpi1"},label:"Borrow Rate","has-value":!!s.market},{default:h(()=>{var t;return[r(p,{type:"percentage",value:100*(((t=s.market)==null?void 0:t.rate)??0)},null,8,["value"])]}),_:1},8,["has-value"]),r(n,{style:{"grid-area":"kpi2"},label:"Borrowed","has-value":!!s.market},{default:h(()=>{var t;return[r(p,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowed},null,8,["value"])]}),_:1},8,["has-value"]),r(n,{style:{"grid-area":"kpi3"},label:"Borrowable","has-value":!!s.market},{default:h(()=>{var t;return[r(p,{type:"dollar",value:(t=s.market)==null?void 0:t.borrowable},null,8,["value"])]}),_:1},8,["has-value"]),r(n,{style:{"grid-area":"kpi4"},label:"Loans","has-value":!!s.market},{default:h(()=>{var t;return[x(q(((t=s.market)==null?void 0:t.loans)??0),1)]}),_:1},8,["has-value"]),r(e(Ne),{style:{"grid-area":"rates"},market:s.market},null,8,["market"]),r(e(Oe),{style:{"grid-area":"cap"},market:s.market},null,8,["market"]),r(e(Ie),{style:{"grid-area":"loans"},market:s.market},null,8,["market"]),r(e(Ee),{style:{"grid-area":"volume"},market:s.market,chain:s.chain},null,8,["market","chain"]),r(e(ea),{style:{"grid-area":"properties"},market:s.market,chain:s.chain},null,8,["market","chain"]),r(e(Ge),{style:{"grid-area":"addresses"},market:s.market,chain:s.chain},null,8,["market","chain"])])}}}),sa=S(ta,[["__scopeId","data-v-efc50c6b"]]),na={class:"dashboard-grid"},oa=C({__name:"Trading",props:{market:{},chain:{}},setup(l){const s=k(()=>{var u;return(u=l.market)==null?void 0:u.llamma}),{isFetching:_,data:p}=j("crvusd",s,b(()=>l.chain)),n=T(1),{isFetching:t,data:i}=be("crvusd",s,b(()=>l.chain),n),o=T(1),{isFetching:a,data:c}=ye("crvusd",s,b(()=>l.chain),o);return(u,m)=>{var f,d,$,A;return v(),F("div",na,[r(e($e),{style:{"grid-area":"ohlc"},ohlc:e(p)??[],loading:e(_)},null,8,["ohlc","loading"]),r(e(we),{style:{"grid-area":"trades"},trades:((f=e(i))==null?void 0:f.trades)??[],count:((d=e(i))==null?void 0:d.count)??0,chain:u.chain,loading:e(t),onPage:m[0]||(m[0]=L=>n.value=L)},null,8,["trades","count","chain","loading"]),r(e(Ce),{style:{"grid-area":"events"},events:(($=e(c))==null?void 0:$.events)??[],count:((A=e(c))==null?void 0:A.count)??0,loading:e(a),onPage:m[1]||(m[1]=L=>o.value=L)},null,8,["events","count","loading"])])}}}),ra=S(oa,[["__scopeId","data-v-13550918"]]),ia={class:"dashboard"},la=C({__name:"Market.page",setup(l){const s=Fe("marketAddr"),{isFetching:_,data:p}=ne(),n=k(()=>p.value.find(a=>a.address===s.value)),{crumbs:t}=ee(ae());te(n,a=>{t.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:`Market: ${(a==null?void 0:a.name)??"?"}`}]},{immediate:!0});const{tabActive:i,tabActiveIndex:o}=Ve(["overview","trading","liquidations"],"crvusdmarket",()=>({marketAddr:s.value}));return(a,c)=>{const u=se,m=X,f=Y;return v(),F("div",ia,[r(u,{loading:e(_)},null,8,["loading"]),!e(_)&&e(n)?(v(),y(f,{key:0,active:e(o),onTab:c[0]||(c[0]=d=>o.value=d.index)},{default:h(()=>[r(m,{header:"Overview"},{default:h(()=>[(v(),y(E,null,[e(i)==="overview"?(v(),y(sa,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),r(m,{header:"Trading"},{default:h(()=>[(v(),y(E,null,[e(i)==="trading"?(v(),y(ra,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1}),r(m,{header:"Liquidations"},{default:h(()=>[(v(),y(E,null,[e(i)==="liquidations"?(v(),y(He,{key:0,chain:"ethereum",market:e(n)},null,8,["market"])):B("",!0)],1024))]),_:1})]),_:1},8,["active"])):B("",!0)])}}}),Oa=S(la,[["__scopeId","data-v-3ac83fbe"]]);export{Oa as default};

import{d as T,T as U,f as p,U as D,V as S,h as R,o as B,w as v,a as c,b as r,u as l,_ as z,r as x,t as K,O as I,aa as O,e as A,c as W}from"./index-C0zPo2qD.js";import{u as E,_ as Q}from"./UseLegend-CO2M4n0f.js";import{u as M,G as N,r as G,a as j,_ as q,b as H}from"./UseLightweightChart-BKKzAF5o.js";import{f as F,g as J}from"./crvusd-BIkAIGXG.js";import{r as X,u as Y}from"./Number-DeModjU-.js";import{_ as Z}from"./Table-Deypc3gI.js";import{_ as ee}from"./AsyncValue-DIUCWaNI.js";import{_ as se}from"./TokenIcon-Dy1eIJ24.js";import{_ as oe}from"./InputText-DbYUHmQ2.js";import{e as ae}from"./pools-B5rgZk5d.js";import"./Object-DOSYkgA0.js";import"./timestamp-CeU_tFUE.js";import"./api-BL5-_Coi.js";import"./useQuery-DD55_qKH.js";import"./fetch-bVCl_krR.js";import"./UseHost-Q14ZtuwU.js";const te={style:{display:"flex"}},le={ref:"chartRef",class:"chart"},ne=T({__name:"ChartKeeperPrices",setup(g){const m=U(),_=["USDC","USDT"],{items:w,toggles:u,disabled:C}=E(()=>_.map((t,i)=>({id:t,label:t,color:m.value.colorsArray[i],togglable:!0}))),y=p(()=>V.value||k.value),{isFetching:V,data:L}=F(),b=p(()=>L.value.filter(t=>t.pair.some(({symbol:i})=>_.map(s=>s.toLocaleLowerCase()).includes(i.toLocaleLowerCase())))),{isFetching:k,data:P}=J(b),d=D("card"),{chart:f,series:e}=M({createChartOptions:j(),series:_.map((t,i)=>({type:N,name:t,options:p(()=>({priceFormat:{type:"custom",formatter:s=>`${X(s,3,"dollar")}${Y(s)}`},lineWidth:2,lineType:G.WithSteps,color:m.value.colorsArray[i],lastValueVisible:!1,priceLineVisible:!1,autoscaleInfoProvider:s=>{const o=s();return o!==null&&o.priceRange&&(o.priceRange.minValue=Math.max(.98,o.priceRange.minValue),o.priceRange.maxValue=Math.min(1.02,o.priceRange.maxValue)),o}}))}))});S(n);function n(){var t,i;if(!(!f.value||Object.values(e).length<0)){for(const[,s]of _.entries())(t=e[s])==null||t.applyOptions({visible:u[s].value}),(i=e[s])==null||i.setData(P.value.map(o=>({time:o.timestamp,value:o[s]})).uniqWith((o,h)=>o.time===h.time).orderBy(o=>o.time,"asc"));f.value.timeScale().fitContent()}}return(t,i)=>{const s=q,o=H,h=Q,a=z;return B(),R(a,{ref_key:"card",ref:d,title:"Pegkeepers Coin Prices",loading:l(y)},{actions:v(()=>[c("div",te,[r(s,{filename:"keeper_prices",series:l(e)},null,8,["series"]),r(o,{chart:l(f),target:l(d)},null,8,["chart","target"])])]),"actions-secondary":v(()=>[r(h,{items:l(w),disabled:l(C),onToggle:i[0]||(i[0]=$=>l(u)[$].value=!l(u)[$].value)},null,8,["items","disabled"])]),default:v(()=>[c("div",le,null,512)]),_:1},8,["loading"])}}});function re(g){return g!=null}const ie={class:"end"},ce={class:"end"},de={class:"end"},ue={class:"end"},pe={class:"end"},me={class:"end"},_e={class:"end"},ve={class:"end"},ge=T({__name:"TablePegkeepers",setup(g){const m=x(""),_=p(()=>k.value||C.value),w=p(()=>y.value.filter(e=>e.active).map(e=>{const n=P.value.find(t=>e.poolAddress===t.address);if(n)return{...n,...e,pool:n.address}}).filter(re).orderBy(e=>e.tvlUsd,"desc")),u=p(()=>w.value.filter(e=>{const n=m.value.toLocaleLowerCase().split(" "),t=i=>n.some(s=>i.toLocaleLowerCase().includes(s));return t(e.name)||t(e.address)})),{isFetching:C,data:y}=F(),V=e=>`${e.pair[1].symbol} / ${e.pair[0].symbol}`,L=p(()=>y.value.map(e=>e.poolAddress)),b=ae(x("ethereum"),L),k=p(()=>b.value.some(e=>e.isFetching)),P=p(()=>b.value.filter(e=>e.data).map(e=>e.data)),d=e=>e>=1e6?2:0,f=e=>e.pair.filter(n=>n.address.toLocaleLowerCase()!==O)[0].address;return(e,n)=>{const t=oe,i=se,s=ee,o=Z,h=z;return B(),R(h,{class:"pegkeepers-card",title:"Pegkeepers",loading:l(_)},{actions:v(()=>[r(t,{modelValue:l(m),"onUpdate:modelValue":n[0]||(n[0]=a=>I(m)?m.value=a:null),search:"",placeholder:"Search for.."},null,8,["modelValue"])]),default:v(()=>[r(o,{class:"pegkeepers-table",rows:l(u),columns:["","Name",{label:"Debt",align:"end"},{label:"TVL",align:"end"},{label:"Volume",align:"end"},{label:"Fees",align:"end"}]},{row:v(({item:a})=>[r(i,{chain:"ethereum",address:f(a)},null,8,["address"]),c("div",null,K(V(a)),1),c("div",ie,[r(s,{"show-zero":"",type:"dollar",value:a.totalDebt,precision:d},null,8,["value"])]),c("div",ce,[r(s,{"show-zero":"",type:"dollar",value:a.tvlUsd,precision:d},null,8,["value"])]),c("div",de,[r(s,{"show-zero":"",type:"dollar",value:a.tradingVolume24h,precision:d},null,8,["value"])]),c("div",ue,[r(s,{"show-zero":"",type:"dollar",value:a.totalProfit,precision:d},null,8,["value"])])]),"row-aggregation":v(()=>[n[1]||(n[1]=c("div",null,null,-1)),n[2]||(n[2]=c("div",null,null,-1)),c("div",pe,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(a=>a.totalDebt),precision:d},null,8,["value"])]),c("div",me,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(a=>+a.tvlUsd),precision:d},null,8,["value"])]),c("div",_e,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(a=>a.tradingVolume24h),precision:d},null,8,["value"])]),c("div",ve,[r(s,{"show-zero":"",type:"dollar",value:l(u).sumBy(a=>a.totalProfit),precision:d},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),fe=A(ge,[["__scopeId","data-v-a8f81914"]]),he={class:"dashboard"},ye=T({__name:"Pegkeepers.page",setup(g){return(m,_)=>(B(),W("div",he,[r(l(fe),{style:{"grid-area":"table"}}),r(l(ne),{style:{"grid-area":"chart"}})]))}}),De=A(ye,[["__scopeId","data-v-f4603245"]]);export{De as default};

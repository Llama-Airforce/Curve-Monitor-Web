import{_ as M,a as Q}from"./TabItem.vue_vue_type_script_setup_true_lang-aHLn9g5N.js";import{d as T,S as N,z as C,G as B,h as f,o as t,_ as S,u as a,w as i,T as w,c as p,a as r,b as d,t as k,K as $,g as V,X as E,Y as K,a5 as U,Z as q,F,f as z,aa as J,N as L,r as X,V as W,I as Y,L as Z,ac as j,ad as x,J as ee,O as ae,a4 as I}from"./index-BYnNAfSP.js";import{b as se,c as te,d as oe,e as ne}from"./gauge-D9uEVD_S.js";import{_ as re}from"./TokenIcon-CTWhTb_X.js";import{_ as R,a as le}from"./Table-CkrHHA0S.js";import{u as ie,b as ue,c as de,_ as ge,a as ce}from"./UseLightweightChart-DudqJuBl.js";import{_ as pe}from"./InputText-B41kNJQc.js";import{u as _e,_ as me}from"./UsePagination-6my4nle6.js";import{u as he}from"./UseSort-BgHBlkv6.js";import{a as fe}from"./index-CQR0y8Z1.js";import{u as ve}from"./UseTabNavigation-5nrvQdSX.js";import"./Object-DOSYkgA0.js";const ke=["href"],be=["href"],ye=["innerHTML"],$e=T({__name:"TableDeployment",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=se(N(()=>b.gaugeAddress)),c=C(()=>{var e;return(e=n.value)!=null&&e.calldataDecoded?n.value.calldataDecoded.replace(/(?:\r\n|\r|\n)/g,"<br>").replace("/├/g","├").replace("/─/g","─").replace(/0x[a-fA-F0-9]{40}/g,s=>/[A-F]/g.test(s)&&B(s)?`<a target='_blank' href='https://etherscan.io/address/${s}'>${s}</a>`:s):null});return(e,s)=>{const g=le,l=R,_=S;return t(),f(_,{title:"Deployment",loading:a(h)},{default:i(()=>[a(n)?(t(),f(l,{key:0},{default:i(()=>[r(g,null,{default:i(()=>[s[2]||(s[2]=d("div",null,"Date",-1)),d("div",null,k(a(n).timestamp.toLocaleDateString()),1)]),_:1}),r(g,null,{default:i(()=>[s[3]||(s[3]=d("div",null,"From",-1)),d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${a(n).addressFrom}`,onClick:s[0]||(s[0]=$(()=>{},["stop"]))},k(a(n).addressFrom),9,ke)])]),_:1}),a(n).addressTo?(t(),f(g,{key:0},{default:i(()=>[s[4]||(s[4]=d("div",null,"To",-1)),d("div",null,[d("a",{class:"font-mono trim",target:"_blank",href:`https://etherscan.io/address/${a(n).addressTo}`,onClick:s[1]||(s[1]=$(()=>{},["stop"]))},k(a(n).addressTo),9,be)])]),_:1})):w("",!0)]),_:1})):w("",!0),a(c)?(t(),p("div",{key:1,class:"calldata font-mono",innerHTML:a(c)},null,8,ye)):w("",!0)]),_:1},8,["loading"])}}}),we=V($e,[["__scopeId","data-v-2856e0e1"]]),Te={style:{display:"flex"}},Ce={ref:"chartRef",class:"chart"},Ve=T({__name:"ChartWeightHistory",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=te(N(()=>b.gaugeAddress)),c=E(),e=K("card"),{chart:s,series:g}=ie({createChartOptions:de(),series:{type:"Area",name:"weight",options:C(()=>({priceFormat:{type:"custom",formatter:_=>U(_,1)},lineWidth:2,lineType:ue.WithSteps,lineColor:c.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))}});q(l);function l(){if(!s.value||!g.weight)return;const _=n.value.map(m=>({time:m.epoch,value:Number(m.weight)/10**18})).uniqWith((m,v)=>m.time===v.time).orderBy(m=>m.time,"asc");_.length>0&&g.weight.setData(_),s.value.timeScale().fitContent()}return(_,m)=>{const v=S;return t(),f(v,{ref_key:"card",ref:e,title:"Weight",loading:a(h)},{actions:i(()=>[d("div",Te,[r(a(ge),{filename:"weight",series:a(g)},null,8,["series"]),r(a(ce),{chart:a(s),target:a(e)},null,8,["chart","target"])])]),default:i(()=>[d("div",Ce,null,512)]),_:1},8,["loading"])}}}),Se={class:"dashboard-grid"},Ae=["href"],De={key:1},Le=["href"],Ne={key:1},Pe={key:2},Fe=["href"],Ie={key:1},Ge={key:0,class:"tokens"},Be={key:1},We=["href"],Re=T({__name:"GaugeOverview",props:{gauge:{}},setup(b){const h=C(()=>{var e;return(e=b.gauge)==null?void 0:e.address});function n(e){return B(e,{strict:!1})?L(e):e.replace("Curve.fi","").replace("Gauge Deposit","").trim()}function c(e){switch(e){case"arbitrum":return"arbiscan.io";case"ethereum":return"etherscan.io";default:return"etherscan.io"}}return(e,s)=>{var v;const g=S,l=J,_=re,m=W;return t(),p(F,null,[(v=e.gauge)!=null&&v.killed?(t(),f(g,{key:0,class:"killed border-flash"},{default:i(()=>s[4]||(s[4]=[z(" This gauge has been killed! ")])),_:1})):w("",!0),d("div",Se,[r(l,{style:{"grid-area":"title"},label:"Gauge","has-value":!!e.gauge},{default:i(()=>[e.gauge?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${e.gauge.address}`,onClick:s[0]||(s[0]=$(()=>{},["stop"]))},k(n(e.gauge.name??e.gauge.address)),9,Ae)):(t(),p("span",De," ?"))]),_:1},8,["has-value"]),r(l,{style:{"grid-area":"underlying"},label:"Market / Pool","has-value":!!e.gauge},{default:i(()=>{var o,u;return[(o=e.gauge)!=null&&o.pool?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.pool.address}`,onClick:s[1]||(s[1]=$(()=>{},["stop"]))},k(n(e.gauge.pool.name)),9,Le)):(u=e.gauge)!=null&&u.market?(t(),p("span",Ne,k(n(e.gauge.market.name)),1)):(t(),p("span",Pe,"No underlying market or pool"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"lp-token"},label:"LP Token","has-value":!!e.gauge},{default:i(()=>{var o,u;return[(o=e.gauge)!=null&&o.lpToken&&((u=e.gauge)!=null&&u.pool)?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://${c(e.gauge.pool.chain)}/address/${e.gauge.lpToken}`,onClick:s[2]||(s[2]=$(()=>{},["stop"]))},k(("addressShort"in e?e.addressShort:a(L))(e.gauge.lpToken)),9,Fe)):(t(),p("span",Ie,"No LP token"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"tokens"},label:"Tokens","has-value":!!e.gauge},{default:i(()=>{var o;return[(o=e.gauge)!=null&&o.tokens&&e.gauge.tokens.length>0?(t(),p("div",Ge,[(t(!0),p(F,null,X(e.gauge.tokens,u=>(t(),f(_,{key:u.address,clickable:"",class:"token",address:u.address},null,8,["address"]))),128))])):(t(),p("span",Be,"No tokens"))]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"weight"},label:"Weight","has-value":!!e.gauge},{default:i(()=>{var o;return[r(m,{value:Number(((o=e.gauge)==null?void 0:o.weight)??0)/10**18},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"emissions"},label:"Emissions","has-value":!!e.gauge},{default:i(()=>{var o;return[r(m,{value:((o=e.gauge)==null?void 0:o.emissions)??0},null,8,["value"])]}),_:1},8,["has-value"]),r(l,{style:{"grid-area":"date"},label:"Creation Date","has-value":!!e.gauge},{default:i(()=>[e.gauge?(t(),p("a",{key:0,class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${e.gauge.creationTx}`,onClick:s[3]||(s[3]=$(()=>{},["stop"]))},k(e.gauge.creationDate.toLocaleDateString()),9,We)):w("",!0)]),_:1},8,["has-value"]),r(we,{style:{"grid-area":"deployment"},"gauge-address":a(h)},null,8,["gauge-address"]),r(Ve,{style:{"grid-area":"weight-chart"},"gauge-address":a(h)},null,8,["gauge-address"])])],64)}}}),Oe=V(Re,[["__scopeId","data-v-93c6a50a"]]),He={style:{display:"flex","flex-wrap":"wrap",gap:"1rem"}},Me=["href"],Qe={class:"end"},Ee={class:"end"},Ke={class:"end"},Ue=["href"],G=15,qe=T({__name:"TableVotes",props:{gaugeAddress:{}},setup(b){const{isFetching:h,data:n}=oe(N(()=>b.gaugeAddress)),c=[{id:"voter",label:"Voter",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"block",label:"Block",sort:!0,align:"end"},{id:"time",label:"Timestamp",sort:!0,align:"end"}],{sorting:e,onSort:s}=he("time"),g=Y(""),l=C(()=>n.value.filter(o=>{const u=g.value.toLocaleLowerCase().split(" ");return(A=>u.some(D=>A.toLocaleLowerCase().includes(D)))(o.user)}).orderBy(o=>{switch(e.value.column){case"time":return o.timestamp.getTime();case"weight":return o.weight;case"block":return o.blockNumber}},e.value.order)),{page:_,rowsPage:m,onPage:v}=_e(l,G);return(o,u)=>{const P=me,A=pe,D=W,O=R,H=S;return t(),f(H,{title:"Votes",loading:a(h)},{actions:i(()=>[d("div",He,[r(P,{"items-count":a(l).length,"items-per-page":G,page:a(_),onPage:a(v)},null,8,["items-count","page","onPage"]),r(A,{modelValue:a(g),"onUpdate:modelValue":u[0]||(u[0]=y=>Z(g)?g.value=y:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])])]),default:i(()=>[r(O,{rows:a(m),columns:c,sorting:a(e),onSortColumn:a(s)},{row:i(({item:y})=>[d("div",null,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${y.user}`,onClick:u[1]||(u[1]=$(()=>{},["stop"]))},k(("addressShort"in o?o.addressShort:a(L))(y.user)),9,Me)]),d("div",Qe,[r(D,{value:y.weight},null,8,["value"])]),d("div",Ee,k(y.blockNumber),1),d("div",Ke,[d("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/tx/${y.tx}`,onClick:u[2]||(u[2]=$(()=>{},["stop"]))},k(y.timestamp.toLocaleDateString()),9,Ue)])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),ze=V(qe,[["__scopeId","data-v-8779ea09"]]),Je={class:"dashboard-grid"},Xe=T({__name:"Votes",props:{gauge:{}},setup(b){const h=C(()=>{var n;return(n=b.gauge)==null?void 0:n.address});return(n,c)=>(t(),p("div",Je,[r(ze,{style:{"grid-area":"votes"},"gauge-address":a(h)},null,8,["gauge-address"])]))}}),Ye=V(Xe,[["__scopeId","data-v-0cd351c6"]]),Ze={class:"dashboard"},je=T({__name:"Gauge.page",setup(b){const h=fe("gaugeAddr"),{isFetching:n,data:c}=ne(h),{crumbs:e}=j(x());ee(c,l=>{e.value=[{id:"gauges",label:"Gauges",pathName:"gauges"},{id:"gauge",label:`Gauge: ${(l==null?void 0:l.name)??(l==null?void 0:l.address)??"?"}`}]},{immediate:!0});const{tabActive:s,tabActiveIndex:g}=ve(["overview","votes"],"gauge",()=>({gaugeAddr:h.value}));return(l,_)=>{const m=ae,v=M,o=Q;return t(),p("div",Ze,[r(m,{loading:a(n)},null,8,["loading"]),!a(n)&&a(c)?(t(),f(o,{key:0,active:a(g),onTab:_[0]||(_[0]=u=>g.value=u.index)},{default:i(()=>[r(v,{header:"Overview"},{default:i(()=>[(t(),f(I,null,[a(s)==="overview"?(t(),f(Oe,{key:0,gauge:a(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1}),r(v,{header:"Votes"},{default:i(()=>[(t(),f(I,null,[a(s)==="votes"?(t(),f(Ye,{key:0,gauge:a(c)},null,8,["gauge"])):w("",!0)],1024))]),_:1})]),_:1},8,["active"])):w("",!0)])}}}),ga=V(je,[["__scopeId","data-v-7defe33e"]]);export{ga as default};

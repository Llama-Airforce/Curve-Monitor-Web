import{d as $,T as S,f as m,U,V as D,h as A,o as x,w as f,a as c,b as n,u as t,_ as B,r as z,t as K,O as I,a9 as O,e as F,c as W}from"./index-CB0lbOkp.js";import{u as E,_ as Q}from"./UseLegend-BjWtFUgd.js";import{u as M,b as N,c as j,_ as q,a as G}from"./UseLightweightChart-D45Z5owe.js";import{f as R,g as H}from"./crvusd-657i8rJZ.js";import{r as J,u as X}from"./Number-BucUTk9j.js";import{_ as Y}from"./Table-NQndpLny.js";import{_ as Z}from"./AsyncValue-C0jBgRNU.js";import{_ as ee}from"./TokenIcon-Cqe8ofer.js";import{_ as se}from"./InputText-CXpNFmeS.js";import{d as oe}from"./pools-Br0Ew-HP.js";import"./Object-DOSYkgA0.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-B6SWxrK9.js";import"./UseHost-BAy6Z9V0.js";const ae={style:{display:"flex"}},te={ref:"chartRef",class:"chart"},le=$({__name:"ChartKeeperPrices",setup(h){const v=S(),g=["USDC","USDT"],{items:C,toggles:_,disabled:L}=E(()=>g.map((a,r)=>({id:a,label:a,color:v.value.colorsArray[r],togglable:!0}))),b=m(()=>V.value||P.value),{isFetching:V,data:k}=R(),w=m(()=>k.value.filter(a=>a.pair.some(({symbol:r})=>g.map(s=>s.toLocaleLowerCase()).includes(r.toLocaleLowerCase())))),{isFetching:P,data:T}=H(w),d=U("card"),{chart:y,series:e}=M({createChartOptions:j(),series:g.map((a,r)=>({type:"Line",name:a,options:m(()=>({priceFormat:{type:"custom",formatter:s=>`${J(s,3,"dollar")}${X(s)}`},lineWidth:2,lineType:N.WithSteps,color:v.value.colorsArray[r],lastValueVisible:!1,priceLineVisible:!1,autoscaleInfoProvider:s=>{const i=s();return i!==null&&(i.priceRange.minValue=Math.max(.98,i.priceRange.minValue),i.priceRange.maxValue=Math.min(1.02,i.priceRange.maxValue)),i}}))}))});D(l);function l(){var a,r;if(!(!y.value||Object.values(e).length<0)){for(const[,s]of g.entries()){(a=e[s])==null||a.applyOptions({visible:_[s].value});const i=T.value.map(u=>({time:u.timestamp,value:u[s]})).uniqWith((u,o)=>u.time===o.time).orderBy(u=>u.time,"asc");i.length>0&&((r=e[s])==null||r.setData(i))}y.value.timeScale().fitContent()}}return(a,r)=>{const s=q,i=G,u=Q,o=B;return x(),A(o,{ref_key:"card",ref:d,title:"Pegkeepers Coin Prices",loading:t(b)},{actions:f(()=>[c("div",ae,[n(s,{filename:"keeper_prices",series:t(e)},null,8,["series"]),n(i,{chart:t(y),target:t(d)},null,8,["chart","target"])])]),"actions-secondary":f(()=>[n(u,{items:t(C),disabled:t(L),onToggle:r[0]||(r[0]=p=>t(_)[p].value=!t(_)[p].value)},null,8,["items","disabled"])]),default:f(()=>[c("div",te,null,512)]),_:1},8,["loading"])}}});function ne(h){return h!=null}const re={class:"end"},ie={class:"end"},ce={class:"end"},de={class:"end"},ue={class:"end"},pe={class:"end"},_e={class:"end"},me={class:"end"},ve=$({__name:"TablePegkeepers",setup(h){const v=z(""),g=m(()=>P.value||L.value),C=m(()=>b.value.filter(e=>e.active).map(e=>{const l=T.value.find(a=>e.poolAddress===a.address);if(l)return{...l,...e,pool:l.address}}).filter(ne).orderBy(e=>e.tvlUsd,"desc")),_=m(()=>C.value.filter(e=>{const l=v.value.toLocaleLowerCase().split(" "),a=r=>l.some(s=>r.toLocaleLowerCase().includes(s));return a(e.name)||a(e.address)})),{isFetching:L,data:b}=R(),V=e=>`${e.pair[1].symbol} / ${e.pair[0].symbol}`,k=m(()=>b.value.map(e=>e.poolAddress)),w=oe(z("ethereum"),k),P=m(()=>w.value.some(e=>e.isFetching)),T=m(()=>w.value.filter(e=>e.data).map(e=>e.data)),d=e=>e>=1e6?2:0,y=e=>e.pair.filter(l=>l.address.toLocaleLowerCase()!==O)[0].address;return(e,l)=>{const a=se,r=ee,s=Z,i=Y,u=B;return x(),A(u,{class:"pegkeepers-card",title:"Pegkeepers",loading:t(g)},{actions:f(()=>[n(a,{modelValue:t(v),"onUpdate:modelValue":l[0]||(l[0]=o=>I(v)?v.value=o:null),search:"",placeholder:"Search for.."},null,8,["modelValue"])]),default:f(()=>[n(i,{class:"pegkeepers-table",rows:t(_),columns:["","Name",{label:"Debt",align:"end"},{label:"TVL",align:"end"},{label:"Volume",align:"end"},{label:"Fees",align:"end"}]},{row:f(({item:o})=>[n(r,{chain:"ethereum",address:y(o)},null,8,["address"]),c("div",null,K(V(o)),1),c("div",re,[n(s,{"show-zero":"",type:"dollar",value:o.totalDebt,precision:d},null,8,["value"])]),c("div",ie,[n(s,{"show-zero":"",type:"dollar",value:o.tvlUsd,precision:d},null,8,["value"])]),c("div",ce,[n(s,{"show-zero":"",type:"dollar",value:o.tradingVolume24h,precision:d},null,8,["value"])]),c("div",de,[n(s,{"show-zero":"",type:"dollar",value:o.totalProfit,precision:d},null,8,["value"])])]),"row-aggregation":f(()=>[l[1]||(l[1]=c("div",null,null,-1)),l[2]||(l[2]=c("div",null,null,-1)),c("div",ue,[n(s,{"show-zero":"",type:"dollar",value:t(_).reduce((o,p)=>o+p.totalDebt,0),precision:d},null,8,["value"])]),c("div",pe,[n(s,{"show-zero":"",type:"dollar",value:t(_).reduce((o,p)=>o+p.tvlUsd,0),precision:d},null,8,["value"])]),c("div",_e,[n(s,{"show-zero":"",type:"dollar",value:t(_).reduce((o,p)=>o+p.tradingVolume24h,0),precision:d},null,8,["value"])]),c("div",me,[n(s,{"show-zero":"",type:"dollar",value:t(_).reduce((o,p)=>o+p.totalProfit,0),precision:d},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),ge=F(ve,[["__scopeId","data-v-030699ea"]]),fe={class:"dashboard"},he=$({__name:"Pegkeepers.page",setup(h){return(v,g)=>(x(),W("div",fe,[n(t(ge),{style:{"grid-area":"table"}}),n(t(le),{style:{"grid-area":"chart"}})]))}}),Re=F(he,[["__scopeId","data-v-f4603245"]]);export{Re as default};

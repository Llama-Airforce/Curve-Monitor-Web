import{_ as X}from"./KPI-DNwX4ZZY.js";import{_ as F}from"./AsyncValue-BZQqUTDJ.js";import{a as I,b as H,c as J}from"./dao-B7VedKlS.js";import{d as $,r as M,f as g,T as O,U,V as q,h as B,o as w,w as i,a as c,b as l,u as a,j as C,_ as N,e as D,$ as Y,i as Z,t as W,X as ee,c as te}from"./index-Bch5xw70.js";import{u as oe,_ as ae}from"./UseLegend-CMayYxjU.js";import{_ as A}from"./ButtonToggle-DGr6jurf.js";import{u as E,G as R,a as x,_ as Q,b as G,k as se}from"./UseLightweightChart-BrGCRwIH.js";import{r as L,u as V}from"./Number-C9maoR4t.js";import{_ as j}from"./Table-CzfViY2y.js";import{_ as le}from"./IconExpander-Bw8DBqMc.js";import{u as z}from"./UseSort-BgE6w0Ba.js";import"./timestamp-CoE2HNXc.js";import"./useQuery-YCC5tKgQ.js";import"./Object-DOSYkgA0.js";const ne={style:{display:"flex"}},re={class:"actions-secondary"},ie={class:"button-group"},ue={ref:"chartRef",class:"chart"},ce=$({__name:"ChartSupply",setup(T){const n=M("1m"),h=g(()=>{switch(n.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:y,data:p}=I(h),d=O(),{items:f,toggles:s,disabled:m}=oe(()=>{const{blue:e,yellow:o,purple:v}=d.value.colors;return[{id:"crv",label:"CRV",color:e,togglable:!0},{id:"circ",label:"Circulating",color:o,togglable:!0},{id:"vecrv",label:"veCRV",color:v,togglable:!0}]});s.circ.value=!1,s.crv.value=!1;const u=U("card"),{chart:r,series:t}=E({createChartOptions:x(),series:[{type:R,name:"crv",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"circ",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))},{type:R,name:"vecrv",options:g(()=>({priceFormat:{type:"custom",formatter:e=>`${L(e,2,"dollar")}${V(e)}`,minMove:.01},lineWidth:2,color:d.value.colors.purple,lastValueVisible:!1,priceLineVisible:!1}))}]});q(_);function _(){!r.value||!t.crv||!t.circ||!t.vecrv||(t.crv.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.crvSupply)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.circ.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.circulatingSupply)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.vecrv.setData(p.value.map(e=>({time:e.timestamp.getUTCTimestamp(),value:Number(e.veCrvTotal)/10**18})).uniqWith((e,o)=>e.time===o.time).orderBy(e=>e.time,"asc")),t.crv.applyOptions({visible:s.crv.value}),t.circ.applyOptions({visible:s.circ.value}),t.vecrv.applyOptions({visible:s.vecrv.value}),r.value.timeScale().fitContent())}return(e,o)=>{const v=Q,b=G,S=A,K=ae,P=N;return w(),B(P,{ref_key:"card",ref:u,title:"Token Supply",class:"stack-actions",loading:a(y)},{actions:i(()=>[c("div",ne,[l(v,{filename:"token_supply",series:a(t)},null,8,["series"]),l(b,{chart:a(r),target:a(u)},null,8,["chart","target"])])]),"actions-secondary":i(()=>[c("div",re,[c("div",ie,[l(S,{"model-value":a(n)==="1m",onClick:o[0]||(o[0]=k=>n.value="1m")},{default:i(()=>o[5]||(o[5]=[C(" 1m ")])),_:1,__:[5]},8,["model-value"]),l(S,{"model-value":a(n)==="3m",onClick:o[1]||(o[1]=k=>n.value="3m")},{default:i(()=>o[6]||(o[6]=[C(" 3m ")])),_:1,__:[6]},8,["model-value"]),l(S,{"model-value":a(n)==="6m",onClick:o[2]||(o[2]=k=>n.value="6m")},{default:i(()=>o[7]||(o[7]=[C(" 6m ")])),_:1,__:[7]},8,["model-value"]),l(S,{"model-value":a(n)==="1y",onClick:o[3]||(o[3]=k=>n.value="1y")},{default:i(()=>o[8]||(o[8]=[C(" 1y ")])),_:1,__:[8]},8,["model-value"])]),l(K,{items:a(f),disabled:a(m),onToggle:o[4]||(o[4]=k=>a(s)[k].value=!a(s)[k].value)},null,8,["items","disabled"])])]),default:i(()=>[c("div",ue,null,512)]),_:1},8,["loading"])}}}),me=D(ce,[["__scopeId","data-v-d7698cd4"]]),pe={style:{display:"flex"}},de={class:"button-group"},ve={ref:"chartRef",class:"chart"},_e=$({__name:"ChartSupplyDelta",setup(T){const n=M("1m"),h=g(()=>{switch(n.value){case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 30}}),{isFetching:y,data:p}=I(h),d=O(),f=U("card"),{chart:s,series:m}=E({createChartOptions:x(),series:{type:se,name:"deltas",options:g(()=>({priceFormat:{type:"custom",formatter:r=>`${L(r,0,"dollar")}${V(r)}`,minMove:.01},color:d.value.colors.blue,lastValueVisible:!1,priceLineVisible:!1}))}});q(u);function u(){if(!s.value||!m.deltas)return;const{colors:r}=d.value;m.deltas.setData(p.value.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.veCrvTotal})).uniqWith((t,_)=>t.time===_.time).orderBy(t=>t.time,"asc").reduce((t,_,e,o)=>{if(e===0)return t;const v=_.value-o[e-1].value,b=v<0?r.red:r.green;return t.push({time:_.time,value:Number(v)/10**18,color:b}),t},[])),s.value.timeScale().fitContent()}return(r,t)=>{const _=Q,e=G,o=A,v=N;return w(),B(v,{ref_key:"card",ref:f,title:"veCRV Change",loading:a(y)},{actions:i(()=>[c("div",pe,[l(_,{filename:"distributions_delta",series:a(m)},null,8,["series"]),l(e,{chart:a(s),target:a(f)},null,8,["chart","target"])])]),"actions-secondary":i(()=>[c("div",de,[l(o,{"model-value":a(n)==="1m",onClick:t[0]||(t[0]=b=>n.value="1m")},{default:i(()=>t[4]||(t[4]=[C(" 1m ")])),_:1,__:[4]},8,["model-value"]),l(o,{"model-value":a(n)==="3m",onClick:t[1]||(t[1]=b=>n.value="3m")},{default:i(()=>t[5]||(t[5]=[C(" 3m ")])),_:1,__:[5]},8,["model-value"]),l(o,{"model-value":a(n)==="6m",onClick:t[2]||(t[2]=b=>n.value="6m")},{default:i(()=>t[6]||(t[6]=[C(" 6m ")])),_:1,__:[6]},8,["model-value"]),l(o,{"model-value":a(n)==="1y",onClick:t[3]||(t[3]=b=>n.value="1y")},{default:i(()=>t[7]||(t[7]=[C(" 1y ")])),_:1,__:[7]},8,["model-value"])])]),default:i(()=>[c("div",ve,null,512)]),_:1},8,["loading"])}}}),ge=["href"],ye={class:"end"},fe={class:"end"},be={class:"end"},he=$({__name:"TableLockers",setup(T){const{isFetching:n,data:h}=H(),y=[{id:"locker",label:"Locker",sort:!1},{id:"weight",label:"Weight",sort:!0,align:"end"},{id:"ratio",label:"Ratio",sort:!0,align:"end"},{id:"unlock",label:"Unlock Date",sort:!0,align:"end"}],{sorting:p,onSort:d}=z("weight"),f=g(()=>h.value.orderBy(u=>{var r;switch(p.value.column){case"weight":return Number(u.weight);case"ratio":return u.weightRatio;case"unlock":return((r=u.unlockTime)==null?void 0:r.getTime())??0}},p.value.order)),s=Y();async function m(u){await s.push({name:"profile",params:{tab:"governance"},query:{user:u.user}})}return(u,r)=>{const t=F,_=le,e=j,o=N;return w(),B(o,{title:"Top Lockers",loading:a(n)},{default:i(()=>[l(e,{rows:a(f),columns:y,sorting:a(p),onSortColumn:a(d),onSelect:m},{row:i(({item:v})=>{var b;return[c("div",null,[c("a",{class:"font-mono",target:"_blank",href:`https://etherscan.io/address/${v.user}`,onClick:r[0]||(r[0]=Z(()=>{},["stop"]))},W(v.user),9,ge)]),c("div",ye,[l(t,{value:Number(v.weight)/10**18},null,8,["value"])]),c("div",fe,[l(t,{type:"percentage",value:v.weightRatio,precision:2},null,8,["value"])]),c("div",be,W(((b=v.unlockTime)==null?void 0:b.toLocaleDateString())??"?"),1),l(_)]}),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ce=D(he,[["__scopeId","data-v-16d8eb1a"]]),ke=$({__name:"TableLocks",setup(T){const{isFetching:n,data:h}=J(),y=[{id:"day",label:"Day",sort:!0},{id:"amount",label:"Amount",sort:!0,align:"end"}],{sorting:p,onSort:d}=z("day"),f=g(()=>h.value.orderBy(m=>{switch(p.value.column){case"day":return m.day.getTime();case"amount":return Number(m.amount)}},p.value.order));function s(m){return Math.round(Number(m.amount)/10**18)}return(m,u)=>{const r=F,t=j,_=N;return w(),B(_,{title:"Daily Lock Change",loading:a(n)},{default:i(()=>[l(t,{rows:a(f),columns:y,sorting:a(p),onSortColumn:a(d)},{row:i(({item:e})=>[c("div",null,W(e.day.toLocaleDateString()),1),c("div",{class:ee(["end",{positive:s(e)>0,negative:s(e)<0}])},[l(r,{value:s(e),precision:2},null,8,["value"])],2)]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),$e=D(ke,[["__scopeId","data-v-3ae158f5"]]),we={class:"dashboard"},Te={class:"two-sides"},Se={style:{display:"flex",gap:"0.5ch"}},Le=$({__name:"Locks.page",setup(T){const{isFetching:n,data:h}=I(),y=g(()=>h.value.orderBy(s=>s.timestamp.getTime(),"desc")[0]??void 0),p=g(()=>{var s;return Number(((s=y.value)==null?void 0:s.veCrvTotal)??0)/10**18}),d=g(()=>{var s;return Number(((s=y.value)==null?void 0:s.crvSupply)??0)/10**18}),f=g(()=>{var s;return Number(((s=y.value)==null?void 0:s.circulatingSupply)??0)/10**18});return(s,m)=>{const u=F,r=X;return w(),te("div",we,[l(r,{style:{"grid-area":"kpi1"},label:"veCRV Supply","has-value":!a(n)},{default:i(()=>[l(u,{type:"dollar",value:a(p),precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),l(r,{style:{"grid-area":"kpi2"},label:"CRV Supply / Circulating","has-value":!a(n)},{default:i(()=>[c("div",Te,[c("div",Se,[l(u,{type:"dollar",value:a(d),precision:2,"show-symbol":!1},null,8,["value"]),m[0]||(m[0]=c("span",{style:{color:"var(--c-lvl5)"}},"/",-1)),l(u,{type:"dollar",value:a(f),precision:2,"show-symbol":!1},null,8,["value"])]),l(u,{type:"percentage",value:100*a(f)/a(d),precision:2},null,8,["value"])])]),_:1},8,["has-value"]),l(me,{style:{"grid-area":"supply"}}),l(_e,{style:{"grid-area":"supply-delta"}}),l($e,{style:{"grid-area":"locks"}}),l(Ce,{style:{"grid-area":"lockers"}})])}}}),xe=D(Le,[["__scopeId","data-v-85843182"]]);export{xe as default};

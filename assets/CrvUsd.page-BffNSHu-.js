import{d as $,r as V,f as C,T as A,U as R,V as F,h as D,o as B,w as u,a as l,b as t,u as a,j as b,_ as x,e as U,t as T,O as I,a4 as M,a5 as N,$ as W,c as E}from"./index-CEOjmKtR.js";import{u as O,_ as z}from"./UseLegend-DXfplF16.js";import{_ as Q}from"./ButtonToggle-DOQ7XXrK.js";import{u as j,c as q,d as K,a as P,_ as G,b as H}from"./UseLightweightChart-D6IbOW_8.js";import{d as J,u as X}from"./crvusd-Du_tfejE.js";import{r as Y,u as Z}from"./Number-nBy8KE7n.js";/* empty css                                                                         *//* empty css                                                                    */import{_ as ee}from"./Table-DR8Omo3G.js";import{_ as se}from"./AsyncValue-k8yzPf6l.js";import{_ as te}from"./TokenIcon-BUfLytfP.js";import{_ as oe}from"./IconExpander-CtGFDvsi.js";import{_ as le}from"./InputText-D-E_vOcO.js";import"./Object-DOSYkgA0.js";import"./timestamp-Dfir0V72.js";import"./api-DFkSxUea.js";import"./useQuery-C8O3Jmvc.js";const ae={style:{display:"flex"}},ne={class:"actions-secondary"},re={class:"button-group"},de={ref:"chartRef",class:"chart"},ie=$({__name:"ChartCrvUsdSupply",setup(L){const r=V("3m"),y=C(()=>{switch(r.value){case"7d":return 7;case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 90}}),i=A(),{items:c}=O(()=>[{id:"supply",label:"Supply",color:i.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:i.value.colorsArray[1]}]),{isFetching:h,data:k}=J(y),p=R("card"),{chart:m,series:o}=j({createChartOptions:P(),series:[q({name:"supply",color:C(()=>i.value.colors.blue),formatter:f}),{type:"Line",name:"debt",options:C(()=>({priceFormat:{type:"custom",formatter:f},lineWidth:2,lineType:K.WithSteps,color:i.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});F(v);function v(){if(!m.value||!o.debt||!o.supply)return;const _=k.value.groupBy(n=>n.timestamp.getTime()).entries().map(([,n])=>{var s;return{time:n[0].timestamp.getUTCTimestamp(),value:n.reduce((d,S)=>d+S.supply,0),debt:((s=n.find(d=>d.market==="Keepers debt"))==null?void 0:s.supply)??0}}).uniqWith((n,s)=>n.time===s.time).orderBy(n=>n.time,"asc"),e=_.map(n=>({time:n.time,value:n.value-n.debt}));_.length>0&&o.supply.setData(_),e.length>0&&o.debt.setData(e),m.value.timeScale().fitContent();const g=new Date(Date.UTC(2025,2,20));o.supply.setMarkers([{time:g.getUTCTimestamp(),position:"aboveBar",color:i.value.colors.red,shape:"arrowDown",text:"Resupply Launch"}])}function f(_){return`${Y(_,0,"dollar")}${Z(_)}`}return(_,e)=>{const g=G,n=H,s=Q,d=z,S=x;return B(),D(S,{ref_key:"card",ref:p,title:"crvUSD Supply",class:"stack-actions",loading:a(h)},{actions:u(()=>[l("div",ae,[t(g,{filename:"crvusd_supply",series:a(o)},null,8,["series"]),t(n,{chart:a(m),target:a(p)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[l("div",ne,[l("div",re,[t(s,{"model-value":a(r)==="7d",onClick:e[0]||(e[0]=w=>r.value="7d")},{default:u(()=>e[5]||(e[5]=[b(" 7d ")])),_:1},8,["model-value"]),t(s,{"model-value":a(r)==="1m",onClick:e[1]||(e[1]=w=>r.value="1m")},{default:u(()=>e[6]||(e[6]=[b(" 1m ")])),_:1},8,["model-value"]),t(s,{"model-value":a(r)==="3m",onClick:e[2]||(e[2]=w=>r.value="3m")},{default:u(()=>e[7]||(e[7]=[b(" 3m ")])),_:1},8,["model-value"]),t(s,{"model-value":a(r)==="6m",onClick:e[3]||(e[3]=w=>r.value="6m")},{default:u(()=>e[8]||(e[8]=[b(" 6m ")])),_:1},8,["model-value"]),t(s,{"model-value":a(r)==="1y",onClick:e[4]||(e[4]=w=>r.value="1y")},{default:u(()=>e[9]||(e[9]=[b(" 1y ")])),_:1},8,["model-value"])]),t(d,{items:a(c)},null,8,["items"])])]),default:u(()=>[l("div",de,null,512)]),_:1},8,["loading"])}}}),ue=U(ie,[["__scopeId","data-v-251d9330"]]),ce={class:"end"},pe={class:"end"},me={class:"end"},_e={class:"end"},ve={class:"end"},fe={class:"end"},ye={class:"end"},ge={class:"end"},be={class:"end"},he={class:"end"},we={class:"end"},Ce=$({__name:"TableMarkets",emits:["select"],setup(L,{emit:r}){const y=r,i=V(""),c=C(()=>k.value.filter(m=>{const o=i.value.toLocaleLowerCase().split(" "),v=f=>o.some(_=>f.toLocaleLowerCase().includes(_));return v(m.name)||v(m.address)}).orderBy(m=>m.borrowed,"desc")),{isFetching:h,data:k}=X(),p=m=>m>=1e6?2:0;return(m,o)=>{const v=le,f=oe,_=te,e=se,g=ee,n=x;return B(),D(n,{class:"markets-card",title:"Markets",loading:a(h)},{actions:u(()=>[t(v,{modelValue:a(i),"onUpdate:modelValue":o[0]||(o[0]=s=>I(i)?i.value=s:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:u(()=>[t(g,{class:"markets-table",rows:a(c),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:o[1]||(o[1]=s=>y("select",s))},{row:u(({item:s})=>[t(f),t(_,{chain:"ethereum",address:s.collateralToken.address},null,8,["address"]),l("div",null,T(s.name),1),l("div",ce,T(s.loans),1),l("div",pe,[t(e,{type:"percentage",value:s.rate*100,precision:2},null,8,["value"])]),l("div",me,[t(e,{type:"dollar",value:s.borrowed,precision:p,"show-symbol":!1},null,8,["value"])]),l("div",_e,[t(e,{type:"dollar",value:s.collateralAmountUsd,precision:p},null,8,["value"])]),l("div",ve,[t(e,{type:"dollar",value:s.fees.pending,precision:p},null,8,["value"])]),l("div",fe,[t(e,{"show-zero":"",type:"dollar",value:s.fees.collected,precision:p},null,8,["value"])])]),"row-aggregation":u(()=>[o[2]||(o[2]=l("div",null,null,-1)),o[3]||(o[3]=l("div",null,null,-1)),o[4]||(o[4]=l("div",null,null,-1)),l("div",ye,T(a(c).reduce((s,d)=>s+d.loans,0)),1),o[5]||(o[5]=l("div",null,null,-1)),l("div",ge,[t(e,{type:"dollar",value:a(c).reduce((s,d)=>s+d.borrowed,0),precision:p,"show-symbol":!1},null,8,["value"])]),l("div",be,[t(e,{type:"dollar",value:a(c).reduce((s,d)=>s+d.collateralAmountUsd,0),precision:p},null,8,["value"])]),l("div",he,[t(e,{type:"dollar",value:a(c).reduce((s,d)=>s+d.fees.pending,0),precision:p},null,8,["value"])]),l("div",we,[t(e,{"show-zero":"",type:"dollar",value:a(c).reduce((s,d)=>s+d.fees.collected,0),precision:p},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),ke=U(Ce,[["__scopeId","data-v-f583e6f5"]]),Se={class:"dashboard"},Te=$({__name:"CrvUsd.page",setup(L){const{crumbs:r}=M(N());r.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const y=W(),i=async c=>{await y.push({name:"crvusdmarket",params:{tab:"",marketAddr:c.address}})};return(c,h)=>(B(),E("div",Se,[t(a(ke),{style:{"grid-area":"table"},onSelect:i}),t(a(ue),{style:{"grid-area":"chart"}})]))}}),Qe=U(Te,[["__scopeId","data-v-26d04f0d"]]);export{Qe as default};

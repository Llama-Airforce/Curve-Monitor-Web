import{k as g,L as m,u as p,z as d,aU as b,ae as c,A as _,I as C,aB as I,aV as v,ai as q,ak as l,aj as f,aW as P,aC as w}from"./index-BYnNAfSP.js";import{e as j,b as k,i as $,d as F,j as K}from"./getAction-Co2sJJHG.js";/**
 * @license lucide-vue-next v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=g("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=g("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);async function W(t,e){const{abi:r,address:o,args:a,functionName:s,...n}=e,i=j({abi:r,args:a,functionName:s});try{const{data:u}=await k(t,$,"call")({...n,data:i,to:o});return F({abi:r,args:a,functionName:s,data:u||"0x"})}catch(u){throw K(u,{abi:r,address:o,args:a,docsPath:"/docs/contract/readContract",functionName:s})}}function B(t){return t.state.chainId}function D(t,e){const{onChange:r}=e;return t.subscribe(o=>o.chainId,r)}function y(t,e){if(e){const r=e(t);if(r===void 0&&m(t)||r!==void 0)return r}if(Array.isArray(t))return t.map(r=>y(r,e));if(typeof t=="object"&&A(t)){const r=Object.entries(t).map(([o,a])=>[o,y(a,e)]);return Object.fromEntries(r)}return t}function O(t){return y(t,e=>{if(m(e))return O(p(e))})}function A(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function X(t){const e=d(()=>({...p(t),queryKeyHashFn:b})),r=c(e);return r.queryKey=p(e).queryKey,r}function J(t={}){const e=_(t),r=C(B(e)),o=D(e,{onChange(a){r.value=a}});return I(()=>o()),v(r)}const h=t=>{var e;return{timestamp:q(t.dt),id:t.vote_id,type:t.vote_type.toLocaleLowerCase()==="parameter"?"parameter":"ownership",metadata:(e=t.metadata)!=null&&e.startsWith('"')?t.metadata.substring(1):t.metadata??"",proposer:t.creator,block:t.snapshot_block,start:t.start_date,end:t.start_date+604800,quorum:Number(BigInt(t.min_accept_quorum))/10**18,support:Number(BigInt(t.support_required))/10**18,voteCount:t.vote_count,votesFor:Number(BigInt(t.votes_for))/10**18,votesAgainst:Number(BigInt(t.votes_against))/10**18,executed:t.executed,totalSupply:Number(BigInt(t.total_supply))/10**18,txCreation:t.transaction_hash}},N=t=>({...h(t),txExecution:t.execution_tx?t.execution_tx:void 0,script:t.script,votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,votingPower:Number(BigInt(e.voting_power))/10**18}))}),U=t=>({proposal:h(t.proposal),votes:t.votes.map(e=>({voter:e.voter,supports:e.supports,weight:BigInt(Math.round(parseFloat(e.voting_power))),txHash:e.transaction_hash}))});async function E(t,e,r,o,a){const s=f(a),n=await l(`${s}/v1/dao/proposals?pagination=10&page=${t}&search_string=${e}&type_filter=${r}&status_filter=${o}`);return{proposals:n.proposals.map(h),count:n.count}}async function Q(t,e,r){const o=f(r),a=await l(`${o}/v1/dao/proposals/details/${e}/${t}`);return N(a)}async function L(t,e){try{const r=f(e);return(await l(`${r}/v1/dao/proposals/votes/user/${t}?pagination=100&page=1`)).data.map(U)}catch(r){if(r instanceof P)return[];throw r}}function V(){return{initialData:[],initialDataUpdatedAt:0}}function T(t,e,r){return c({queryKey:["proposal",t,e],queryFn:({queryKey:[,o,a]})=>Q(o,a),...r&&{enabled:r}})}function G(t,e,r,o){return c({queryKey:["proposals",t,o,e,r],queryFn:({queryKey:[,a,s,n,i]})=>E(a,s,n,i),placeholderData:w})}function Y(t){return c({queryKey:["proposal-user-votes",d(()=>t.value)],queryFn:({queryKey:[,e]})=>L(e),enabled:d(()=>!!t.value),...V()})}export{S as C,R as X,X as a,Y as b,G as c,O as d,T as e,W as r,J as u};

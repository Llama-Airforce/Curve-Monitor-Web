import{d as T,r as L,f as w,T as A,U as R,V as F,h as V,o as S,w as u,a as l,b as t,u as a,j as b,_ as D,e as $,t as B,O as I,a5 as M,a6 as N,$ as W,c as E}from"./index-CB5ZtNTk.js";import{u as O,_ as z}from"./UseLegend-4sVcfLi-.js";import{_ as G}from"./ButtonToggle-oddN7qaO.js";import{u as Q,c as j,G as q,r as K,a as P,o as H,_ as J,b as X}from"./UseLightweightChart-Dil_zF1-.js";import{d as Y,u as Z}from"./crvusd-DAh3STM1.js";import{r as ee,u as se}from"./Number-kXrfykDx.js";/* empty css                                                                         *//* empty css                                                                    */import{_ as te}from"./Table-JrdQUkXI.js";import{_ as oe}from"./AsyncValue-BMUqQQdv.js";import{_ as le}from"./TokenIcon-CGGfQJ8v.js";import{_ as ae}from"./IconExpander-DCmlZjUb.js";import{_ as ne}from"./InputText-DgsjHCjg.js";import"./Object-DOSYkgA0.js";import"./timestamp-CoE2HNXc.js";import"./api-BCRV542q.js";import"./useQuery-7yGPp_5J.js";const re={style:{display:"flex"}},de={class:"actions-secondary"},ue={class:"button-group"},ie={ref:"chartRef",class:"chart"},ce=T({__name:"ChartCrvUsdSupply",setup(U){const r=L("3m"),f=w(()=>{switch(r.value){case"7d":return 7;case"1m":return 30;case"3m":return 90;case"6m":return 180;case"1y":return 365;default:return 90}}),d=A(),{items:i}=O(()=>[{id:"supply",label:"Supply",color:d.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:d.value.colorsArray[1]}]),{isFetching:h,data:k}=Y(f),c=R("card"),{chart:p,series:o}=Q({createChartOptions:P(),series:[j({name:"supply",color:w(()=>d.value.colors.blue),formatter:v}),{type:q,name:"debt",options:w(()=>({priceFormat:{type:"custom",formatter:v},lineWidth:2,lineType:K.WithSteps,color:d.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});F(_);function _(){if(!p.value||!o.debt||!o.supply)return;const m=k.value.groupBy(n=>n.timestamp.getTime()).entries().map(([,n])=>{var e;return{time:n[0].timestamp.getUTCTimestamp(),value:n.sumBy(g=>g.supply),debt:((e=n.find(g=>g.market==="Keepers debt"))==null?void 0:e.supply)??0}}).uniqWith((n,e)=>n.time===e.time).orderBy(n=>n.time,"asc"),s=m.map(n=>({time:n.time,value:n.value-n.debt}));o.supply.setData(m),o.debt.setData(s),p.value.timeScale().fitContent();const y=new Date(Date.UTC(2025,2,20));H(o.supply,[{time:y.getUTCTimestamp(),position:"aboveBar",color:d.value.colors.red,shape:"arrowDown",text:"Resupply Launch"}])}function v(m){return`${ee(m,0,"dollar")}${se(m)}`}return(m,s)=>{const y=J,n=X,e=G,g=z,x=D;return S(),V(x,{ref_key:"card",ref:c,title:"crvUSD Supply",class:"stack-actions",loading:a(h)},{actions:u(()=>[l("div",re,[t(y,{filename:"crvusd_supply",series:a(o)},null,8,["series"]),t(n,{chart:a(p),target:a(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[l("div",de,[l("div",ue,[t(e,{"model-value":a(r)==="7d",onClick:s[0]||(s[0]=C=>r.value="7d")},{default:u(()=>s[5]||(s[5]=[b(" 7d ")])),_:1,__:[5]},8,["model-value"]),t(e,{"model-value":a(r)==="1m",onClick:s[1]||(s[1]=C=>r.value="1m")},{default:u(()=>s[6]||(s[6]=[b(" 1m ")])),_:1,__:[6]},8,["model-value"]),t(e,{"model-value":a(r)==="3m",onClick:s[2]||(s[2]=C=>r.value="3m")},{default:u(()=>s[7]||(s[7]=[b(" 3m ")])),_:1,__:[7]},8,["model-value"]),t(e,{"model-value":a(r)==="6m",onClick:s[3]||(s[3]=C=>r.value="6m")},{default:u(()=>s[8]||(s[8]=[b(" 6m ")])),_:1,__:[8]},8,["model-value"]),t(e,{"model-value":a(r)==="1y",onClick:s[4]||(s[4]=C=>r.value="1y")},{default:u(()=>s[9]||(s[9]=[b(" 1y ")])),_:1,__:[9]},8,["model-value"])]),t(g,{items:a(i)},null,8,["items"])])]),default:u(()=>[l("div",ie,null,512)]),_:1},8,["loading"])}}}),pe=$(ce,[["__scopeId","data-v-5b0b29eb"]]),me={class:"end"},_e={class:"end"},ve={class:"end"},fe={class:"end"},ye={class:"end"},ge={class:"end"},be={class:"end"},he={class:"end"},Ce={class:"end"},we={class:"end"},ke={class:"end"},Be=T({__name:"TableMarkets",emits:["select"],setup(U,{emit:r}){const f=r,d=L(""),i=w(()=>k.value.filter(p=>{const o=d.value.toLocaleLowerCase().split(" "),_=v=>o.some(m=>v.toLocaleLowerCase().includes(m));return _(p.name)||_(p.address)}).orderBy(p=>p.borrowed,"desc")),{isFetching:h,data:k}=Z(),c=p=>p>=1e6?2:0;return(p,o)=>{const _=ne,v=ae,m=le,s=oe,y=te,n=D;return S(),V(n,{class:"markets-card",title:"Markets",loading:a(h)},{actions:u(()=>[t(_,{modelValue:a(d),"onUpdate:modelValue":o[0]||(o[0]=e=>I(d)?d.value=e:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:u(()=>[t(y,{class:"markets-table",rows:a(i),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:o[1]||(o[1]=e=>f("select",e))},{row:u(({item:e})=>[t(v),t(m,{chain:"ethereum",address:e.collateralToken.address},null,8,["address"]),l("div",null,B(e.name),1),l("div",me,B(e.loans),1),l("div",_e,[t(s,{type:"percentage",value:e.rate*100,precision:2},null,8,["value"])]),l("div",ve,[t(s,{type:"dollar",value:e.borrowed,precision:c,"show-symbol":!1},null,8,["value"])]),l("div",fe,[t(s,{type:"dollar",value:e.collateralAmountUsd,precision:c},null,8,["value"])]),l("div",ye,[t(s,{type:"dollar",value:e.fees.pending,precision:c},null,8,["value"])]),l("div",ge,[t(s,{"show-zero":"",type:"dollar",value:e.fees.collected,precision:c},null,8,["value"])])]),"row-aggregation":u(()=>[o[2]||(o[2]=l("div",null,null,-1)),o[3]||(o[3]=l("div",null,null,-1)),o[4]||(o[4]=l("div",null,null,-1)),l("div",be,B(a(i).sumBy(e=>e.loans)),1),o[5]||(o[5]=l("div",null,null,-1)),l("div",he,[t(s,{type:"dollar",value:a(i).sumBy(e=>e.borrowed),precision:c,"show-symbol":!1},null,8,["value"])]),l("div",Ce,[t(s,{type:"dollar",value:a(i).sumBy(e=>e.collateralAmountUsd),precision:c},null,8,["value"])]),l("div",we,[t(s,{type:"dollar",value:a(i).sumBy(e=>e.fees.pending),precision:c},null,8,["value"])]),l("div",ke,[t(s,{"show-zero":"",type:"dollar",value:a(i).sumBy(e=>e.fees.collected),precision:c},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),Te=$(Be,[["__scopeId","data-v-89b20b09"]]),Se={class:"dashboard"},$e=T({__name:"CrvUsd.page",setup(U){const{crumbs:r}=M(N());r.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const f=W(),d=async i=>{await f.push({name:"crvusdmarket",params:{tab:"",marketAddr:i.address}})};return(i,h)=>(S(),E("div",Se,[t(a(Te),{style:{"grid-area":"table"},onSelect:d}),t(a(pe),{style:{"grid-area":"chart"}})]))}}),je=$($e,[["__scopeId","data-v-26d04f0d"]]);export{je as default};

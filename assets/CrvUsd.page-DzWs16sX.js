import{d as k,r as V,c as C,e as h,o as _,w as y,b as n,u as s,f as l,i as T,O as N,g as U,_ as S,W as D,a2 as $,V as B,j as x,Y as O,a as A,a4 as R,a5 as E,$ as z}from"./index-CT4FqvTD.js";import{_ as K}from"./Table-JN3v4T5r.js";import{_ as Q}from"./AsyncValue-yw7UjBml.js";import{_ as Y}from"./TokenIcon-DyiEeLSy.js";import{_ as j}from"./IconExpander-DBn0ULxe.js";import{_ as q}from"./InputText-CFbpntjf.js";import{u as P,d as X}from"./crvusd-CgA_xUU9.js";import{u as G,_ as H}from"./UseLegend-zAyqFCAc.js";import{_ as J}from"./ButtonToggle-BRVkT_JC.js";/* empty css                                                                         */import{c as Z,_ as ee}from"./ChartStylesApex-niCLd5Y0.js";import{r as I,u as W}from"./Number-D6bZlHKQ.js";import{u as te,a as L,c as ae}from"./UseLightweightChart-C0fLCxWV.js";/* empty css                                                                    */import"./api-DFkSxUea.js";import"./timestamp-Dfir0V72.js";import"./useQuery-BavYuEWE.js";import"./Object-DOSYkgA0.js";const se={class:"end"},oe={class:"end"},le={class:"end"},ne={class:"end"},re={class:"end"},ie={class:"end"},de={class:"end"},ue={class:"end"},ce={class:"end"},pe={class:"end"},me={class:"end"},_e=k({__name:"TableMarkets",emits:["select"],setup(b,{emit:p}){const r=p,i=V(""),d=C(()=>u.value.filter(t=>{const a=i.value.toLocaleLowerCase().split(" "),c=v=>a.some(w=>v.toLocaleLowerCase().includes(w));return c(t.name)||c(t.address)}).orderBy(t=>t.borrowed,"desc")),{isFetching:m,data:u}=P(),e=t=>t>=1e6?2:0;return(t,a)=>{const c=q,v=j,w=Y,f=Q,F=K,M=U;return _(),h(M,{class:"markets-card",title:"Markets",loading:s(m)},{actions:y(()=>[n(c,{modelValue:s(i),"onUpdate:modelValue":a[0]||(a[0]=o=>N(i)?i.value=o:null),search:"",placeholder:"Search for..."},null,8,["modelValue"])]),default:y(()=>[n(F,{class:"markets-table",rows:s(d),columns:["","","Name",{label:"Loans",align:"end"},{label:"Rate",align:"end"},{label:"Borrowed",align:"end"},{label:"Collateral",align:"end"},{label:"Fees Pending",align:"end"},{label:"Fees Collected",align:"end"}],onSelect:a[1]||(a[1]=o=>r("select",o))},{row:y(({item:o})=>[n(v),n(w,{chain:"ethereum",address:o.collateralToken.address},null,8,["address"]),l("div",null,T(o.name),1),l("div",se,T(o.loans),1),l("div",oe,[n(f,{type:"percentage",value:o.rate*100,precision:2},null,8,["value"])]),l("div",le,[n(f,{type:"dollar",value:o.borrowed,precision:e,"show-symbol":!1},null,8,["value"])]),l("div",ne,[n(f,{type:"dollar",value:o.collateralAmountUsd,precision:e},null,8,["value"])]),l("div",re,[n(f,{type:"dollar",value:o.fees.pending,precision:e},null,8,["value"])]),l("div",ie,[n(f,{"show-zero":"",type:"dollar",value:o.fees.collected,precision:e},null,8,["value"])])]),"row-aggregation":y(()=>[a[2]||(a[2]=l("div",null,null,-1)),a[3]||(a[3]=l("div",null,null,-1)),a[4]||(a[4]=l("div",null,null,-1)),l("div",de,T(s(d).reduce((o,g)=>o+g.loans,0)),1),a[5]||(a[5]=l("div",null,null,-1)),l("div",ue,[n(f,{type:"dollar",value:s(d).reduce((o,g)=>o+g.borrowed,0),precision:e,"show-symbol":!1},null,8,["value"])]),l("div",ce,[n(f,{type:"dollar",value:s(d).reduce((o,g)=>o+g.collateralAmountUsd,0),precision:e},null,8,["value"])]),l("div",pe,[n(f,{type:"dollar",value:s(d).reduce((o,g)=>o+g.fees.pending,0),precision:e},null,8,["value"])]),l("div",me,[n(f,{"show-zero":"",type:"dollar",value:s(d).reduce((o,g)=>o+g.fees.collected,0),precision:e},null,8,["value"])])]),_:1},8,["rows"])]),_:1},8,["loading"])}}}),ve=S(_e,[["__scopeId","data-v-f583e6f5"]]),fe={class:"chart-types button-group"},ge=k({__name:"ChartCrvUsdSupply",setup(b){const p=D(),r=V("line"),{items:i}=G(()=>[{id:"supply",label:"Supply",color:p.value.colorsArray[0]},{id:"borrowed",label:"Borrowed",color:p.value.colorsArray[1]}]),{isFetching:d,data:m}=X(),u=e=>{r.value!==e&&(r.value=e)};return(e,t)=>{const a=J,c=H,v=U;return _(),h(v,{title:"crvUSD Supply",loading:s(d)},{actions:y(()=>[l("div",fe,[n(a,{"model-value":s(r)==="line",onClick:t[0]||(t[0]=w=>u("line"))},{default:y(()=>t[2]||(t[2]=[x(" Line ")])),_:1},8,["model-value"]),n(a,{"model-value":s(r)==="breakdown",onClick:t[1]||(t[1]=w=>u("breakdown"))},{default:y(()=>t[3]||(t[3]=[x(" Breakdown ")])),_:1},8,["model-value"])])]),"actions-secondary":y(()=>[s(r)==="line"?(_(),h(c,{key:0,items:s(i)},null,8,["items"])):B("",!0)]),default:y(()=>[(_(),h($,null,[s(r)==="line"?(_(),h(s(Ce),{key:0,data:s(m)},null,8,["data"])):B("",!0)],1024)),(_(),h($,null,[s(r)==="breakdown"?(_(),h(s(he),{key:0,data:s(m)},null,8,["data"])):B("",!0)],1024))]),_:1},8,["loading"])}}}),ye=S(ge,[["__scopeId","data-v-8595a23d"]]),be=k({__name:"ChartCrvUsdSupplyBreakdown",props:{data:{default:()=>[]}},setup(b){const p=C(()=>Z({chart:{type:"bar",stacked:!0,animations:{enabled:!1}},xaxis:{categories:r.value,labels:{formatter:m,rotate:0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{formatter:u},min:0,max:d.value},plotOptions:{bar:{columnWidth:"75%",dataLabels:{position:"top",hideOverflowingLabels:!1}}},legend:{show:!1},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0}})),r=C(()=>b.data.orderBy(e=>e.timestamp.getTime(),"asc").groupBy(e=>e.timestamp.getTime()).entries().map(([e])=>new Date(parseInt(e,10)).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})).map((e,t)=>t%8===0?e:"")),i=C(()=>b.data.groupBy(e=>e.market).entries().map(([e,t])=>({name:e,data:t.groupBy(a=>a.timestamp.getTime()).entries().map(([a,c])=>({x:new Date(parseInt(a,10)).toLocaleDateString(),y:c.reduce((v,w)=>v+w.supply,0)})).orderBy(a=>a.x,"asc")}))),d=C(()=>Math.max(...b.data.groupBy(e=>e.timestamp.getTime()).entries().map(([,e])=>e.reduce((t,a)=>t+a.supply,0)))*1.1),m=e=>e,u=e=>`${I(e,1,"dollar")}${W(e)}`;return(e,t)=>{const a=ee;return _(),h(a,{options:s(p),series:s(i)},null,8,["options","series"])}}}),he=S(be,[["__scopeId","data-v-fc6d74b7"]]),we={ref:"chartRef",class:"chart"},Ce=k({__name:"ChartCrvUsdSupplyLine",props:{data:{default:()=>[]}},setup(b){const p=D(),{chart:r,series:i}=te({createChartOptions:ae(),series:[{type:"Area",name:"supply",options:C(()=>({priceFormat:{type:"custom",formatter:m},lineWidth:2,lineType:L.WithSteps,lineColor:p.value.colors.blue,topColor:"rgb(32, 129, 240, 0.2)",bottomColor:"rgba(32, 129, 240, 0)",lastValueVisible:!1,priceLineVisible:!1}))},{type:"Line",name:"debt",options:C(()=>({priceFormat:{type:"custom",formatter:m},lineWidth:2,lineType:L.WithSteps,color:p.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});O(d);function d(){if(!r.value||!i.debt||!i.supply)return;const u=b.data.groupBy(t=>t.timestamp.getTime()).entries().map(([,t])=>{var a;return{time:t[0].timestamp.getUTCTimestamp(),value:t.reduce((c,v)=>c+v.supply,0),debt:((a=t.find(c=>c.market==="Keepers debt"))==null?void 0:a.supply)??0}}).uniqWith((t,a)=>t.time===a.time).orderBy(t=>t.time,"asc"),e=u.map(t=>({time:t.time,value:t.value-t.debt}));u.length>0&&i.supply.setData(u),e.length>0&&i.debt.setData(e),r.value.timeScale().fitContent()}function m(u){return`${I(u,0,"dollar")}${W(u)}`}return(u,e)=>(_(),A("div",we,null,512))}}),ke={class:"dashboard"},Se=k({__name:"CrvUsd.page",setup(b){const{crumbs:p}=R(E());p.value=[{id:"crvusd",label:"crvUSD",pathName:"crvusd"},{id:"market",label:"Select market for details",hint:!0}];const r=z(),i=async d=>{await r.push({name:"crvusdmarket",params:{tab:"",marketAddr:d.address}})};return(d,m)=>(_(),A("div",ke,[n(s(ve),{style:{"grid-area":"table"},onSelect:i}),n(s(ye),{style:{"grid-area":"chart"}})]))}}),Ke=S(Se,[["__scopeId","data-v-64061774"]]);export{Ke as default};
